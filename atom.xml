<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Anderson Blog</title>
  
  
  <link href="http://nikolahuang.github.io/atom.xml" rel="self"/>
  
  <link href="http://nikolahuang.github.io/"/>
  <updated>2024-04-16T02:12:51.135Z</updated>
  <id>http://nikolahuang.github.io/</id>
  
  <author>
    <name>Anderson</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>纤毛相关细胞系的总结和体外培养</title>
    <link href="http://nikolahuang.github.io/2024/04/14/%E7%BA%A4%E6%AF%9B%E7%9B%B8%E5%85%B3%E7%BB%86%E8%83%9E%E7%B3%BB%E7%9A%84%E6%80%BB%E7%BB%93%E5%92%8C%E4%BD%93%E5%A4%96%E5%9F%B9%E5%85%BB/"/>
    <id>http://nikolahuang.github.io/2024/04/14/%E7%BA%A4%E6%AF%9B%E7%9B%B8%E5%85%B3%E7%BB%86%E8%83%9E%E7%B3%BB%E7%9A%84%E6%80%BB%E7%BB%93%E5%92%8C%E4%BD%93%E5%A4%96%E5%9F%B9%E5%85%BB/</id>
    <published>2024-04-14T12:04:57.000Z</published>
    <updated>2024-04-16T02:12:51.135Z</updated>
    
    <content type="html"><![CDATA[<h2 id="mEPC的诱导分离纯化和培养"><a href="#mEPC的诱导分离纯化和培养" class="headerlink" title="mEPC的诱导分离纯化和培养"></a>mEPC的诱导分离纯化和培养</h2><p>脑室的室管膜细胞表面存在许多动纤毛,它们的协调摆动确保了脑脊液的正常流动 。 </p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240415001018943.png" alt="image-20240415001018943"></p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/cc9429803b24ad8dd907269aae122201.jpg" alt="img"></p><p>室管膜细胞缺陷可导致严重的神经系统疾病, 如脑积 水。 在发育过程中,室管膜细胞在小鼠出生后由<strong>室管膜祖细胞放射状胶质细胞</strong>( radial glia) 分化。 在这个分化过程中,<strong>中心粒</strong>由<strong>次胞质体</strong>在细胞顶端大量复制、聚集,而后迁移并固定在细胞质膜,在质膜上成熟成为基体。 动纤毛由九对在外周排列的微管束以及一组在中心的中央微管束(9+2)组成, 外周微管上由于动力蛋白的存在可以使纤 毛运动。 原代培养的室管膜细胞是研究脑部动 纤毛和相关疾病的重要体外模型。 通过免疫荧光染色的方法表征体外培养室管膜细胞分化及动纤毛形成不同时期的特点。 通过活细胞成像观察培养<strong>室管膜的纤毛运动</strong>, 为以 mEPC 为模型的研究奠定了基础。</p><h3 id="该实验的方法和使用的材料、动物如下："><a href="#该实验的方法和使用的材料、动物如下：" class="headerlink" title="该实验的方法和使用的材料、动物如下："></a>该实验的方法和使用的材料、动物如下：</h3><h4 id="材料"><a href="#材料" class="headerlink" title="材料"></a>材料</h4><p>实验动物 1 ~ 3 只 SPF 级 C57BL &#x2F; 6 健康小鼠,新生1 d, 体重约 1. 5 g,雌雄比均衡,购于北京斯贝福生物技 术有限公司【 SCXK(京) 2019-0010】</p><h4 id="主要试剂与仪器"><a href="#主要试剂与仪器" class="headerlink" title="主要试剂与仪器"></a>主要试剂与仪器</h4><p>DMEM 培养基( Corning,10013050)</p><p>L15 培养基(Solarbio,LA9510)</p><p>青霉素&#x2F;链霉素( Penicillin&#x2F;streptomycin, Solarbio, P1400 )</p><p>胎 牛 血 清 ( FBS, Newzerum, FBS-S500 )</p><p>磷酸盐缓冲液 ( D-PBS, Solarbio,D1040)</p><p>平衡盐溶液(D-Hank’ s,Solarbio, H1045)</p><p>木瓜蛋白酶( Papain,Solarbio,G8430)</p><p>脱氧核糖核酸酶(DNasel,Solarbio, D8071)</p><p>L-半胱氨酸( L-Cysteine, Solarbio, C0012)</p><p>胰蛋白酶抑制剂 (Trypsin inhibitor,Solarbio,T8031)</p><p>多聚 L-赖氨酸 (poly-L-Lysine,Solarbio,P8130)</p><p>胰蛋白酶(TrypsinEDTA, Solarbio, T1320 )</p><p>抗荧光淬灭封片液 ( Fluoromount-G, SouthernBiotech, K2820 )</p><p>DAPI (Solarbio, ID2250)</p><p>细胞培养小瓶 ( T25, Corning, 430639)</p><h4 id="抗体"><a href="#抗体" class="headerlink" title="抗体:"></a>抗体:</h4><p>anti-acetylated tubulin(Sigma,T6793,1 ∶ 500)</p><p>anti-γ-tubulin(Sigma,T6557,1∶500)</p><p>anti-βcatenin(Proteintech,51067-2-AP,1 ∶ 500)</p><p>用于免疫 荧光分析的二抗为与 Alexa Fluor 488 偶联的山羊抗鼠或 与 Alexa Fluor 568 偶 联 的 山 羊 抗 兔 抗 体 (Invitrogen,1 ∶ 750)。 倒置生物显微镜 ,超高分辨共聚焦显微镜,生物安全柜,二氧化碳培养箱.</p><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><h5 id="25-cm2-培养瓶和-14-mm-玻片包被"><a href="#25-cm2-培养瓶和-14-mm-玻片包被" class="headerlink" title="25 cm2 培养瓶和 14 mm 玻片包被"></a>25 cm2 培养瓶和 14 mm 玻片包被</h5><p>为了增加培养小瓶对细胞的粘附性,采用<strong>多聚赖氨酸</strong>将小瓶底部包被,多聚赖氨酸可以增加培养皿表面正电荷从而加强细胞的贴壁生长。 </p><p>将多聚赖氨酸(poly-L-Lysine)粉末用无菌去离子水配制成 10 mg&#x2F;mL 的浓缩液,而后稀释成 0. 005%的工作液。 </p><p>每个 25 cm 2 培养小瓶加入 <strong>3 mL 多聚赖氨酸</strong>溶液, 37℃包被 1 h 或室温过夜包被。 </p><p>包被结束后吸出多聚赖氨酸工作液,用无菌去离子水冲洗 3 次并晾干。 </p><p>包被好的培养瓶在 4℃条件下可存放 4 周左右。 </p><h5 id="消化工作液及终止工作液的配置"><a href="#消化工作液及终止工作液的配置" class="headerlink" title="消化工作液及终止工作液的配置"></a>消化工作液及终止工作液的配置</h5><p>消化工作液的配制:   取 DMEM 培养基中加入木瓜蛋白酶(2 mg&#x2F;mL), DNaseI(0. 15 mg &#x2F; mL), L-半胱氨酸(0. 3 mg &#x2F; mL), 1%青霉素&#x2F;链霉素, 0. 22μm 微孔滤膜过滤后 4℃ 保存备用。 </p><p>终止工作液的配制:   取 L15 培养基中加入胰蛋白酶抑制剂( 1mg&#x2F;mL),DNaseI(0. 2 mg &#x2F; mL),10%胎牛血清, 0. 22 μm 微孔滤膜过滤后 4℃保存备用。</p><h4 id="小鼠室管膜细胞的分化培养"><a href="#小鼠室管膜细胞的分化培养" class="headerlink" title="小鼠室管膜细胞的分化培养"></a>小鼠室管膜细胞的分化培养</h4><p>以下操作步骤以 1 只小鼠为例：</p><p>将新生小鼠颈椎脱位处死后,用剪刀剪取小鼠头部、镊子剥离小鼠头部皮肤；（首先取出生 1 ~ 3 d 内的小鼠端脑组织,此时的小鼠大脑 内的神经胶质细胞分化程度低,利用此阶段的端脑 提取诱导分化室管膜细胞可以获得较高的成功率）</p><p>小心剔除头骨,并去除附着的组织与 血管；</p><p>将分离的小鼠脑组织放入含有 1%青霉素&#x2F;链霉素的 Hank’ s 溶液中,置于冰上；（分离过程中保持在冰上且冰浴的缓冲溶液中进行,可以大大提高胶质细 胞的存活率。）</p><p>用眼科剪剪去嗅球和小脑, 用 5 号镊子剥去端脑表面的脑膜,并用弹簧剪将其剪切成 0. 5 ~ 1 mm 大小的碎片；</p><p>用1000 μL移液器将所有脑组织碎片连同 Hank’ s 溶液一同转移至15 mL无菌离心管中；</p><p>800 r&#x2F;min 离心 1min;</p><p>吸出上清液,加入配制好的<strong>消化工作液</strong> 1 mL 重悬细胞；</p><p>37℃ 孵育 30 min；</p><p>消化结束后以 800 r&#x2F; min 离心 1 min,吸出上清液,加入配制的终止工作液 2 mL 重悬细胞静置 2 min；</p><p>800 r&#x2F; min 离心 1 min 后，吸出上清液，并以 2 mL L15 培养基重悬细胞，800 r&#x2F; min 离心 1 min;</p><p>吸出上清液,用 1 mL L15 培养基重悬细胞，并用 1000 μL 移液枪吹打悬液5次；</p><p>800 r&#x2F; min 离心 5 min 后;</p><p>移除上清液,并加入3 mL 含有 10% FBS 和 1%青霉素&#x2F;链霉素的 DMEM 完全培养基重悬细胞；</p><p>较少体积的重悬液是为了让细胞更好的吸附；</p><p>将细胞悬液小心接种到包被了多聚赖氨酸的 25 cm培养瓶中, 放入 37℃ ,  5%  CO2 培养箱中培养, <strong>标记为d1</strong>；</p><p>第 2 天(d2)吸弃旧培养基,加入 8 mL 新鲜37℃预热过的 DMEM 完全培养基,；</p><p>随后每隔 2 d 更换 1 次培养基至**第 7 天(d7)**；</p><p>第 7 天细胞铺满整个培养瓶底部，室温下将培养瓶放置在摇床上以 100 rpm 摇动培养 4 h 以去除粘附较差的神经元细胞；</p><p>吸弃旧培养基，加入 3 mL DPBS 清洗 1 次,再加入 1 mL Trypsin-EDTA 于 37℃ 消化 6 min,然后加入 4 mL 的 DMEM 完全培养基终止消化；</p><p>将细胞悬液收集至 15 mL 离心管中,于 800 r&#x2F; min 离心 5 min;</p><p>吸出上清液，加入 500 μL 的 DMEM 完全培养基重悬细胞；</p><p>1 只小鼠端脑大约可收集 200 ~ 300 万个细胞,以细胞计数板计数后,按照每孔 2 × 10^5 个细胞的数量滴加到玻片上;</p><p>此时滴加的液滴应在玻片上形成球形水珠，放入培养箱 中培养30 min;</p><p>待细胞粘附后，补加 DMEM 完全培养基;</p><p>24 h 后吸弃旧培养基,更换为含有 1% 青霉素&#x2F;链霉素的 DMEM（无血清）；</p><p>开始诱导细胞分化成室管膜细胞，记为 <strong>D0</strong>，每 <strong>3 ~ 4 d</strong> 更换培养基。（小鼠胶质细胞消化分离后均匀铺板,铺板后 (D2)换无血清培养基诱导分化,此时细胞进入分化阶段 D0）；</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240416101224017.png" alt="image-20240416101224017"></p><p>通过倒置相差显微镜观察细胞生长状况,细胞培养至 D3,细胞完全贴壁平铺在培养皿上,细胞形态变大变圆(图 2a) ; </p><p>饥饿培养 D6 时,部分细胞开始进行纤毛发生,并有极少数细胞形成可快速摆动的纤毛(图 2b) ; </p><p>D9 时细胞边界变得清晰可见,约有 1 &#x2F; 3 的细胞形成了多纤毛结 构( 图 2c) ; </p><p>分化培养进行到 D12 后, 培养的mEPC 细胞基本成熟,可观察到 MPEC 快速摆动的多纤毛(图 2d) ；</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240415153012250.png" alt="image-20240415153012250"></p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240415153044755.png" alt="image-20240415153044755"></p><p>当然也有商业化的产品：<a href="https://www.eiaab.com.cn/product-general-cn-primary_cells/MIC-iCell-n021/">https://www.eiaab.com.cn/product-general-cn-primary_cells/MIC-iCell-n021/</a></p><p><a href="http://www.51cells.cn/product/hanzhong_2763.html">汉中小鼠室管膜细胞（原代细胞）-武汉赛奥斯生物科技有限公司 (51cells.cn)</a></p><hr><h2 id="人肺类器官2D-3D-培养"><a href="#人肺类器官2D-3D-培养" class="headerlink" title="人肺类器官2D &amp; 3D 培养"></a>人肺类器官2D &amp; 3D 培养</h2><p><strong>人支气管上皮</strong></p><p>人呼吸道的支气管上皮层分为假复层（pseudostratified），纤毛（ciliated） 以及柱状（columnar）上皮。该区域主要有三种细胞类型：纤毛细胞 （ciliated cells），分泌细胞（secretory cells）（主要是分泌粘液的杯状细胞）和基底细胞（basal cells）。</p><p>支气管上皮作为保护屏障，防御各种吸入性伤害，例如毒素，污染物和病原体。屏障功能的维持主要基于于上皮的三个关键特征：</p><ol><li><p>紧密连接蛋白（tight junction proteins）维持着上皮的完整性，并且对于其作为物理屏障的功能至关重要。</p></li><li><p>分泌细胞分泌的粘液会捕获颗粒物质和病原体，然后通过纤毛细胞的协同将这些颗粒物质和病原体通运出气道。</p></li><li><p>粘液中含有抗菌肽（antimicrobial peptides）和炎症因子（inflammatory mediators）等保护性介质，形成了对病原体和有毒物质的化学和免疫屏障。</p></li></ol><p>呼吸道上皮的生理相关模型的需求正在日益增长，但其挑战仍在于如何在体外重现体内组织的复杂结构和功能。</p><p><strong>2D</strong> <strong>气-液界面培养</strong></p><p>多种细胞类型可用于人类呼吸系统的建模，包括永生化的呼吸细胞系（ 例如BEAS-2B细胞和16HBE14o-细胞）以及来自动物或人类供体的原代细胞。尽管使用永生化细胞系和动物原代细胞很普遍，但使用这些模型产生的数据并不直接适配于人类系统。传统培养人原代支气管上皮细胞的方法是将细胞浸没于培养基之下进行培养；但是，在该培养系统中的细胞无法进行粘膜纤毛分化。为了重现在体内观察到的伪分层粘膜纤毛表型（pseudostratified mucociliary phenotype），必须在气-液界面（AirLiquid Interface，ALI）上培养原代人支气管上皮细胞（primary human bronchial epithelial cells，HBEC）（图1）</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/20201208152828482848.png" alt="img"></p><p>气-液界面培养的主要特征是细胞的基底表面与液体培养基接触，而其顶端表面则暴露于空气中。常见的细胞接种方法是将细胞接种到细胞培养插件（cell culture insert）的可渗透膜上。在细胞培养初期，顶端和基底的腔室都需要添加培养基（图1A）。当细胞数量接近满板时，需要对细胞“airlift”，即吹干顶端腔室的培养基，并保留基底腔室的培养基（图1B）。该培养系统模拟了人气道中的情况，诱导细胞向粘膜纤毛表型分化。</p><p><video src="../../../../Desktop/CFAP91文章投稿初步材料/Air-Liquid Interface (ALI) Culture of Bronchial Epithelial Cells with PneumaCult™-ALI Medium - YouTube (1).mp4"></video></p><p><strong>气-液界面培养的生理相关性</strong></p><p>原代HBEC的气-液培养近年来越来越被认为是与呼吸系统生理学高度相关的重要培养系统。在气-液上培养的HBEC经历了高度的粘膜纤毛分化，从而形成了代表体内气道的体外模型。H&amp;E（hematoxylin and eosin）和PAS（periodic acid-Schiff）染色显示气-液界面培养物（图2A和 2C），如同体内支气管上皮一样（图2B和2D），表现出伪分层的形态，以及异种细胞群的组成，包括纤毛和粘液分泌（PAS阳性）细胞。</p><p>该模型的特征还在于体现出上皮的屏障功能，例如表达紧密连接蛋白和高细胞跨膜电阻（high transepithelial electrical resistance）。通过转录组分析与细胞对毒素、病原体等外源物质的生理反应实验，进一步证实了气-液界面培养物对气道建模的高度适用性。此外，对来自患有呼吸系统疾病（例如哮喘，囊性纤维化，慢性阻塞性肺病）供体的原代细胞进行气-液界面培养，可以重现体内疾病特征，从而建立可靠的体外研究模型。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/20201208152954705470.png" alt="img"></p><p><strong>实验流程简图</strong></p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/20201208153041064106.png" alt="img"></p><p><strong>3D成球培养</strong></p><p><strong>实验流程及数据</strong></p><p><img src="http://www.jiayuanbio.com/upload/image/2020/20201208153053575357.jpg" alt="img"></p><p><strong>产品信息</strong></p><table><thead><tr><th>货号</th><th>名称</th></tr></thead><tbody><tr><td>05040</td><td>PneumaCult™-Ex Plus Medium</td></tr><tr><td>05001(2D)</td><td>PneumaCult™-ALI Medium</td></tr><tr><td>05021(2D)</td><td>PneumaCult™-ALI Medium with 12 mm Transwell® Insert</td></tr><tr><td>05022(2D)</td><td>PneumaCult™-ALI Medium with 6.5 mm Transwell® Insert</td></tr><tr><td>05050(2D)</td><td>PneumaCult™-ALI-S Medium</td></tr><tr><td>05060(3D)</td><td>PneumaCult™ Airway Organoid Kit</td></tr></tbody></table><hr><h2 id="小鼠-SVZ-The-Subventricular-Zone-细胞原代培养"><a href="#小鼠-SVZ-The-Subventricular-Zone-细胞原代培养" class="headerlink" title="小鼠 **SVZ(The Subventricular Zone)**细胞原代培养"></a>小鼠 **SVZ(The Subventricular Zone)**细胞原代培养</h2><p>——朱学良组 张伟</p><p>①解剖前 <strong>24 - 4h</strong> 要预先用 Fibronectin or laminin包被培养 SVZ 细胞的Flask&#x2F; 培养板&#x2F;其它</p><p>②解剖前新鲜配制 5ml 消化液，于 37℃水浴锅。等消化液从乳白色变成无色透</p><p>明后，用注射器+小滤器过滤除菌，待用。（5ml消化液大约消化 10-15只小鼠的SVZ组织）</p><p>③解剖前 1-2h，将手术工具、解剖显微镜、1ml 移液枪等置于超净台紫外杀菌。</p><p>临解剖前，手术工具在酒精灯上灼烧（<em>除最精细的镊子，即下图中的镊子，请勿灼烧！！！！！！可在照紫外前用酒精棉球擦一遍。同时注意小心保护它的精细尖端</em>）。或直接将手术工具浸泡于 75%酒精中。</p><p><strong>1.</strong> 取 <strong>10</strong> 只 <strong>P0</strong> 新生小鼠 <strong>SVZ</strong> 组织：</p><p>详见解剖视频：<a href="http://www.jove.com/details.stp?id=1938">http://www.jove.com/details.stp?id=1938</a>)<a href="http://www.jove.com/details.stp?id=1938">http://www.jove.com/details.stp?id=1938</a></p><p><strong>2.消化 SVZ组织：</strong></p><p>取材后。用 1ml枪头（剪去尖端，并在酒精灯上烧圆前端）将 SVZ组织转移至已过滤的消化液中，于 37℃消化 15-18min。</p><p><strong>3.终止消化：</strong></p><p>消化完成后，吸去消化液。加入 5ml 10％FBS DMEM+GPS于 SVZ组织中作用 1-2min，终止消化。（GPS: 明胶磷酸盐琼脂）</p><p><strong>4.打散细胞：</strong></p><p>吸去终止液后。加 1mL 10％ FBS DMEM+GPS，用 1mL的 Axygene枪头轻轻吹打 15-20次，避免吹出气泡，然后加入 3ml 10% FBS DMEM+GPS, 静置 1-2min，这样单个细胞在上清中，沉淀为组织块。将上清转移到新的 15ml离心管。剩下的组织块中再加入 1ml 10％ FBS DMEM+GPS继续吹打，再沉淀，再转移。弃掉无法打散的沉淀。</p><p><strong>5.将上清置于离心机中 1000-1500 rpm，离心 5min。</strong></p><p>6.离心后，轻轻的吸取弃去上清。将细胞用含 10％ FBS DMEM+GPS 重悬，铺入到<strong>预先24h用 Fibronectin包被的 Flask</strong>（<u>铺细胞前，Flask用 PBS轻轻洗 1-2遍）中，置37℃培养箱培养</u>。</p><p>7.第二天，换液(10％ FBS DMEM+GPS)。同时用 <strong>37℃ 预热的PBS</strong> 轻轻的尽量洗去未贴壁的 Neuron，洗 1-2遍。</p><p>8.第三天，用手掌，适度用力拍 Flask侧壁，拍除上层未贴壁的 neuron。 用 PBS洗一遍后，加入 10％ FBS DMEM+GPS。</p><p>9.第四天，Flask 内细胞长到 90-95%时，将细胞用 Trypsin 消化，平均铺入<strong>预先 24h 用 Fibronectin包被的 24孔培养板</strong>中。（10只小鼠的 <strong>SVZ细胞</strong>大约可铺入 8个 24孔板的孔，或 1.75个 6孔板的孔效果很好；新手亦可增大小鼠数量；此时 24孔板每个孔的细胞数目大约为 10-20万，尽量使细胞生长到第 5天晚上前，达到可以进行饥饿的密度。细胞也不宜铺得过分的密，<strong>如果此时部分区域细胞为上下两层，上层细胞会死亡后贴在活细胞上表面</strong>。）</p><p>10.第五天，当 24孔板内细胞面积变小，紧密排列，几乎呈方格状，颜色较深，此时可用 PBS洗去一些死细胞后，再加入适量新鲜培液，培养至少半天左右。再用 37℃ PBS洗三遍后，加入 0.5-1ml<strong>不含 FBS</strong>的 DMEM+DAPT+GPS（DAPT效应不明显~），进行饥饿培养。</p><p>[总之，就是要让一层干净的活细胞，排挤足够紧密，<strong>形成紧密连接和锚定连接后饥饿</strong>。否则饥饿后细胞变瘦变小，不够紧密的区域会产生空洞、无细胞斑块。<strong>饥饿前不除去死细胞，也会产生同样的状况</strong>。]</p><p>每两三天用 DMEM+<strong>DAPT</strong>+GPS进行一次全换液。</p><p>11.<strong>饥饿 5-7 天</strong>后（DMEM+<strong>DAPT</strong>+GPS），可进行固定，免疫荧光观察。（<em>一般饥饿3-4天后光镜观察可见纤毛</em>）</p><h4 id="包被："><a href="#包被：" class="headerlink" title="包被："></a>包被：</h4><p>Fibronectin(Cat.#341631)，每瓶 5mg&#x2F;5ml 。4℃融化后，4ul和 10ul分装，-20℃保存。</p><p>包被时，用 无菌PBS 1:100 稀释后使用。一个 Flask 用 4ml 稀释后的 Fibronectin包被，过夜包被后使用。</p><p>24孔板每个孔用 250ul稀释后的 Fibronectin 包被，过夜</p><p>后使用。</p><h4 id="Dissection-Solution"><a href="#Dissection-Solution" class="headerlink" title="Dissection Solution:"></a>Dissection Solution:</h4><p>18.8g NaCl         161mM</p><p>0.74g KCl           5mM</p><p>0.26g MgSO<sub>4</sub>     1 mM</p><p>0.86g CaCl         3.7mM</p><p>2.4g Hepes          5mM</p><p>2.0g Glucose       5.5mM</p><p>0.004g Phenol Red （可以不加）</p><p>配制好以后，定容到 2L，将 pH值调到 7.4，用 0.2um的灭菌过滤器过滤除菌，置于 4℃冰箱保存。</p><h4 id="Enzymatic-Solution"><a href="#Enzymatic-Solution" class="headerlink" title="Enzymatic Solution:"></a>Enzymatic Solution:</h4><p>5ml Dissection Solution</p><p>1mg L-Cysteine ( SIGMA Cat .No 30089)</p><p>50μl EDTA (50mM, pH 8.0)</p><p>50μl CaCl<sub>2</sub> (100mM)</p><p>7.5μl NaOH (1M)</p><p><strong><u>? ul Papain（Worthington Bio Corp，Cat. No. LS003126）</u></strong></p><h5 id="Papain量计算"><a href="#Papain量计算" class="headerlink" title="Papain量计算:"></a>Papain量计算:</h5><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240416004405285.png" alt="image-20240416004405285"></p><p>必须在使用前配制，配制好以后在培养箱中温育至澄清透明，待用。</p><p>附：SVZ培养细胞形态展示：</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240415194817318.png" alt="image-20240415194817318"></p><hr><h2 id="以小鼠肾小管-IMCD3-细胞株-探讨纤毛生成和上皮细胞极化的关系"><a href="#以小鼠肾小管-IMCD3-细胞株-探讨纤毛生成和上皮细胞极化的关系" class="headerlink" title="以小鼠肾小管 IMCD3 细胞株 探讨纤毛生成和上皮细胞极化的关系"></a>以小鼠肾小管 IMCD3 细胞株 探讨纤毛生成和上皮细胞极化的关系</h2><p>大多数的动物细胞具有纤毛。纤毛主要由外层的膜包覆中心的微管所组成，中心的微管称为轴丝，轴丝是由母 亲中心粒当作基体作为地基，向上构筑成双联体九排的微管，并环绕成圆柱形的构造，而基体上的远程附器和细胞膜结合，使纤毛向外长出细胞表面。</p><p>纤毛发生病变可导致多种疾病，如<strong>原发性支气管炎</strong>、<strong>肝脏</strong>和<strong>肾脏的多囊性增生</strong>等， 由此可看出纤毛对于许多细胞的功能具有极大的影响力。</p><p>纤毛的生成路径有 2 种：细胞<strong>内</strong>和细胞<strong>外</strong>路径。</p><p>小鼠肾小管 <strong>IMCD3细胞 株</strong>的纤毛是借由<strong>细胞外</strong>路径生成，细胞外路径就是在<strong>一般二维培养</strong>的情况下， 可观察到母亲中心粒移动到细胞膜附近，再向外长出纤毛；</p><p><strong>视网膜色素上皮细胞株</strong>和<strong>成纤维细胞株</strong>的纤毛则是借由 细胞内路径，在此路径中，母亲中心粒维持在细胞中心的位置就可直接长出纤毛。</p><p>在极化的上皮细胞中，纤毛发育的过程起始于<strong>母亲中心粒</strong>，必须从细胞核附近移动到细胞顶端膜附近，再由远程附器结合在顶端膜上，作为基体向细胞顶端长出纤毛，凸出顶端膜表面以<strong>感测细胞外界讯号</strong>。</p><p>然而，在细胞外路径中， 母亲中心粒是如何移动至顶端膜附近以及如何辨别细胞顶端和底端的方向性目前仍然不清楚。</p><p>该篇文章作者以小鼠肾小管 IMCD3 细 胞 株， 在 去 血 清 的 刺 激 诱 导 下， 使 IMCD3 细胞长出纤毛，再以免疫荧光染色分析闭锁小带与生成纤毛的关系。 并利用克隆形成实验，将 <strong>IMCD3 细胞株分为 4 类形态</strong>，也进一步发现在三维培养中，<u>4 种细胞形态皆无法排列成空腔构造</u>。</p><p>最后建立载体 DNA，以绿色荧光标示纤毛蛋白，在活细胞中追踪基体的移动及纤毛生成的过程。</p><h4 id="结果部分的个人概述："><a href="#结果部分的个人概述：" class="headerlink" title="结果部分的个人概述："></a>结果部分的个人概述：</h4><ol><li><strong>闭锁小带与纤毛生成的密切关系</strong>：<ul><li>研究发现，在小鼠肾小管IMCD3细胞株中，具有完整闭锁小带结构的细胞更容易形成纤毛。</li><li>这一发现揭示了闭锁小带的完整性可能是纤毛生成的一个重要条件，特别是在细胞外路径中，纤毛的生成与闭锁小带的结构密切相关。</li><li>闭锁小带可能提供了必要的细胞结构支持，使得纤毛能够在正确的位置形成，从而保证细胞功能的正常进行。</li></ul></li><li><strong>纤毛生长位置对细胞功能的影响</strong>：<ul><li>纤毛的生长位置对细胞接收外界信号至关重要。在具有完整闭锁小带的细胞中，纤毛生长在细胞顶端，这有助于细胞有效地感测和响应外界环境。</li><li>如果纤毛未能在细胞顶端正确生长，可能会导致细胞无法正常接收信号，进而影响细胞功能，甚至可能导致疾病的发生。</li><li>因此，纤毛的正确位置对于细胞的正常生理功能至关重要。</li></ul></li><li><strong>细胞极性、空腔构造形成与分裂方向性</strong>：<ul><li>研究表明，具有完整闭锁小带的细胞不仅能形成立体的空腔构造，而且在细胞分裂时表现出正确的方向性。</li><li>这种分裂方向性对于维持细胞群体的整体结构和功能至关重要。细胞分裂时沿着闭锁小带的切线方向进行，有助于保持细胞极性和组织结构的完整性。</li><li>这一发现强调了闭锁小带在维持细胞极性和指导细胞分裂方向中的重要作用。</li></ul></li><li><strong>细胞密度与闭锁小带完整性的独立性</strong>：<ul><li>研究中观察到，即使在细胞密度增加的情况下，闭锁小带的完整性也不会因此而提高。</li><li>这一结果表明，闭锁小带的完整性是由细胞本身的属性决定的，而不是由外部环境因素如细胞密度所影响。</li><li>这进一步证实了IMCD3细胞株中存在不同特性的细胞群，而不是单一细胞类型在不同密度下的变化。</li></ul></li><li><strong>母亲中心粒在纤毛生成中的核心作用</strong>：<ul><li>通过使用荧光标记技术，研究明确显示了纤毛是以母亲中心粒为基底向外生长的。</li><li>这一发现证实了母亲中心粒在纤毛生成过程中的核心作用，为理解纤毛的形成机制提供了重要线索。</li><li>研究还指出，未来将进一步探究母亲中心体、高基氏体与纤毛形成的关系，这将有助于更深入地了解纤毛生成的详细路径和机制。</li></ul></li><li><strong>磷脂酰肌醇在细胞极性和纤毛生成中的作用</strong>：<ul><li>研究提出，闭锁小带可能通过限制磷脂酰肌醇（PIP2和PIP3）在细胞膜上的分布，从而影响细胞极性和纤毛的生成。</li><li>在极性细胞中，顶端细胞膜富含PIP2，而底端细胞膜富含PIP3，这种分布有助于基体在顶端位置生成纤毛。</li><li>缺乏闭锁小带的细胞可能无法正确区分顶端和底端的磷脂酰肌醇分布，导致基体无法在正确的位置生成纤毛。</li></ul></li></ol><hr><h2 id="参考文献："><a href="#参考文献：" class="headerlink" title="参考文献："></a>参考文献：</h2><p>[1]张源,武慧渊.小鼠室管膜细胞体外培养及多纤毛形成过程分析[J].中国实验动物学报,2022,30(03):370-375.</p><p>[2]Wang L, Wen X, Wang Z, et al. Ciliary transition zone proteins coordinate ciliary protein composition and ectosome shedding. <em>Nat Commun</em>. 2022;13(1):3997. Published 2022 Jul 9. doi:10.1038&#x2F;s41467-022-31751-0</p><p>[3]Meng X, Xu C, Li J, Qiu B, Luo J, Hong Q, Tong Y, Fang C, Feng Y, Ma R, Shi X, Lin C, Pan C, Zhu X, Yan X, Cong Y. Multi-scale structures of the mammalian radial spoke and divergence of axonemal complexes in ependymal cilia. Nat Commun. 2024 Jan 8;15(1):362. doi: 10.1038&#x2F;s41467-023-44577-1. PMID: 38191553; PMCID: PMC10774353.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;mEPC的诱导分离纯化和培养&quot;&gt;&lt;a href=&quot;#mEPC的诱导分离纯化和培养&quot; class=&quot;headerlink&quot; title=&quot;mEPC的诱导分离纯化和培养&quot;&gt;&lt;/a&gt;mEPC的诱导分离纯化和培养&lt;/h2&gt;&lt;p&gt;脑室的室管膜细胞表面存在许多动纤毛,它们的协</summary>
      
    
    
    
    
    <category term="类器官之纤毛" scheme="http://nikolahuang.github.io/tags/%E7%B1%BB%E5%99%A8%E5%AE%98%E4%B9%8B%E7%BA%A4%E6%AF%9B/"/>
    
  </entry>
  
  <entry>
    <title>蛋白代谢多组学研究思路和方法随笔</title>
    <link href="http://nikolahuang.github.io/2024/04/07/%E8%9B%8B%E7%99%BD%E4%BB%A3%E8%B0%A2%E5%A4%9A%E7%BB%84%E5%AD%A6%E7%A0%94%E7%A9%B6%E6%80%9D%E8%B7%AF%E5%92%8C%E6%96%B9%E6%B3%95%E9%9A%8F%E7%AC%94/"/>
    <id>http://nikolahuang.github.io/2024/04/07/%E8%9B%8B%E7%99%BD%E4%BB%A3%E8%B0%A2%E5%A4%9A%E7%BB%84%E5%AD%A6%E7%A0%94%E7%A9%B6%E6%80%9D%E8%B7%AF%E5%92%8C%E6%96%B9%E6%B3%95%E9%9A%8F%E7%AC%94/</id>
    <published>2024-04-07T15:16:40.000Z</published>
    <updated>2024-04-25T17:06:02.601Z</updated>
    
    <content type="html"><![CDATA[<p>上一期介绍了关于组学数据的一些基本分析方法，当我们那搭配样本的组学数据之后，能够基于基因的表达量和样本的分组信息进一步筛选biomarker（idea1、idea2），同时进一步结合样本的临床、生理病理、生化等作为一种性状数据（idea3），整合基因的表达，筛选出受到基因表达影响的某种关键性状相关基因集，常见的方法如下。</p><h3 id="1-idea1-差异分析-功能分析"><a href="#1-idea1-差异分析-功能分析" class="headerlink" title="1.idea1 差异分析+功能分析"></a>1.idea1 差异分析+功能分析</h3><p>对基因的表达量进行不同组间的差异分析或者共表达分析，然后结合数据库的注释结果，分析基因功能或者互作关系，最终目的是找到有生物学意义的差异表达基因。</p><h4 id="1-1-差异分析"><a href="#1-1-差异分析" class="headerlink" title="1.1 差异分析"></a>1.1 差异分析</h4><p>当获得了可以进行分析的数据之后，我们可以继续基于表达丰度，在大量的样本研究中寻找不同组件的差异表达基因或者蛋白。 </p><p>其中，转录组的差异分析使用DESeq2、EdgeR方法，不过目前研究发现，大样本量的研究中，这两种方法也存在假阳性的情况，所以个人建议使用Wilcoxon rank sum test的非参数检验进行分析。  蛋白组的差异分析经常用方差分析、T检验以及基于DEqMS的R包进行差异分析。关于DEqMS的R包使用，这里有一个简单的例子：</p><p>DEqMS（Differential Expression analysis for Quantitative Mass Spectrometry）是一个用于基于质谱的定量蛋白质组学数据差异表达分析的R包。它可以帮助研究人员识别在不同条件或组之间表达水平有显著变化的蛋白质。</p><ol><li><p><strong>安装和加载DEqMS包</strong><br>如果你尚未安装DEqMS包，请先安装它。在R中，你可以使用以下命令安装：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="punctuation">(</span><span class="operator">!</span>requireNamespace<span class="punctuation">(</span><span class="string">&quot;BiocManager&quot;</span><span class="punctuation">,</span> quietly <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">    install.packages<span class="punctuation">(</span><span class="string">&quot;BiocManager&quot;</span><span class="punctuation">)</span></span><br><span class="line">BiocManager<span class="operator">::</span>install<span class="punctuation">(</span><span class="string">&quot;DEqMS&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>然后加载DEqMS包：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>DEqMS<span class="punctuation">)</span></span><br></pre></td></tr></table></figure></li><li><p><strong>准备数据</strong><br>DEqMS需要两个主要的数据输入：蛋白质定量值和对应的蛋白质注释信息。定量值通常来自于质谱仪器的输出，而注释信息则包含了蛋白质的 accession number、基因符号等。<br>假设您已经有了一个包含蛋白质定量值的dataframe，名为<code>protein_expression</code>，以及一个包含蛋白质注释信息的dataframe，名为<code>protein_annotations</code>。</p></li><li><p><strong>数据预处理</strong><br>在进行差异表达分析之前，通常需要对数据进行预处理，例如去除缺失值、标准化等。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设我们的定量数据在名为Intensity的列中</span></span><br><span class="line"><span class="comment"># 我们将使用DEqMS中的normalize()函数进行标准化</span></span><br><span class="line">normalized_data <span class="operator">&lt;-</span> DEqMS<span class="operator">::</span>normalize<span class="punctuation">(</span>protein_expression<span class="operator">$</span>Intensity<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将标准化后的数据合并回原来的dataframe</span></span><br><span class="line">protein_expression<span class="operator">$</span>Normalized_Intensity <span class="operator">&lt;-</span> normalized_data</span><br></pre></td></tr></table></figure></li><li><p><strong>设置比较组</strong><br>在进行差异表达分析之前，您需要定义要比较的组别。这通常通过创建一个设计矩阵来实现。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设我们有两个组别：对照组和治疗组</span></span><br><span class="line"><span class="comment"># 我们创建一个名为Group的列，其中对照组为1，治疗组为2</span></span><br><span class="line">protein_expression<span class="operator">$</span>Group <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>protein_expression<span class="operator">$</span>Condition <span class="operator">==</span> <span class="string">&quot;Control&quot;</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建设计矩阵</span></span><br><span class="line">design <span class="operator">&lt;-</span> model.matrix<span class="punctuation">(</span><span class="operator">~</span><span class="number">0</span> <span class="operator">+</span> protein_expression<span class="operator">$</span>Group<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>design<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Control&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Treatment&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure></li><li><p><strong>进行差异表达分析</strong><br>使用DEqMS包中的<code>runDEqMS()</code>函数进行差异表达分析。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设我们关注的是治疗组与对照组的差异</span></span><br><span class="line"><span class="comment"># 设置对比矩阵，这里我们关注治疗组相对于对照组的差异</span></span><br><span class="line">contrast.matrix <span class="operator">&lt;-</span> makeContrasts<span class="punctuation">(</span>Treatment <span class="operator">-</span> Control<span class="punctuation">,</span> levels <span class="operator">=</span> design<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行差异表达分析</span></span><br><span class="line">DE.results <span class="operator">&lt;-</span> DEqMS<span class="operator">::</span>runDEqMS<span class="punctuation">(</span>protein_expression<span class="punctuation">,</span> design<span class="punctuation">,</span> contrast.matrix<span class="punctuation">)</span></span><br></pre></td></tr></table></figure></li><li><p><strong>结果解读</strong><br><code>DE.results</code>中包含了差异表达分析的结果，您可以查看哪些蛋白质在不同的组别中显著差异表达。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看显著差异表达的蛋白质</span></span><br><span class="line">significant.proteins <span class="operator">&lt;-</span> DE.results<span class="punctuation">[</span>DE.results<span class="operator">$</span>padj <span class="operator">&lt;</span> <span class="number">0.05</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br></pre></td></tr></table></figure></li><li><p><strong>可视化</strong><br>DEqMS包也提供了一些可视化工具，帮助您更直观地查看分析结果。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制火山图</span></span><br><span class="line">volcanoPlot<span class="punctuation">(</span>DE.results<span class="punctuation">,</span> logFC.cutoff <span class="operator">=</span> <span class="number">0.58</span><span class="punctuation">,</span> p.cutoff <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制MA图</span></span><br><span class="line">MAplot<span class="punctuation">(</span>DE.results<span class="punctuation">,</span> cutoff <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><p>以上步骤仅为一个简单的示例，实际使用时，你可能需要根据具体的数据格式和分析需求进行调整。DEqMS包的官方文档提供了更详细的参数设置和函数说明。</p></li></ol><hr><p>此外，线性回归分析用于评估基因丰度与其他因素之间的关系，用于特征基因的筛选。线性，也就是可以用一个量化的解释变量来预测一个量化的响应变量； 回归则是通过历史数据进行预测。我们如果想要更好的了解基因集之间的一些潜在联系，可以考虑使用LASSO回归方法（least absolute shrinkage and selection operator）。</p><p>LASSO(Least Absolute Shrinkage and Selection Operator)是最常用的方法之一，<strong>以缩小变量集为核心思想的压缩方法，使某些不重要变量的回归系数变为0，从而选择对因变量影响较大的自变量并计算出相应的回归系数</strong>，进行下游分析，交叉验证用于确证结果中的取值是否最佳。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240425225421625.png" alt="image-20240425225421625"></p><h4 id="1-2功能分析"><a href="#1-2功能分析" class="headerlink" title="1.2功能分析"></a>1.2功能分析</h4><p>功能分析旨在系统性地揭示显著表达变化基因的功能内涵及其在复杂生物过程中的作用机制，需要明白下面这些事情</p><h5 id="1）-目标明确：基因功能与通路解析"><a href="#1）-目标明确：基因功能与通路解析" class="headerlink" title="1）. 目标明确：基因功能与通路解析"></a><strong>1）. 目标明确：基因功能与通路解析</strong></h5><p><strong>基因功能探索</strong>：</p><ul><li><strong>分子功能</strong>：揭示显著差异基因在生物化学反应、分子互动、结构构成等方面的特定功能，如酶活性、受体结合、信号转导等。</li><li><strong>生物过程</strong>：定位差异基因参与的生理或病理过程，如细胞周期调控、免疫应答、代谢途径、神经传导等。</li><li><strong>细胞组分</strong>：阐明差异基因在细胞结构、亚细胞器、细胞间通讯等层面的作用，如细胞膜、线粒体、细胞核、分泌囊泡等。</li></ul><p><strong>通路解析</strong>：</p><ul><li><strong>关键通路识别</strong>：聚焦与研究目的密切相关的显著变化通路，如癌症相关的PI3K&#x2F;AKT&#x2F;mTOR通路、炎症反应的NF-κB通路、细胞凋亡的Caspase通路等。</li><li><strong>通路动态</strong>：分析通路内基因的整体表达趋势（上调、下调）和相对丰度变化，揭示通路在特定条件下的激活、抑制或重塑状态。</li></ul><p><strong>2）多维度数据整合与深度解析</strong></p><p><strong>基因注释</strong>：</p><ul><li><strong>详细注释信息</strong>：从GO、KEGG、Reactome、DO等数据库获取差异基因的详细注释信息，包括但不限于：GO术语、通路名称、疾病关联、药物靶点等。</li><li><strong>层次化注释</strong>：按照分子功能、生物过程、细胞组分三个层次进行注释，构建差异基因的多层次生物学属性图谱。</li></ul><p><strong>富集分析</strong>：</p><ul><li><strong>统计学检验</strong>：<ul><li><strong>超几何检验</strong>：针对每个预定义的生物学类别（如GO术语、KEGG通路），计算差异基因的富集概率，评估其在该类别中的过表达或欠表达是否显著。</li><li><strong>多重校正</strong>：应用FDR校正或其他方法控制假阳性率，确保富集结果的统计学可靠性。</li></ul></li><li><strong>全局表达谱分析</strong>：<ul><li><strong>GSEA</strong>：根据整个基因集在表达谱中的排名，评估预定义基因集（如MSigDB中的C2、C5集合）与样本分组间的关联强度，识别在整体丰度变化中具有显著意义的基因集。</li><li><strong>权重得分</strong>：计算基因集的NES（Normalized Enrichment Score）或ES（Enrichment Score），反映基因集的富集程度和方向。</li></ul></li></ul><p><strong>调控网络构建</strong>：</p><ul><li><strong>蛋白质互作网络</strong>：利用STRING数据库，基于实验验证、同源性推断、文本挖掘等多种证据来源，构建差异蛋白间的直接或间接互作关系网络。</li><li><strong>网络特性分析</strong>：<ul><li><strong>核心蛋白识别</strong>：计算节点的度、介数、聚类系数等网络指标，识别在网络中占据中心位置、可能发挥关键调控作用的核心蛋白。</li><li><strong>模块划分</strong>：运用社区检测算法，将网络划分为多个功能相关的子模块，揭示潜在的调控子系统。</li></ul></li></ul><p><strong>多层次关联</strong>：</p><ul><li><strong>转录因子靶基因预测</strong>：利用ENCODE、ChIP-seq等数据资源，预测差异基因作为特定转录因子靶点的可能性，揭示转录调控网络的变化。</li><li><strong>miRNA调控分析</strong>：结合miRNA表达数据和靶基因预测软件（如TargetScan、miRanda），分析差异基因是否受到差异表达miRNA的调控。</li><li><strong>表观遗传学关联</strong>：考察差异基因的DNA甲基化、组蛋白修饰、染色质开放性等表观遗传标记的变化，揭示表观遗传调控与基因表达变化的关联。</li></ul><p><strong>3）生物学意义诠释与应用前景</strong></p><p><strong>结果解读</strong>：</p><ul><li><strong>生物学机制推测</strong>：结合富集分析结果和现有文献，推测显著通路或功能在研究背景下的具体作用机制，如通路激活如何驱动肿瘤进展、特定功能如何影响细胞分化等。</li><li><strong>因果关系推理</strong>：根据差异基因在通路中的位置、功能和表达变化，推断其在特定生物学过程中的因果作用，如上游激酶的激活如何导致下游效应基因的表达上调。</li></ul><p><strong>可视化展示</strong>：</p><ul><li><strong>富集结果可视化</strong>：绘制条形图、火山图、富集热图等，直观展示显著富集的GO术语、KEGG通路及其统计显著性。</li><li><strong>网络图可视化</strong>：利用Cytoscape等工具绘制蛋白质互作网络、转录因子调控网络等，通过节点颜色、大小、形状等视觉元素展示基因属性和网络特性。</li></ul><p><strong>实验验证与应用导向</strong>：</p><ul><li><strong>候选基因&#x2F;通路验证</strong>：设计qPCR、Western blot、CRISPR&#x2F;Cas9敲除&#x2F;过表达、小分子药物处理等实验，验证候选基因的功能效应、基因-通路关联、基因-表型关联等。</li><li><strong>临床应用潜力评估</strong>：<ul><li><strong>诊断标志物</strong>：分析差异基因或通路在患者队列中的表达模式，评估其作为疾病分类、预后预测或疗效监控标志物的潜力。</li><li><strong>治疗靶点</strong>：研究针对核心蛋白或关键通路的小分子抑制剂、抗体药物、基因疗法等，评估其作为治疗策略的有效性和安全性。</li></ul></li></ul><p>因此，功能分析是一项深入而细致的研究工作，它通过多维度数据整合、深度的生物信息学解析、严谨的生物学意义诠释和实验验证，全面揭示基因表达数据背后的生物学故事，解释相关的疾病致病机制和蛋白作用机制。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240425233416109.png" alt="image-20240425233416109"></p><hr><h4 id="1-3-相关性分析"><a href="#1-3-相关性分析" class="headerlink" title="1.3 相关性分析"></a>1.3 相关性分析</h4><p>相关性分析是指对两个或以上的具有潜在相关性的变量进行的关联分析，根据变量的变化模式&#x2F;规律，利用得到的相关系数来评估两个或以上的变量元素的相关密切程度。相关系数一般介于-1~1之间，绝对值越靠近1，相关性越强，其中-1为完全负相关，1为完全正相关，0为不相关。</p><p>1）<strong>Pearson相关系数</strong>（也称为皮尔逊积矩相关系数）基于协方差的概念，它是衡量两个随机变量间线性相关程度的统计量。其计算公式为：</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240426003851803.png" alt="image-20240426003851803"></p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240426005207009.png" alt="image-20240426005207009" style="zoom:33%;"><p>计算过程中，首先通过标准化处理消除量纲影响和数据尺度差异，然后计算变量间协方差与各自标准差的乘积，最终得到一个无量纲的系数。只有当数据满足正态分布且变量间存在线性关系时，Pearson相关系数才最具解释力。</p><p>2）<strong>Spearman秩相关系数</strong>是一种非参数统计方法，它基于秩次统计而非原始数值进行计算。其基本思想是将每个变量的所有观测值按照大小排序，赋予相应的秩次，然后计算这两个秩序列间的相关性。计算公式为：</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240426005526918.png" alt="image-20240426005526918" style="zoom:50%;"><p>由于其计算过程不涉及原始数值，而是关注变量间的排序关系，因此对数据分布类型和异常值不敏感，<strong>适用于非正态分布数据和等级数据的关联分析</strong>。它基于每个变量的排名值而非原始数据，使用单调函数来描述两个变量之间的关系程度，获取两个变量元素之间的变化趋势。那么当数据符合正态分布时，分析效率上Spearman与Pearson是等价的。Spearman相关系数同样取值于-1到1之间，性质与Pearson相关系数类似。</p><p>常用可视化包括：热图、桑基图、线性散点图等。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240426005813429.png" alt="image-20240426005813429"></p><p><strong>应用场景与实例</strong></p><p><strong>Pearson相关应用实例</strong>：在金融投资领域，研究者可能运用Pearson相关分析股票价格变动与宏观经济指标（如GDP增长率、失业率等）的关系。若发现两者间存在显著的正相关，投资者可能会据此调整投资策略，预期在经济向好时股票市场表现也将提升。</p><p><strong>Spearman相关应用实例</strong>：在教育心理学研究中，为探究学生的学习动机与学习成绩之间的关联，但收集到的数据可能存在极端值或非正态分布，此时选择Spearman相关更为合适。即使某些学生的动机得分或成绩偏离常态，只要其相对排序保持一致，Spearman相关仍能有效捕捉动机与成绩间的单调递增或递减关系。</p><p><strong>可视化展示</strong></p><p><strong>热图</strong>：在多元相关性分析中，热图以矩阵形式呈现各变量间的相关系数，颜色深浅代表相关强度。例如，研究者可通过热图快速识别一组健康指标（如血压、血糖、体重等）之间的强弱关联，深红色区块表示高度正相关，深蓝色区块表示高度负相关，白色或浅色表示无明显关联。</p><p><strong>桑基图</strong>：尽管桑基图主要用于能量流动、资源分配等流程分析，但在特定条件下也可用于展示变量间复杂的相关结构。例如，通过构建桑基图可以直观展示不同行业板块股票收益率之间的资金流动与相关性，箭头宽度代表资金流量，颜色编码表示相关性强弱，从而揭示股市中各板块间的联动效应。</p><p><strong>线性散点图</strong>：这是最直观的二维相关性可视化工具。每个数据点代表一对变量观测值，点的分布模式揭示了变量间是否存在线性趋势。例如，绘制年龄与收入的散点图，若点大致沿一条直线分布，且斜率为正，说明年龄与收入呈正相关；反之，若点分布呈反向倾斜，说明两者负相关。通过拟合最佳线性回归线（通常为最小二乘法），可进一步量化这种线性关系。</p><p><strong>平行坐标图 (Parallel Coordinates Plot)</strong>:<br>这种图形适合展示多维数据集中变量间的相关性。每个数据点在多个垂直平行轴上表示其在各个维度上的值，通过连接同一数据点在各轴上的投影形成一条折线。观察折线的分布和交叉情况，可以直观识别变量间的关联模式。例如，在研究汽车性能时，可以使用平行坐标图展示车辆重量、马力、燃油效率、价格等多个属性之间的相互关系，寻找是否存在某些属性组合（如高马力与高价格）经常同时出现。</p><p><strong>网络图 (Network Graph)</strong>:<br>网络图用于展示变量之间的复杂关联结构，特别是当变量间的关系并非简单的一对一对应时。节点代表变量，边的权重或颜色表示变量间的相关性强度。在网络图中，簇状结构或中心节点的存在往往暗示着变量间的强相关或核心关联。例如，在社交媒体数据分析中，可以构建用户行为网络图，节点代表用户，边的权重依据用户间的互动频率（如共同发帖、点赞、评论等）确定，从而揭示用户群体间的社交网络结构及其相关性。</p><p><strong>雷达图 (Radar Chart)</strong>:<br>雷达图特别适用于展示个体在多个维度上的表现及其相对优势或劣势。虽然雷达图主要用来比较不同实体在多变量上的整体概况，但它也能间接反映变量间的相关性。如果一个实体在某几个变量上的得分高度相关（即同时高或同时低），那么这些变量在雷达图上的“尖角”会靠近，形成明显的关联特征。例如，在评估员工绩效时，雷达图可以展示员工在技能、沟通能力、项目完成度、团队协作等多方面的得分，通过观察图形形态，可以判断各项能力间是否存在协同效应或互补关系。</p><p><strong>气泡图 (Bubble Chart)</strong>:<br>气泡图是散点图的一种变体，除了用点的位置表示两个变量的关系外，还通过点的大小表示第三个变量的值。这种图形有助于同时展示三元关系中的相关性和变量强度。例如，在分析公司市值、利润和员工数量之间的关系时，可以用横纵坐标分别表示市值和利润，气泡大小代表员工数量。观察气泡的分布和大小变化，可以发现市值与利润之间的线性关系，以及员工数量对此关系的影响。</p><p><strong>马赛克图 (Mosaic Plot) 或条形图矩阵</strong>:<br>这两种图形常用于展示分类变量间的联合分布和条件概率，特别适用于离散型数据。它们通过矩形面积的相对大小来直观表示各类别组合的频数或比例，从而揭示类别间的关联性。例如，在市场调研中，可以创建马赛克图或条形图矩阵展示消费者性别、年龄层次与购买偏好（如电子产品、服装、食品等类别）的联合分布，直观看出哪些性别和年龄段的消费者更倾向于购买特定类型的商品。</p><p><strong>动态可视化</strong>:<br>随着数据科学和信息技术的发展，动态可视化越来越受到青睐。通过动画、滑动条或交互式界面，用户可以随时间推移观察相关性变化，或者在不同参数设置下探索相关性模式。例如，可以制作一个动态散点图，随着时间滑块移动，显示股票价格与市场情绪指标（如新闻情绪分析得分）之间的实时相关性变化，帮助投资者理解市场情绪如何影响股价波动。</p><hr>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;上一期介绍了关于组学数据的一些基本分析方法，当我们那搭配样本的组学数据之后，能够基于基因的表达量和样本的分组信息进一步筛选biomarker（idea1、idea2），同时进一步结合样本的临床、生理病理、生化等作为一种性状数据（idea3），整合基因的表达，筛选出受到基因表</summary>
      
    
    
    
    
    <category term="多组学数据分析" scheme="http://nikolahuang.github.io/tags/%E5%A4%9A%E7%BB%84%E5%AD%A6%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>代谢组学数据分析基本知识</title>
    <link href="http://nikolahuang.github.io/2024/04/05/%E4%BB%A3%E8%B0%A2%E7%BB%84%E5%AD%A6%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/"/>
    <id>http://nikolahuang.github.io/2024/04/05/%E4%BB%A3%E8%B0%A2%E7%BB%84%E5%AD%A6%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/</id>
    <published>2024-04-05T15:17:27.000Z</published>
    <updated>2024-04-05T16:50:55.182Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><p>代谢组学的数据分析包括：对检测到的原始数据进行数据预处理、数据质控、代谢物定量分析、生信数据挖掘等。</p><h3 id="1-数据预处理"><a href="#1-数据预处理" class="headerlink" title="1.数据预处理"></a>1.数据预处理</h3><p>软件解析测序的色谱、质谱得到的图谱转变为可进行计算的数据文件，就得到了原始数据，一般的解析软件包括：Progenesis QI、<strong>MassProfiler Professional (MPP)<strong>、</strong>Sieve</strong>、<strong>MetaboAnalyst</strong>、<strong>Simca-p</strong>（代谢组学中最常用的统计分析软件）</p><p>如何使用上述的软件这里就不一一赘述了，网上有很多教程。</p><p>为了消除存在的外在因素干扰或人为实验因素影响，预处理数据可以增加数据的稳定性，常见的预处理数据步骤主要包括：</p><ul><li>降噪：通过<strong>匹配滤波</strong>和<strong>移动窗平均滤波</strong>等方法，去除掉数据中来自样品制备或仪器产生的背景噪音。</li><li>基线校准：当没有物质时，获得的谱图强度应该为0，所有的测得的谱图强度都应以此为基准，因此需要调零校准，可以通过将同样一谱图的所有数据值减去最小值，来让基准线为0.</li><li>解卷积：由于物质的保留时间太接近，或者峰的宽度过大，导致多个色谱的峰没有分离而共流出时，代表多个物质的峰就会重叠或交叉在一起。解卷积，就是利用数学计算方法将色谱中未能锋利的组分重新区分。</li><li>峰对齐：为了校准由于仪器不稳定、样品pH和浓度等因素带来的时间偏移，需要进行峰的对齐，让所有样本中代表同一物质的谱峰保留时间一致。</li><li>峰识别：确定峰的起点和终点。</li><li>峰的特征提取：提取峰高或计算峰下的覆盖面积。</li><li>归一化处理：为了使不同浓度的样品之间能够具有可比性，我们需要对数据进行峰面积的归一化处理，常用的处理方法有Ctr（Center scaling），UV（unit variance scaling）和Par（Pareto scaling）。  Ctr也叫<strong>中心化</strong>，将原始数据减去每列变量的均值；UV是数据Ctr化之后，除以列变量的标准差（SD）；Par是数据Ctr后处理列变量标准差的算术平方根。 Ctr将原始数据转化成离原点更近的新数据，可调节代谢物的高低浓度差异；UV的优势是所有的变量都拥有同样的权重，等同于相当的地位，缺点是某些检测误差可能会被放大；Par相比于UV则更接近院士测量数据，缺点是对变化倍数大的变量会更加敏感，容易造成不必要的变换结果。</li></ul><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240401233909049.png" alt="image-20240401233909049" style="zoom:50%;"><h3 id="2-数据的质控（QC）"><a href="#2-数据的质控（QC）" class="headerlink" title="2.数据的质控（QC）"></a>2.数据的质控（QC）</h3><p>样品较多时，我们想要获得可靠且高质量的代谢组学数据，则需要在检测时利用QC样本进行质控；QC样本时所有待测样品等量的混合物，不过若是临床样本，由于数量较多，采样时间长，则可以挑选代表性样品制备合适的QC。每间隔一定样品，添加一组QC，这样就能提供数据重复性的有效评价标准。</p><p>理论上所有的QC样本要都是相同的，不过在样品提取、监测分析过程会产生系统的误差，导致QC之间也会有差异，如果RSD&lt;30%的特征峰，比例能达到70%以上，则说明数据良好，差异越小说明方法稳定性越高，数据质量也就越好，这<strong>体现在PCA分析图上，也就是QC样本越密集，数据越可靠</strong>。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240401234526629.png" alt="image-20240401234526629" style="zoom:50%;"><h3 id="3-代谢物的定性和定量"><a href="#3-代谢物的定性和定量" class="headerlink" title="3.代谢物的定性和定量"></a>3.代谢物的定性和定量</h3><p><strong>代谢物的定性：</strong>GC-MS数据库成熟，数据量足够，一级质谱可定性，即了解化合物的分子量；二级谱图可以对化合物的结构进行分析。我们将GC质谱图与NIST、GMD数据库进行比对，将LC-MS的二级谱图与Metlin、HMDB、MzCloud等数据库或者实验室自建的数据库中的谱图进行匹配比对，就可以的搭配化合物具体的注释信息。</p><p><strong>代谢物的定量：</strong>GC-MS他一般时通过化合物色谱峰面积来对物质进行定量的，当遇到分离度不好，色谱峰形不好，比如严重拖尾的时候，峰的面积测定就会引起很大的误差，此时可考虑使用峰高法进行定量。峰高法，顾名思义通过测量色谱图中某个组分峰的高度来对该组分进行定量。峰高法的基本原理是假设峰高（或峰面积）与组分的量成正比。具体来说，峰高法涉及以下步骤：</p><ol><li><strong>选择参考峰</strong>：首先，需要选择一个已知浓度的标准品作为参考峰。这个标准品应该是纯净的，并且浓度已知。</li><li><strong>建立标准曲线</strong>：通过分析不同浓度的标准品，可以得到一系列峰高与浓度对应的数据。利用这些数据，可以绘制出标准曲线。标准曲线通常是一条直线，表明峰高（或峰面积）与浓度之间的关系是线性的。</li><li><strong>测量样品峰高</strong>：在分析实际样品时，测量与标准品相对应的组分的峰高。</li><li><strong>定量分析</strong>：将样品峰高与标准曲线进行比较，根据标准曲线可以确定样品中组分的浓度。</li></ol><p>峰高法的优点是操作简单，不需要复杂的仪器设备。但是，这种方法假设色谱峰的形状和宽度在分析过程中保持不变，这在实际操作中可能并不总是成立。此外，峰高法对基线的波动比较敏感，因此对于基线不稳定的色谱图，定量结果可能会有较大误差。</p><p>LC-MS&#x2F;MS利用一级质谱得到的木例子峰面积进行定量。非靶通常选择内标法进行相对定量。将内标物质，定量的加到样品中，根据预测组分和内标峰的面积或者峰高的比值进行相对定量分析。</p><h3 id="4-代谢组学的生信分析"><a href="#4-代谢组学的生信分析" class="headerlink" title="4.代谢组学的生信分析"></a>4.代谢组学的生信分析</h3><h4 id="4-1-聚类分析"><a href="#4-1-聚类分析" class="headerlink" title="4.1 聚类分析"></a>4.1 聚类分析</h4><p>聚类分析一般有两个作用，包括：通过全部代谢物的表达谱对样本进行聚类，分析样本重复性的好坏以及分组情况；或者把表达模式相近的代谢物进行聚类，去大致的观察<strong>代谢物丰度在各组中的变化规律</strong>，常用图形包括<strong>聚类树状图</strong>和<strong>热图</strong>。</p><ol><li><strong>主成分分析（PCA）</strong>: PCA是一种广泛使用的数据降维算法，它通过找出数据矩阵的方差最大方向作为第一主成分（PC1），然后在与PC1正交的平面中找出方差最大的方向作为第二主成分（PC2），以此类推。这样建立的低维平面或空间有助于分析和概览整个数据集，揭示数据集中的分组、趋势以及离群值  。</li><li><strong>偏最小二乘判别分析（PLS-DA）</strong>: PLS-DA结合了降维和回归模型，通过多元线性回归技术找到数据集和类别数据集之间的最大协方差方向，建立两个独立数据集的潜在关联分析方法。</li><li><strong>正交偏最小二乘判别分析（OPLS-DA）</strong>: OPLS-DA是PLS-DA的改进版本，它根据数据集Y的差异将数据集X的差异分为两个部分，一部分代表与Y相关的差异，另一部分代表与Y不相关的差异。OPLS-DA可以更好地区分组间差异，提高模型的有效性和解析能力。</li><li><strong>差异倍数分析</strong>: 这是一种简单的分析方法，用于快速考察各个代谢物在不同组别之间的含量变化大小。它通过计算实验组与对照组的含量比值（Fold Change，FC）来实现。</li><li><strong>显著性检验</strong>: 这包括t-test、方差分析（ANOVA）等方法，用于区分变量是否具有统计显著性。在代谢组学中，由于变量较多，常需要进行多重假设检验并对p值进行校正，以减少Ⅰ类错误和假阳性。</li><li><strong>韦恩图</strong>: 也称文氏图，用于反映不同集合之间的交集和并集情况。在代谢组学中，韦恩图通常用于展示不同比较组之间的共有和独特的差异代谢物。</li><li><strong>箱线图</strong>: 箱线图用于展示不同组间代谢物含量的分布情况。在R语言中，常用的包如ggplot2和ggpubr可用于绘制箱线图，并可以添加样本散点、坐标标题以及p值等统计信息 。</li></ol><p>数据集通常为一个<strong>N × K</strong>的矩阵（X矩阵），N表示N个样本数，每一行代表一个样品， K表示K个变量，每一列代表一个变量，在代谢组学中变量通常是指代谢物含量。最常用的分析方法如图所示：</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/bb4be438cdaa02232c87ea6fc4a50eb5.png" alt="img"></p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240402234016514.png" alt="image-20240402234016514" style="zoom:33%;"><h4 id="4-2-多元统计分析"><a href="#4-2-多元统计分析" class="headerlink" title="4.2 多元统计分析"></a>4.2 多元统计分析</h4><p>代谢组学数据具有多为且某些变量间高度相关，运用传统的单变量分析无法快速、充分、准确地挖掘数据内潜在的信息。 因此对采集的多维数据，一般进行将为和归类分析（聚类），来挖掘和提炼最有用的信息。</p><p>常用的方法包括：无监督学习的PCA分析，有监督的PLS-DA分析、在PLS-DA基础上，可以加入正交信号矫正的有监督性OPLS-DA分析。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240403230538945.png" alt="image-20240403230538945" style="zoom:33%;"><h4 id="4-3-差异分析"><a href="#4-3-差异分析" class="headerlink" title="4.3 差异分析"></a>4.3 差异分析</h4><p>代谢组学分析中，除了通常用到的Student’s t检验、ANOVA检验来获得P值筛选不同比较组间的差异代谢物，通常还结合多元统计分析PL-DA或者OPLS-DA的VIP值来进行筛选。也就是差异代谢物的阈值条件：OPLS-DA模型中 VIP≥1，且Student T test的P＜0.05. 常用的图形包括差异柱状图、火山图、VIP图、z-score、热图和ROC图等，进行必要的数据展示。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240403232839397.png" alt="image-20240403232839397"></p><h4 id="4-4-差异KEGG富集分析"><a href="#4-4-差异KEGG富集分析" class="headerlink" title="4.4 差异KEGG富集分析"></a>4.4 差异KEGG富集分析</h4><p>在生物体内，不同的基因之间，相互协调来行使生物学功能，基于Pathway的分析有助于更进一步的了解基因的生物学功能和生物学研究的意义，甚至为临床的诊断和治疗提供一些思路、方法和理论基础。</p><p>KEGG是有关pathway的主要数据库，pathway显著性富集分析，应用超几何检验分析，找出与整个背景（基因、蛋白谱、QC样本等）相比，在差异代谢物中显著富集的pathway，从而确定差异代谢物残余的最主要生化代谢途径和信号转导方式。</p><p>常见的图形包括：富集柱状图、富集通路图、富集热图、富集圈图、富集差异气泡图等。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240404001039675.png" alt="image-20240404001039675" style="zoom:33%;"><p>传统的KEGG富集分析如果没有找到与研究相关的代谢通路，可以利用MSEA分析(Metabolite Set Enrichment Analysis)。 MSEA的QEA pattern类似于基因分析中的GSEA富集分析，主要利用The Small Molecule Pathway Database(<a href="https://smpdb.ca/">SMPDB</a>)数据库来进行对所有样本中鉴定到的代谢物的确定，以及解释一些重要的生物学通路中，代谢物的变化模式。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240404095441803.png" alt="image-20240404095441803" style="zoom:33%;"><h4 id="4-5-趋势分析"><a href="#4-5-趋势分析" class="headerlink" title="4.5 趋势分析"></a>4.5 趋势分析</h4><p>趋势分析，是针对多个连续样本（至少三个）的特征（样本间包含特定的时间、空间或者处理剂量的大小顺序）来对代谢物的表达模式（多阶段中表达曲线的形状）进行聚类。通过趋势分析可以找到和可视化代谢物在连续变化的组中丰度的变化趋势。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240404101453551.png" alt="image-20240404101453551" style="zoom:33%;"><p>注：基于生信分析的组学数据挖掘思路，目前我了解的基本可以分成三步走，简单点就是<strong>俯瞰-拉近-聚焦</strong>，也就是整体到局部再到某个单一的点的过程。 以测序得到的海量数据作为起点，不断根据研究目标，引导和矫正数据挖掘的方向，最后确定对研究目标其重要调控的基因、蛋白、代谢物、小分子等。</p><p>代谢组学，借助<strong>差异分析</strong>、<strong>趋势分析</strong>、<strong>WGCNA</strong>分析等等，完成海量数据挖掘的第一步，完成了俯瞰到拉近的转换，获得<strong>目标代谢物集合</strong>。需要思考的是，这些<strong>代谢物具备哪些调控功能</strong>？<strong>能影响哪些生物学途径（拉近到聚焦的过程）</strong>。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240404102823696.png" alt="image-20240404102823696" style="zoom:33%;"><h3 id="5-常见代谢组学富集分析"><a href="#5-常见代谢组学富集分析" class="headerlink" title="5.常见代谢组学富集分析"></a>5.常见代谢组学富集分析</h3><p>富集分析常见的就是<strong>KEGG、MetPA和MSEA</strong>了。</p><p>三种分析策略都是以代谢物的定性定量表作为起始点，无论是自己平台还是公司的质谱检测，都可以得到这个数据表，表格中需要包含：代谢物名称、在不同样本中的风度信息等。 以此为基础借助富集分析和其他的一些分析手段找到目标代谢途径和目标代谢物。</p><h4 id="5-1-KEGG富集"><a href="#5-1-KEGG富集" class="headerlink" title="5.1 KEGG富集"></a>5.1 KEGG富集</h4><p>特定实验背景下，代谢物的丰度变化并非随机，往往会为了响应实验处理呈现出特定的变化趋势。 例如，动物受疾病感染后，脂类代谢、氨基酸代谢、胆汁酸代谢过程失调； 植物生长、变色过程中，花青素、类胡萝卜素、类黄酮等有机物的合成过程中，相关代谢物会随着发育成熟逐渐上调累积。</p><p>以此作为出发点，我们在特定的取样策略下，通过分析目标代谢物（包括差异代谢物、目标变化趋势代谢物、目标模块代谢物等）所在的pathway，来了解实验处理影响哪些代谢途径和内部的一些代谢物的调控方式，再结合研究目的锁定重要的代谢物。</p><h5 id="5-1-1-KEGG分析原理"><a href="#5-1-1-KEGG分析原理" class="headerlink" title="5.1.1 KEGG分析原理"></a>5.1.1 KEGG分析原理</h5><p>借助**超几何检验(Hypergeometric test)**判断:  质谱检测的有KEGG注释信息的代谢物（背景代谢集）在某个pathway中的代谢物数目占背景代谢集的比例，是否显著大于目标代谢集中有KEGG注释信息的代谢物（前景代谢集)在某个pathway中的代谢物数目的比例。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405011808041.png" alt="image-20240405011808041" style="zoom:33%;"><p>简单来说，其实就是上图中判断20%是否显著大于5%，根据得到的P value和FDR value判断前景代谢集主要参与的代谢途径。<strong>当P value或FDR value小于0.05时，则为显著富集的代谢途径</strong>。说明相比于其它途径而言，显著富集的代谢途径更易响应实验处理，出现异常调控。<br>对于KEGG富集分析，除了要有质谱检测的全部代谢物外，还要先有一个前景代谢集(又称目标代谢集，如图右侧的差异代谢集)。前景代谢集可通过前面说到的差异分析、趋势分析、WGCNA分析获得。</p><p>[^注]: 质谱检测得到的Name是代谢物的名称并非代谢物的KEGG注释结果，代谢物KEGG注释完成后用C_ID表示, 这个比较像基因的Symbol和ID号。代谢物开展KEGG富集分析时，需要先完成KEGG注释。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405012604262.png" alt="image-20240405012604262" style="zoom:33%;"><p>​                          超几何检验公式</p><p>[^注]: 公式中N为质谱检测得到的所有代谢物中有KEGG注释的代谢物数目; n为N中差异代谢物数目;M为所有代谢物中注释为某特定pathway的代谢物数目;m为注释为某特定pathway的差异表达代谢物数目。</p><h5 id="5-1-2-KEGG富集分析实现方法"><a href="#5-1-2-KEGG富集分析实现方法" class="headerlink" title="5.1.2 KEGG富集分析实现方法"></a>5.1.2 KEGG富集分析实现方法</h5><p>这里放一个基因和蛋白的富集方法，其他同理。<br>进入Metascape主页(<a href="http://www.metascape.org),将候选基因直接复制粘贴到gene/">www.metascape.org)，将候选基因直接复制粘贴到gene</a> list输入框中(Step1)，点击Submit按钮上传基因列表。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405014823504.png" alt="image-20240405014823504" style="zoom:50%;"><p>MetaScape支持的GeneID主要有Symbol、RefSeq、Ensembvl、Unipro、UCSC五种类型，下面使用Symbol进行演示：</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405120718749.png" alt="image-20240405120718749" style="zoom:50%;"><p>然后，在step2中选择对应的物种，我们这里选择人(H.sapiens)，点击<strong>Custom Analysis</strong>进行自定义分析。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405120952724.png" alt="image-20240405120952724" style="zoom:50%;"><p>在弹出的页面中，直接选择第4个选项(Enrichment)，仅勾选KEGG Pathway，取消勾选其他的数据来源，如下，然后勾选“跳过蛋白互作分析”</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405121130255.png" alt="image-20240405121130255" style="zoom:50%;"><p>然后继续点击<strong>Enrichment Analysis</strong>蓝色按钮进行富集分析。</p><p>分析完成之后，快速浏览富集的结果，之后点击<strong>Analysis Report Page</strong>，进入分析报告页面。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405121311431.png" alt="image-20240405121311431" style="zoom:50%;"><p>在分析报告页面中，点击<strong>Gene List Report Excel Sheets</strong>按钮，下载分析结果表格。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405124710592.png" alt="image-20240405124710592" style="zoom:50%;"><p>下载的分析结果表格如下，用于作图的数据主要在sheet2表格中。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405124909408.png" alt="image-20240405124909408" style="zoom:50%;"><p>完成KEGG富集分析之后，接下来我们使用ggplot2包对分析结果进行可视化！</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#载入相关的R包;</span></span><br><span class="line">library<span class="punctuation">(</span>readx1<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>tidyr<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#读入Excel数据</span></span><br><span class="line">dt <span class="operator">&lt;-</span> read_excel<span class="punctuation">(</span><span class="string">&quot;metascape_result.tobcfo25h.xlsx&quot;</span><span class="punctuation">,</span>sheet <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#预览数据;</span></span><br><span class="line">head<span class="punctuation">(</span>dt<span class="punctuation">)</span></span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405125240168.png" alt="image-20240405125240168" style="zoom:33%;"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#提取用于作图的列;</span></span><br><span class="line">df <span class="operator">&lt;-</span> dt<span class="punctuation">[</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="comment">#对InTerm_InList列进行拆分;</span></span><br><span class="line">df <span class="operator">&lt;-</span> separate<span class="punctuation">(</span>df<span class="punctuation">,</span>InTerm_InList<span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;/&quot;</span><span class="punctuation">,</span> into <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;count&quot;</span><span class="punctuation">,</span><span class="string">&quot;InTerm&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#转换数据类型;</span></span><br><span class="line">df<span class="operator">$</span>Count <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>df<span class="operator">$</span>count<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#根据Pvalue选择Top10的pathway进行绘制;</span></span><br><span class="line">fig_data<span class="operator">&lt;-</span> df <span class="operator">%&gt;%</span> top_n<span class="punctuation">(</span><span class="operator">-</span><span class="number">10</span><span class="punctuation">,</span>LogP<span class="punctuation">)</span> <span class="operator">%&gt;%</span> arrange<span class="punctuation">(</span>count<span class="punctuation">)</span></span><br><span class="line">fig_data</span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405130456181.png" alt="image-20240405130456181" style="zoom:50%;"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#转成因子，防止重新排序</span></span><br><span class="line">fig_data<span class="operator">$</span>Description <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>fig_data<span class="operator">$</span>Description<span class="punctuation">,</span>levels <span class="operator">=</span> fig_data<span class="operator">$</span>Description<span class="punctuation">,</span>ordered <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#预览数据</span></span><br><span class="line">fig_data</span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405133836309.png" alt="image-20240405133836309" style="zoom:50%;"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#建立数据与图形或者点之间的映射关系，确定点的（x,y）坐标，绘制散点图</span></span><br><span class="line">p1 <span class="operator">&lt;-</span> ggplot2<span class="punctuation">(</span>fig_data<span class="punctuation">,</span>aes<span class="punctuation">(</span>Count<span class="punctuation">,</span>Description<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>size <span class="operator">=</span> Count<span class="punctuation">,</span>color <span class="operator">=</span> LogP<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#隐藏坐标轴的标题</span></span><br><span class="line">p2 <span class="operator">&lt;-</span> p1<span class="operator">+</span>labs<span class="punctuation">(</span>y <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span></span><br><span class="line">p2</span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405135402721.png" alt="image-20240405135402721" style="zoom:50%;"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#自定义颜色渐变</span></span><br><span class="line">p3 <span class="operator">&lt;-</span> p2<span class="operator">+</span>scale_colour_gradient<span class="punctuation">(</span>low <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> high <span class="operator">=</span> <span class="string">&quot;yellow&quot;</span><span class="punctuation">)</span></span><br><span class="line">p3</span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405135520786.png" alt="image-20240405135520786" style="zoom:50%;"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置x轴范围，避免点溢出绘图区</span></span><br><span class="line">p4 <span class="operator">&lt;-</span> p3<span class="operator">+</span>scale_x_continuous<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5.5</span><span class="punctuation">,</span><span class="number">12.5</span><span class="punctuation">)</span><span class="punctuation">,</span>breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">6</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;6&quot;</span><span class="punctuation">,</span><span class="string">&quot;8&quot;</span><span class="punctuation">,</span><span class="string">&quot;10&quot;</span><span class="punctuation">,</span><span class="string">&quot;12&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">p4</span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405141114664.png" alt="image-20240405141114664" style="zoom:50%;"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#应用自带的主题</span></span><br><span class="line">p4<span class="operator">+</span>theme_light<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405141209923.png" alt="image-20240405141209923" style="zoom:50%;"><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#自定义图表主题，对图表做精细调整</span></span><br><span class="line">top.mar <span class="operator">=</span> <span class="number">0.2</span></span><br><span class="line">right.mar <span class="operator">=</span> <span class="number">0.2</span></span><br><span class="line">bottom.mar <span class="operator">=</span> <span class="number">0.2</span></span><br><span class="line">left.mar <span class="operator">=</span> <span class="number">0.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#隐藏坐标轴，并对字体样式、颜色、刻度长度等进行限定，</span></span><br><span class="line">mytheme <span class="operator">&lt;-</span> theme light<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>family<span class="operator">=</span><span class="string">&quot;sans&quot;</span><span class="punctuation">,</span>colour <span class="operator">=</span><span class="string">&quot;gray20&quot;</span><span class="punctuation">,</span>size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>axis.ticks <span class="operator">=</span> element_line<span class="punctuation">(</span>linewidth <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">,</span>colour<span class="operator">=</span><span class="string">&quot;gray20&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>axis.ticks.length <span class="operator">=</span>unit<span class="punctuation">(</span><span class="number">1.2</span><span class="punctuation">,</span>units <span class="operator">=</span>mm<span class="string">&quot;),plot.margin =unit(x=c(top.mar,right.mar,bottom.mar,left.mar),units=&quot;</span>inches<span class="string">&quot;))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">p4+mytheme</span></span><br></pre></td></tr></table></figure><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405143756258.png" alt="image-20240405143756258" style="zoom:50%;"><h4 id="5-2-MetPA富集-Pathway-topology-analysis"><a href="#5-2-MetPA富集-Pathway-topology-analysis" class="headerlink" title="5.2 MetPA富集(Pathway topology analysis)"></a>5.2 MetPA富集(Pathway topology analysis)</h4><p>除了挖掘代谢途径内部的代谢物调控机制，对于整个生物体而言，代谢途径间的相互作用形成的大的调控网络也具备重要的研究意义。代谢途径间的相互调控是维持整个内部环境稳态的重要基础。 <strong>经过KEGG富集分析后，我们可以发现表型差异是由多个代谢途径共同作用导致的，这些代谢途径之间是否又有位置上或者说地位上的优先级？</strong></p><p>MetPA富集分析，又叫做拓扑分析，以代谢途径未单位，但与KEGG富集不同，KEGG重点在解析目标代谢集主要参与的代谢途径是什么，筛选出显著富集的代谢物。</p><p>MetPA分析考虑生物体整体代谢网络，侧重突出在整个代谢网络中具备中药味点的代谢通路，结合统计分析检验核心代谢通路的显著性，再根据代谢途径内的信息，锁定重要的代谢物。  </p><p>目前有在线的一些工具可以使用：<a href="https://www.metaboanalyst.ca/">MetaboAnalyst5.0</a></p><p>可以在线完成对人、小鼠、大鼠、奶牛、斑马、果蝇等15个物种的分析，使用目标代谢集上传分析（也就是之前提到的前景代谢集）</p><h5 id="5-2-1-MetPA分析的原理"><a href="#5-2-1-MetPA分析的原理" class="headerlink" title="5.2.1 MetPA分析的原理"></a>5.2.1 MetPA分析的原理</h5><p>MetPA（Metabolic Pathway Analysis）是一种用于分析生物代谢网络中通路重要性的方法。在MetPA中，为了衡量或计算通路的位置信息，采用了两种中心性指标：Out-degree Centrality（出度中心性）和Relative-betweenness Centrality（相对中间中心性）。这些指标帮助研究者评估代谢通路在网络中的地位和作用。</p><p>Out-degree Centrality是评估网络中节点对外连通性的一个指标，它通过计算一个通路影响其他通路的数量来衡量其重要性。在代谢网络中，一个通路的Out-degree Centrality越高，表明它在网络中的影响范围越广，可能承担更为关键的功能。例如，在下图中，如果D通路能够影响B、C、E、F四个通路，那么D通路的Out-degree Centrality就是4，表示它具有较高的连通性和重要性。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405155403159.png" alt="image-20240405155403159" style="zoom:50%;"><p>然而，Out-degree Centrality仅考虑了一个节点对其他节点的影响，而忽略了其他节点对该节点的影响。在代谢过程中，<strong>调控往往是双向的</strong>，即某些代谢物既可以作为反应的产物影响后续反应，也可以作为反应的底物被其他代谢物影响。因此，单独使用Out-degree Centrality可能无法全面评估一个通路在代谢网络中的真实地位。</p><p>为了更全面地评估通路的重要性，MetPA还引入了Relative-betweenness Centrality这一指标。Relative-betweenness Centrality衡量的是一个通路在所有其他<strong>通路对</strong>之间的最短路径上的出现频率。一个通路的Relative-betweenness Centrality越高，表明它在网络中的信息传递和控制作用越强，可能是代谢网络中的关键“桥梁”。简单理解就是，网络中当两个通路不能直接调控时，就需要借助第三个v通路才能建立调控关系。因此，如果整个网络中有更多的通路需要借助第三方通路v才能建立调控关系，v通路就崛北极高的重要性，但是v的连通性并不一定是最高的，只是相对位置是最重要的。他的计算方式如下：</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405155641348.png" alt="image-20240405155641348" style="zoom:50%;"><p>[^注]: g(v):指v通路的betweenness centrality; ost(v): 指s通路到t通路之间经过v的最短路径数;  σst: 指s到t之间的所有最短路径数;</p><p>最后借助Fishers’Exact test、Hypergeometric Test、Globaltest等检验方式来判断通路的显著性，可以重点关注显著富集的通路。<strong>相比Out-degree Centrality，Relative-betweenness Centrality的统计方式更能从全局出发描述整个网络种通路相对位置的重要性。Relative-betweenness Centrality也是开发者非常推荐的统计方式。</strong></p><p>MetPA富集分析实现方法: MetaboAnalyst5.0(<a href="https://www.metaboanalyst.ca/)%EF%BC%8C%E6%97%A0%E9%9C%80%E6%B3%A8%E5%86%8C%EF%BC%8C%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4%E5%A6%82%E4%B8%8B%EF%BC%9A">https://www.metaboanalyst.ca/)，无需注册，操作步骤如下：</a></p><ol><li><p>登录网站，点击“Chick here to start“开始分析;</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405160333149.png" alt="image-20240405160333149" style="zoom:50%;"></li><li><p>分析模块选择Pathway Analysis；</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405195854139.png" alt="image-20240405195854139" style="zoom:50%;"></li><li><p>选择分析模式，可以只使用<strong>代谢物名称</strong>或者<strong>代谢物名称+丰度的矩阵数据</strong>进行分析。如果只关注代谢物，不关注丰度变化可选择使用<strong>代谢物名称(3.1)分析</strong>。若<strong>代谢物</strong>和<strong>丰度</strong>都关注，则选择<strong>3.2分析</strong>。该步骤会影响后续通路显著性的统计方式。</p><p>选择完成后点击“submit”</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405213549127.png" alt="image-20240405213549127" style="zoom:50%;"></li><li><p>数据确认过程，可直接点击“Proceed”</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405214005702.png" alt="image-20240405214005702" style="zoom:50%;"></li><li><p>代谢物丰度归一化方式(若使用3.1模式，则没有此步骤)，该步骤主要<strong>校正代谢物丰度数量级间的差异</strong>对富集结果的影响。可根据实际情况，选择是否需要归一化。(小Tips，实在纠结可以都试试，网页分析试错包容性强)  “Normalize”后，点击“Proceed“后即可。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405214725763.png" alt="image-20240405214725763" style="zoom:50%;"></li><li><p>设置MetPA的富集方式。 这里使用默认参数（蓝色的圆圈）</p></li></ol><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405215019047.png" alt="image-20240405215019047" style="zoom:50%;"><ol start="7"><li>获取分析结果。 点击左侧导航栏的“Download”，将结果下载到本地。 右侧未数据可视化区域， <strong>Pathway Impact是通路的位置信息，该值越大通路也就越重要，纵坐标为通路的显著性，颜色越红（越深）越显著富集</strong>。点击图中的圆点，右侧可出现通路的名称和富集到的代谢物信息。</li></ol><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405223654864.png" alt="image-20240405223654864" style="zoom:50%;"><p>5.3 MSEA富集分析（Metabolite Set Enrichment Analysis）</p><p>生物体内的代谢调控是层层递进的，极少会有一蹴而就的情况，之前提到的KEGG富集、MetPA富集，都是探讨目标代谢集主要腹肌道德代谢途径，这些分析方式往往存在一定的缺失，因为阈值过滤可能会损失一部分具备重要意义的微效代谢物的挖掘或发现。</p><p>例如下图中的pathway，可发现正是由于A的为上调，逐渐作用到下游代谢物，最终使E出现显著变化。 所以，该同类仍具备相当重要的生物学意义，如果根据差异倍数≥2，P＜0.05来筛选差异代谢集，最终只能获得一个代谢物E，然后再结合KEGG富集、MetPA富集，最后得到的结果显然该pathway是不显著的。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240405225656108.png" alt="image-20240405225656108" style="zoom:50%;"><p>MSEA分析可弥补上述研究不足，<strong>重点挖掘代谢物丰度变化较低</strong>但仍<strong>对生物体调控具备主要意义的代谢物</strong>及其所在的<strong>代谢途径</strong>。其意义比较类似于<strong>转录组数据挖掘中的GSEA</strong>分析。</p><p>可使用MetaboAnalyst5.0网页(<a href="https://www.metaboanalyst.ca/)%E5%9C%A8%E7%BA%BF%E5%AE%8C%E6%88%90%E5%AF%B9%E4%BA%BA%E3%80%81%E5%B0%8F%E9%BC%A0%E3%80%81%E5%A4%A7%E9%BC%A0%E7%AD%89%E7%89%A9%E7%A7%8D%E7%9A%84%E5%88%86%E6%9E%90%EF%BC%8C%E5%88%86%E6%9E%90%E6%97%B6%E4%BD%BF%E7%94%A8%E6%AF%94%E8%BE%83%E7%BB%84%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E4%BB%A3%E8%B0%A2%E9%9B%86%E5%BC%80%E5%B1%95%EF%BC%8C%E5%A6%82A-vs-B%E5%BE%97%E5%88%B0%E7%9A%84%E4%B8%8D%E7%BB%8F%E9%98%88%E5%80%BC%E7%AD%9B%E9%80%89%E7%9A%84%E6%89%80%E6%9C%89%E4%BB%A3%E8%B0%A2%E7%89%A9%E3%80%82">https://www.metaboanalyst.ca/)在线完成对人、小鼠、大鼠等物种的分析，分析时使用比较组中的所有代谢集开展，如A-vs-B得到的不经阈值筛选的所有代谢物。</a></p><p>5.3.1 MSEA分析的原理</p><p>MSEA再挖掘代谢途径时，有三种统计方式：Over Representation Analysis(ORA)、Single Sample Proling（SSP）、Quantitative Enrichment Analysis（QEA）模式。 ORA分析时，只需要输入比较组中的代谢物名称，无需包含丰度信息。 这种方式没有结合丰度数据，因此不利于丰度变化微弱的数据挖掘。</p><p>所以我跟推荐使用QEA模式开展分析。 QEA再分析通路时，借助广义线性模型计算每个代谢物浓度与样本的相关性，从而得到Q statistic，将pathway种每个代谢物Q statistic的平均值作为pathway的Q statistic，该值越高说明其与样本的相关性越强，对样本间的差异具有重要调控。 同时，软件还默认输出P值、Bonferroni校正后的P值和FDR值描述通路的显著性。</p><p>MSEA富集分析方法的实现：MetaboAnalysis5.0（<a href="https://www.metaboanalyst.ca/%EF%BC%89%EF%BC%8C%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4%E5%9C%A8%E7%BD%91%E4%B8%8A%E9%83%BD%E5%8F%AF%E6%9F%A5%E6%89%BE%E5%88%B0%E7%9B%B8%E5%85%B3%E6%95%99%E7%A8%8B%EF%BC%8C%E8%BF%99%E9%87%8C%E4%B8%8D%E5%86%8D%E8%B5%98%E8%BF%B0%E3%80%82">https://www.metaboanalyst.ca/），操作步骤在网上都可查找到相关教程，这里不再赘述。</a></p><hr><p>下期预告：蛋白代谢多组学研究思路</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;代谢组学的数据分析包括：对检测到的原始数据进行数据预处理、数据质控、代谢物定量分析、生信数据挖掘等。&lt;/p&gt;
&lt;h3 id=&quot;1-数据预处理&quot;&gt;&lt;a href=&quot;#1-数据预处理&quot; class=&quot;headerlink&quot; title=&quot;1.数据预处理</summary>
      
    
    
    
    
    <category term="多组学数据分析" scheme="http://nikolahuang.github.io/tags/%E5%A4%9A%E7%BB%84%E5%AD%A6%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>E.Z.N.A.® Endo-Free Plasmid DNA Mini Kit Protocols(中文版)</title>
    <link href="http://nikolahuang.github.io/2024/03/21/Protocols/"/>
    <id>http://nikolahuang.github.io/2024/03/21/Protocols/</id>
    <published>2024-03-21T03:06:24.000Z</published>
    <updated>2024-03-23T10:51:00.855Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Kit-I-Protocol"><a href="#Kit-I-Protocol" class="headerlink" title="Kit I Protocol"></a>Kit I Protocol</h3><h3 id="实验前准备"><a href="#实验前准备" class="headerlink" title="实验前准备"></a>实验前准备</h3><p>1.使用前 将RNase A全部加入SolutionI中并于4度保存。</p><p>2.按下表用无水乙醇稀释DNA Wash Buffer 并于室温保存。</p><p>D6942-00,D6943-00:加入8m无水乙醇</p><p>D6942-01,D6943-01:加入80ml无水乙醇</p><p>D6842-02,D6943-02:每瓶中加入80ml无水乙醇.</p><h3 id="离心操作方案"><a href="#离心操作方案" class="headerlink" title="离心操作方案"></a>离心操作方案</h3><ol><li><p>将带有质粒的E.coli 接种于5ml LB&#x2F;抗生素培养液中   37°C搖床培养12~16 h</p></li><li><p>取1.0~5.0ml的菌液 室温下10,000xg离心1min收集细菌。</p></li><li><p>倒弃培养基。加入250ulSolutionI&#x2F;RNaseA混和液 漩涡振荡使细胞完全悬浮。</p></li><li><p>往重悬混和液中加入250ul SolutionII 轻轻颠倒混匀4-6次。此操作避免剧烈混匀裂解液且裂解反应不要超过5 min。</p></li><li><p>加入350ulSolution III 温和颠倒数次至形成白色絮狀沉淀。</p></li><li><p>室温下 &gt;10,000xg离心10min。</p></li><li><p>转移上清液至套有2ml收集管的HiBind DNA结合柱中室温下 10,000xg离心1 min倒去收集管中的滤液。</p></li><li><p>把柱子重新装回收集管加入500ul HB Buffer 按上述条件离心弃去滤液</p></li><li><p>把柱子重新装回收集管 加入700ul DNA Wash Buffer 按上述条件离心 弃去滤液.<br>注意 浓缩的DNA Wash Buffer在使用之前必须按标签的提示用无水乙醇稀释。</p></li><li><p>(可选)弃去滤液 重复第9步骤一次。</p></li><li><p>弃去滤液 把柱子重新装回收集管 10,000xg离心空柱2min以甩干柱子基质。<br>注意 不要忽略此步 –这对去除柱子中残留的乙醇至关重要。</p></li><li><p>把柱子装在干净的1.5mI离心管上 加入30-50ul Elution Buffer(10mM Tris-HCI,PH8.5)或无菌水到柱子基质中 静置1-2min 10,000xg离心1min洗脱出DNA。</p></li></ol><p>快速流程图：<br><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240321114645886.png" alt="image-20240321114645886"></p><hr><h3 id="Kit-II-protocol"><a href="#Kit-II-protocol" class="headerlink" title="Kit II protocol"></a>Kit II protocol</h3><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/image-20240321115711235.png" alt="image-20240321115711235"></p><p>提取步骤： </p><ol><li>将带有质粒的E.coli 接种于50mL LB&#x2F;抗生素培养液中，37°C搖床培养12-16 h； </li><li>取10-15 mL的菌液，室温下，5,000xg离心10min收集细菌； </li><li>倒弃培养基，加入500µl Solution I&#x2F;RNase A混和液，漩涡振荡使细胞完全悬浮； Note：Solution I在使用前请按说明书正确添加RNase A混匀备用。 </li><li>将溶液转移到新的2mL离心管，加入500µl Solution II，轻轻颠倒混匀，将混合液 室温放置2~3min； Note：加入Solution II后裂解时间不应超过5min；密封保存。 </li><li>加入250µl 预冷的N3 Buffer，轻柔上下颠倒离心管数次至形成白色絮狀沉淀； </li><li>室温下，最大速度（≥13000xg）离心10min，转移上清液至新1.5mL离心管中； </li><li>加入上清液0.1倍体积的ETR Solution，上下颠倒10次混匀，冰浴10min； Note：加入ETR Solution后，溶液呈现浑浊，冰浴后变澄清。 </li><li>42℃孵育5min，溶液再次变浑浊； </li><li>25℃，12,000xg离心3min，将上层水相（含DNA）转移到新的1.5mL离心管中， 加入0.5倍体积的无水乙醇，上下颠倒混匀6-7次，室温静置1-2min； </li><li>转移混合液(一次最多转移700µl）至套有2mL收集管的HiBind ® DNA 结合柱中， 室温，10000xg离心1min，弃滤液。</li><li>重复步骤10，直至所有混合液转移过柱； </li><li>把柱子重新装回收集管，加入500µl HBC Buffer，最大速度离心1min，弃滤液； Note：HBC Buffer在使用前必须按照说明书加入异丙醇稀释。 </li><li>把柱子重新装回收集管，加入700µl DNA Wash Buffer，最大速度离心1min，弃 滤液； Note：DNA Wash Buffer使用前请按说明书正确添加无水乙醇稀释备用。 </li><li>重复步骤13； </li><li>把柱子重新装回收集管，≥13000xg离心空柱2min干燥柱子基质； </li><li>把柱子装在干净的1.5mL离心管上，加入80-100µl Elution Buffer到柱子基质中， 静置1min，最大速度离心1min洗脱DNA。 </li><li>弃除柱子，把DNA产物保存于-20℃。</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;Kit-I-Protocol&quot;&gt;&lt;a href=&quot;#Kit-I-Protocol&quot; class=&quot;headerlink&quot; title=&quot;Kit I Protocol&quot;&gt;&lt;/a&gt;Kit I Protocol&lt;/h3&gt;&lt;h3 id=&quot;实验前准备&quot;&gt;&lt;a href=&quot;#</summary>
      
    
    
    
    
    <category term="BioProtocol" scheme="http://nikolahuang.github.io/tags/BioProtocol/"/>
    
  </entry>
  
  <entry>
    <title>touch-down PCR原理和原则</title>
    <link href="http://nikolahuang.github.io/2024/03/20/PCR%E5%8E%9F%E7%90%86%E5%92%8C%E5%8E%9F%E5%88%99/"/>
    <id>http://nikolahuang.github.io/2024/03/20/PCR%E5%8E%9F%E7%90%86%E5%92%8C%E5%8E%9F%E5%88%99/</id>
    <published>2024-03-20T09:34:44.000Z</published>
    <updated>2024-03-20T15:20:49.466Z</updated>
    
    <content type="html"><![CDATA[<p>一、Tounch down PCR原理</p><p>　　Touchdown PCR，即降落PCR。是指每隔一个循环降低1°C或者是0.5°C反应退火温度，直至达到“Touchdown”退火温度，然后以此退火温度进行10个左右的循环。只有同同源性高的目的模板会被扩增。这些产物在随后的循环中继续扩增，并会将扩增的非特异性产物排挤出去。</p><p>　　平时我们先用高温扩5<del>10个循环，再用低温扩增 15</del>25个循环，这样也是广义上的touchdown。原理就在于，温度的升高提高了PCR扩增的特异性，但也提高了引物结合的难度，降低了扩增的效率，因此一开始先用高温扩增，保证扩增的严谨性，待目的基因的丰度上升后，降低扩增的温度，提高扩增的效率(此时非特异的位点由于丰度低，无法和特异位点竞争)</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/1541403901719577.png" alt="科研实验图.png"></p><p>　　二、Tounch down PCR退火温度设计的原则</p><p>　　1、降落 PCR 是在同一个 pcr 管内进行 PCR，只是每个循环的温度不同 (如每个循环降 1 度)。一般兼并引物用这种方法多些。</p><p>　　2、设计多循环反应的程序， 以使相连循环的退火温度越来越低。 由于开始时的退火温度选择为高于估计的 Tm 值，随着循环的进行，退火温度逐渐降到 Tm 值，并终低于这个水平， 用于确保第一个引物—模板杂交事件发生在互补的反应物之间， 即那些产生目的扩增产物的反应物之间。 尽管退火温度终会降到非特异杂交的 Tm 值，但此时目的扩增产物已开始几何扩增，在剩下的循环中处于超过任何滞后 (非特异 )PCR 产物的地位。</p><p>　　3、由于目标是在较早的循环中避免低 Tm 值配对，在 TD —PCR 中好应用热启动技术。设计时，退火温度的范围应跨越 15℃左右，从高于估计 Tm 值至少几度到低于它 10℃。</p><p>　　4、例：一对没有简并的引物—模板的计算 Tm 值为 62℃。</p><p>　　则：从 65℃— &gt;50 ℃ (每 2cycles 降退火温度 1℃ )，再在 50℃退火温度下做 15 个循环。实验中如持续出现假象带 (杂带 )，则是因为起始退火温度太低，或目的扩增产物和非目的产物的 Tm 值相差无几，或非目的扩增物以更高的扩增效率扩增，可把退火温度每降低 1℃所需的循环数增加到 3 或 4。</p><p>　　5、 touchdown PCR 是为了增加反应的特异性，降低非特异产物的产生。在整个反应过程是一个温度由高到低的过程， 在温度降低的过程中， 会出现一个温度是上下游引物适的退火温度， 大量引物与模板结合，由此产生特异性产物;温度继续降低时， 未结合的引物已很少或没有，非特异性产物就很少或没有。</p><p>　　设置温度时，高温以 Tm 较高的引物为准，低温以 Tm 较低的引物为准。</p><p>　　我常用的程序是： 65C—-50C, 1C&#x2F;2s(2s 降低 1 度)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;一、Tounch down PCR原理&lt;/p&gt;
&lt;p&gt;　　Touchdown PCR，即降落PCR。是指每隔一个循环降低1°C或者是0.5°C反应退火温度，直至达到“Touchdown”退火温度，然后以此退火温度进行10个左右的循环。只有同同源性高的目的模板会被扩增。这些产</summary>
      
    
    
    
    
    <category term="BioLearning" scheme="http://nikolahuang.github.io/tags/BioLearning/"/>
    
  </entry>
  
  <entry>
    <title>hexo+fluid搭建个人博客网站并部署到github</title>
    <link href="http://nikolahuang.github.io/2024/03/19/hexo-fluid%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99%E5%B9%B6%E9%83%A8%E7%BD%B2%E5%88%B0github/"/>
    <id>http://nikolahuang.github.io/2024/03/19/hexo-fluid%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99%E5%B9%B6%E9%83%A8%E7%BD%B2%E5%88%B0github/</id>
    <published>2024-03-19T14:59:09.000Z</published>
    <updated>2024-03-19T14:59:58.618Z</updated>
    
    <content type="html"><![CDATA[<h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><p>需要预先安装node.js、npm、并添加到环境变量(path)</p><h4 id="1-官网安装Nodejs-建议使用-Node-js-12-0-及以上版本"><a href="#1-官网安装Nodejs-建议使用-Node-js-12-0-及以上版本" class="headerlink" title="1.官网安装Nodejs(建议使用 Node.js 12.0 及以上版本)"></a>1.官网安装Nodejs(建议使用 Node.js 12.0 及以上版本)</h4><p>NodeJs是Hexo所必需的环境。</p><p>点击 <a href="https://nodejs.org/en/">NodeJs 官网</a>，下载左边那个即可，下载好一直 next，选择一个文件夹位置在一直 next 即可完成。安装Node.js会包含环境变量及npm的安装。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/902f589b96784f8098d216e8e32637d7.png" alt="2"></p><p>验证安装完成cmd中输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure><p>返回版本号代表安装完成。</p><p>2.安装git<br>Git是开源的分布式版本控制系统，用于敏捷高效地处理项目。</p><p>我们网站在本地搭建好了，需要使用Git同步到云服务器或者GitHub的代码库里。点击 git 官网，下载安装包。点击 next，选择文件夹位置，然后一直 next 到底就行了，选择默认配置就好，默认配置会将环境变量配置好的。安装成功右击鼠标如图所示：<br><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/3705169b5054b5c69bd374ad08fa97f5.png" alt="1"></p><p>3.下载安装Hexo博客框架<br>Hexo 是一个快速、简洁且高效的博客框架。Hexo是有官方说明文档，想看最详细的教程可以移步到HEXO官网。前面git和nodejs安装好后，就可以安装hexo了，可以先创建一个文件夹HEXO，然后在这个文件夹下直接右键git bash打开，输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>下载太慢可以换一下淘宝源，依旧用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo -v</span><br></pre></td></tr></table></figure><p>查看一下版本，至此就全部安装完了。</p><p>接下来初始化一下hexo，，在该文件夹下鼠标右键gitbash后输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init blog</span><br></pre></td></tr></table></figure><p>“blog”是你要生成博客的文件夹名称，可以根据自己的喜好来取名。生成的文件如图所示：<br><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/0dff30cffe9cf89a53a611016f460fb2.png" alt="image-20220515193739986"></p><p>输入命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>完成后，打开浏览器输入地址：localhost:4000就可以看到你生成的博客了。使用ctrl+c可以把服务关掉。</p><p>本地部署好之后，只能自己在本地查看博客，我们需要上传到云端的代码库（云服务器或者GitHub）来托管你的博客，这样其他人才能随时访问你的博客。</p><h2 id="二、安装使用fluid-主题"><a href="#二、安装使用fluid-主题" class="headerlink" title="二、安装使用fluid 主题"></a>二、安装使用fluid 主题</h2><h3 id="获取最新版本"><a href="#获取最新版本" class="headerlink" title="获取最新版本"></a>获取最新版本</h3><p>主题下载：<a href="https://github.com/fluid-dev/hexo-theme-fluid">https://github.com/fluid-dev/hexo-theme-fluid</a></p><h3 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h3><p>Hexo 5.0.0 版本以上，推荐通过 npm 直接安装，进入博客目录执行命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-theme-fluid</span><br></pre></td></tr></table></figure><p>然后在博客目录下创建 <code>_config.fluid.yml</code>，将主题的 <a href="https://links.jianshu.com/go?to=https://github.com/fluid-dev/hexo-theme-fluid/blob/master/_config.yml">_config.yml (opens new window)</a>内容复制过去（找到主题文件夹，一般在\blog\nikolahuang.github.io\node_modules\hexo-theme-fluid里面）。</p><h3 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h3><p>下载 <a href="https://links.jianshu.com/go?to=https://github.com/fluid-dev/hexo-theme-fluid/releases">最新 release 版本 (opens new window)</a>解压到 themes 目录，并将解压出的文件夹重命名为 <code>fluid</code>。</p><h3 id="指定主题"><a href="#指定主题" class="headerlink" title="指定主题"></a>指定主题</h3><p>如下修改 Hexo 博客目录中的 <code>_config.yml</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">theme: fluid  <span class="comment"># 指定主题</span></span><br><span class="line"></span><br><span class="line">language: zh-CN  <span class="comment"># 指定语言，会影响主题显示的语言，按需修改</span></span><br></pre></td></tr></table></figure><p>在这，我使用的是第一种方式，主要步骤是</p><h3 id="1、运行安装命令-npm-install-–save-hexo-theme-fluid"><a href="#1、运行安装命令-npm-install-–save-hexo-theme-fluid" class="headerlink" title="1、运行安装命令   npm install –save hexo-theme-fluid"></a>1、运行安装命令   npm install –save hexo-theme-fluid</h3><h3 id="2、在根目录下创建文件一个名为-config-fluid-yml的文件"><a href="#2、在根目录下创建文件一个名为-config-fluid-yml的文件" class="headerlink" title="2、在根目录下创建文件一个名为_config.fluid.yml的文件"></a>2、在根目录下创建文件一个名为_config.fluid.yml的文件</h3><h3 id="3、将node-modules里面hexo-theme-fluid文件夹里面的-config-yml的内容复制到新建的-config-fluid-yml文件中"><a href="#3、将node-modules里面hexo-theme-fluid文件夹里面的-config-yml的内容复制到新建的-config-fluid-yml文件中" class="headerlink" title="3、将node_modules里面hexo-theme-fluid文件夹里面的_config.yml的内容复制到新建的_config.fluid.yml文件中"></a>3、将node_modules里面hexo-theme-fluid文件夹里面的_config.yml的内容复制到新建的_config.fluid.yml文件中</h3><h3 id="4、如下图修改-config-fluid-yml文件中的内容-，注意空格位置什么的不要改"><a href="#4、如下图修改-config-fluid-yml文件中的内容-，注意空格位置什么的不要改" class="headerlink" title="4、如下图修改_config.fluid.yml文件中的内容 ，注意空格位置什么的不要改"></a>4、如下图修改_config.fluid.yml文件中的内容 ，注意空格位置什么的不要改</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">theme: fluid  <span class="comment"># 指定主题</span></span><br><span class="line"></span><br><span class="line">language: zh-CN  <span class="comment"># 指定语言，会影响主题显示的语言，按需修改</span></span><br></pre></td></tr></table></figure><h3 id="5、运行清除缓存命令-hexo-clean-再运行hexo-g-再运行hexo-s-然后预览页面。类似下图的页面"><a href="#5、运行清除缓存命令-hexo-clean-再运行hexo-g-再运行hexo-s-然后预览页面。类似下图的页面" class="headerlink" title="5、运行清除缓存命令  hexo clean  再运行hexo g  再运行hexo s ,然后预览页面。类似下图的页面"></a>5、运行清除缓存命令  hexo clean  再运行hexo g  再运行hexo s ,然后预览页面。类似下图的页面</h3><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-17108599776039.webp" alt="img"></p><p>image.png</p><h1 id="三、完善页面的功能插件"><a href="#三、完善页面的功能插件" class="headerlink" title="三、完善页面的功能插件"></a>三、完善页面的功能插件</h1><h3 id="1、中间的背景图的更换，如下图效果"><a href="#1、中间的背景图的更换，如下图效果" class="headerlink" title="1、中间的背景图的更换，如下图效果"></a>1、中间的背景图的更换，如下图效果</h3><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-17108599724496.webp" alt="img"></p><p>image.png</p><p>在_config.fluid.yml中找到上面的位置填写上图标记的代码(注意图片的路径位置)</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">banner_img</span>: <span class="regexp">/img/</span>bg.<span class="property">jpg</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171085998395512.webp" alt="img"></p><p>image.png</p><p>步骤：</p><h3 id="2、添加随机打印机效果，如图我所标记的位置的效果"><a href="#2、添加随机打印机效果，如图我所标记的位置的效果" class="headerlink" title="2、添加随机打印机效果，如图我所标记的位置的效果"></a>2、添加随机打印机效果，如图我所标记的位置的效果</h3><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171085998869315.webp" alt="img"></p><p>image.png</p><p>步骤1、在_config.fluid.yml文件中找到下图位置修改，开启打印机插件：</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171085999733320.webp" alt="img"></p><p>image.png</p><p>步骤2、在上述文件找到下图位置修改，调用接口</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171086000214523.webp" alt="img"></p><h3 id="3、添加统计数，我使用的是valiner插件。如下图效果"><a href="#3、添加统计数，我使用的是valiner插件。如下图效果" class="headerlink" title="3、添加统计数，我使用的是valiner插件。如下图效果"></a>3、添加统计数，我使用的是valiner插件。如下图效果</h3><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171086000704026.webp" alt="img"></p><p>步骤：在在上述文件找到下图位置修改，</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171086001111729.webp" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171086001497732.webp" alt="img"></p><h3 id="4、添加右上角的社交图标和链接，如下图效果"><a href="#4、添加右上角的社交图标和链接，如下图效果" class="headerlink" title="4、添加右上角的社交图标和链接，如下图效果"></a>4、添加右上角的社交图标和链接，如下图效果</h3><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171086002211535.webp" alt="img"></p><p> 步骤：点击<a href="https://links.jianshu.com/go?to=https://github.com/blog/273-github-ribbons">这里</a> 或者 <a href="https://links.jianshu.com/go?to=http://tholman.com/github-corners/">这里</a>挑选自己喜欢的样式，选择其中一个并复制其代码。 如下图</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171086002974038.webp" alt="img"></p><p> 在找到下图位置粘贴代码，如图绿色标记处</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171086003410441.webp" alt="img"></p><h1 id="四、部署到github的托管网站上，实现在线博客"><a href="#四、部署到github的托管网站上，实现在线博客" class="headerlink" title="四、部署到github的托管网站上，实现在线博客"></a>四、部署到github的托管网站上，实现在线博客</h1><p>步骤1：在github 创建好仓库，至于如何创建可以点击<a href="https://www.jianshu.com/p/11d6d8e7eb9a">这里</a>查看。<br> 步骤2：在_config.yml文件中找到下图位置修改内容</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171086003899944.webp" alt="img"></p><p> 步骤3：使用命令npm install hexo-deployer-git –save  安装部署插件<br> 步骤4：使用hexo clean 清除缓存 、使用hexo g 渲染页面 、使用hexo d 部署页面<br> 步骤5：此时，你远程仓库上，已经有文件了，也就是如下图public文件夹中的文件</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171086004334947.webp" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/webp-171086004676550.webp" alt="img"></p><p> 步骤6: 在浏览器地址栏输入https:&#x2F;&#x2F;仓库名<a href="https://links.jianshu.com/go?to=http://.github.io">.github.io</a>     就能看到你的线上博客网站了。</p><hr><p>上面的方法尝试之后不行的，可以继续下面这种办法：将博客托管到GitHub</p><h4 id="1-GitHub生成代码库"><a href="#1-GitHub生成代码库" class="headerlink" title="1.GitHub生成代码库"></a>1.GitHub生成代码库</h4><p>首先，你先要有一个GitHub账户。点击+号，选择New repository，新建仓库：</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/70895669db2179fa65774c69fff62735.png" alt="image-20220515194104048"></p><p>创建一个和你用户名相同的仓库，后面加.github.io，只有这样，将来要部署到GitHub page的时候，才会被识别，也就是xxxx.github.io，其中xxx就是你注册GitHub的用户名，点击create repository。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/68e29340708fafdd1da425162b615b27.png" alt="image-20220515194255616"></p><p>本地SSH生成密钥，将公钥复制到云端<br>回到本地主机git bash中，创建用户名和密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;GitHub用户名&quot;</span><br><span class="line">git config --global user.email &quot;GitHub注册邮箱&quot;</span><br><span class="line">git config --global user.password &quot;GitHub登录密码&quot;</span><br></pre></td></tr></table></figure><p>创建SSH密钥，一路回车</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;GitHub注册邮箱&quot;</span><br></pre></td></tr></table></figure><p>ssh，简单来讲，就是一个秘钥，其中，id_rsa是你这台电脑的私人秘钥，相当于钥匙，id_rsa.pub是公共秘钥，相当于锁。要把id_rsa.pub公共秘钥给GitHub，这样才能用自己的私人密钥去开这把锁。当能够相互匹配时，才能够顺利的通过git上传你的文件到GitHub上。</p><p>将id_rsa.pub中的内容复制，而后在GitHub的setting中：<br><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/b032fffb71937ba1b5888640970d96b8.png" alt="image-20220515194631747"></p><p>点击左侧SSH and GPG keys的设置选项，点击New SSH key，把你的id_rsa.pub里面的信息复制进去。title随便填，本地的公钥复制到key中。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/eafc90db32b9693697d254f08024ca58.png" alt="image-20220515195256471"></p><p>在本地gitbash中检测GitHub公钥设置是否成功</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh git@github.com</span><br></pre></td></tr></table></figure><p>第一次登录需要输入GitHub的登录用户名和密码。</p><p>3.修改配置文件<br>下一步将我们的Hexo与GitHub关联起来，打开站博客根目录blog的配置文件_config.yml<br>翻到最后修改为：（注意后面三行缩进两格）</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span> </span><br><span class="line">  <span class="attr">repository:</span> <span class="string">https://github.com/lixinyiceline/lixinyiceline.github.io.git（改）</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><p>repository里的内容是GitHub代码仓库浏览器网址栏的网址，注意后面加上.git，保存站点配置文件。</p><h4 id="4-本地上传到GitHub"><a href="#4-本地上传到GitHub" class="headerlink" title="4.本地上传到GitHub"></a>4.本地上传到GitHub</h4><p>本地gitbash安装Git部署插件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>然后输入下面三个命令就可搭建成功博客了</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g &amp;&amp; hexo d</span><br><span class="line">hexo new 你要新建的博客名称 #注：新建的博客markerdown文件存放在_post文件夹中，可以直接查看</span><br></pre></td></tr></table></figure><p>云服务器的部署参考博客：<a href="https://blog.csdn.net/m0_50609661/article/details/125216866">https://blog.csdn.net/m0_50609661/article/details/125216866</a></p><p>改自：<a href="https://www.jianshu.com/p/6d2614b28daf">随心了</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;环境准备&quot;&gt;&lt;a href=&quot;#环境准备&quot; class=&quot;headerlink&quot; title=&quot;环境准备&quot;&gt;&lt;/a&gt;环境准备&lt;/h1&gt;&lt;p&gt;需要预先安装node.js、npm、并添加到环境变量(path)&lt;/p&gt;
&lt;h4 id=&quot;1-官网安装Nodejs-建议使用</summary>
      
    
    
    
    
    <category term="计算机随笔" scheme="http://nikolahuang.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>同源重组构建质粒原理详解</title>
    <link href="http://nikolahuang.github.io/2024/03/19/%E5%90%8C%E6%BA%90%E9%87%8D%E7%BB%84%E6%9E%84%E5%BB%BA%E8%B4%A8%E7%B2%92%E5%8E%9F%E7%90%86%E8%AF%A6%E8%A7%A3/"/>
    <id>http://nikolahuang.github.io/2024/03/19/%E5%90%8C%E6%BA%90%E9%87%8D%E7%BB%84%E6%9E%84%E5%BB%BA%E8%B4%A8%E7%B2%92%E5%8E%9F%E7%90%86%E8%AF%A6%E8%A7%A3/</id>
    <published>2024-03-19T02:54:11.000Z</published>
    <updated>2024-03-19T02:54:54.966Z</updated>
    
    <content type="html"><![CDATA[<p>分子生物学研究中质粒构建是最常用的实验技术。原理依赖于限制性核酸内切酶，DNA 连接酶和其他修饰酶的作用，分别对目的基因和载体 DNA 进行适当切割和修饰后，将二者连接在一起，再导入宿主细胞，实现目的基因在宿主细胞内的正确表达。</p><p>同源重组的基因克隆方法， 相比双酶切载体构建方法，该方法的构建过程有些不同，双酶切构建过程比较繁琐，同源重组构建过程相对简单，可以省去很多的时间和精力，但假阳性率略高。</p><p><strong>同源重组法构建载体</strong></p><p>首先，靶基因片段扩增引物有别于常规引物设计；</p><p>其次，载体切割过程中只需要进行单酶切；</p><p>第三，载体和目的基因片段的连接是基于同源重组而不是粘性末端互补。</p><p><strong>采用同源重组法构建载体与常规双酶切构建载体方法不同。</strong></p><p>首先，设计引物时上游引物5’端前面加的是酶切位点（如Hind III）及该酶切位点在pMIR reporter载体中对应前面的15个碱基载体片段，下游引物5’端前面加的是Hind III酶切位点及该酶切位点在pMIR reporter载体中对应后面的15个碱基载体片段，如此设计引物是为了保证目的片段插入载体时方向正确。</p><p>其次，载体只需要单酶切，用Hind III酶切pMIR reporter，使得pMIR reporter成为两端都带着Hind III位点的线性载体。相比双酶切切割载体，单酶切可以保证酶切后的载体都是单一的线性片段，使得后续的重组连接更准确。</p><p>第三，省去了TA克隆环节。因为PCR产物可以直接用于重组连接，不需要酶切产生粘性末端，而且重组酶的重组能力强于T4 DNA连接酶的连接能力，一般只需要一步即可重组连接成功，因此可以在重组反应之后进行测序鉴定。</p><p><strong>详解：</strong></p><p>基于同源基因重组原理，适用于向几乎任何载体在任何位点进行定向克隆，无需考虑插入片段自身携带的酶切位点可高效克隆 50 bp～10 kb 片段，同时构建时间也大大缩短。</p><ol><li><p>载体的制备一般推荐双酶切线性化，线性化完全，假阳性克隆低。酶切体系同上。</p></li><li><p>对于使用重组方式连接来说，PCR 要设计引物, 设计引物时要根据质粒载体和基因序列选择合适的同源序列，通过 PCR 扩增方式进行连接，PCR 的产物要纯化。</p></li></ol><p><strong>引物设计原则简单总结一下：</strong></p><p><strong>（1）前向引物：5’ 端–上游克隆载体末端同源序列+基因正向扩增引物–3’ 端</strong></p><p><strong>（2）反向引物：3’ 端–基因反向扩增引物+下游克隆载体末端同源序列–5’ 端</strong></p><p>如果设计的基因特异插入片段扩增产物长度较长，可以选择 PCR 方式进行目的引物的扩增。</p><p><strong>[可选 PCR 扩增体系]</strong></p><p>ddH2O            14 ul</p><p>10 x Taq buffer      2 ul</p><p>10 um DNTP       1 ul</p><p>10 um primer F     0.5 ul</p><p>10 um primer R     0.5 ul</p><p>Vector            1 ul</p><p>Taq 酶            1 ul</p><p><strong>[可选 PCR 扩增条件]</strong></p><p>(1)95℃：5min</p><p>(2) 35cycle</p><p>95℃：30s</p><p>55℃：30s（退火温度可以根据目的引物TM值决定，一般退火温度根 据引物TM值降低5度）</p><p>72℃：40s</p><p>(3)72℃：10min</p><p>(4)16℃：hold</p><p>PCR 扩增后，通过胶回收方式获得纯化的 PCR 产物。纯化后的 PCR 产物不需要进行酶切，直接用于重组反应。</p><p><strong>3. 目的引物与线性载体进行重组反应。</strong></p><p><strong>[可选重组体系]</strong></p><p>5 × CE II Buffer      4 μl</p><p>线性化克隆载体     50～200 ng</p><p>插入片段扩增产物   20～200 ng</p><p>ExnaseII         2 μl</p><p>ddH2O            x ul</p><p>在冰水浴中配制，配制完成后，用移液器上下轻轻吹打几次混匀各组分，置于 37 ℃ 反应 30 min。待反应完成后，立即将反应管置于冰水浴中冷却 5 min。重组效率在反应 30 min 左右达到最高，反应时间不足或者太长都将会降低克隆效率，这样大大减少了连接时间。</p><p><strong>4. 转化</strong></p><p>将连接产物转化到受体菌中（一般为 DH5a），涂板，培养过夜。</p><p><strong>5. 挑取单克隆，并鉴定</strong></p><p>挑去平板上的单克隆培养，可以通过 PCR 或者酶切初步鉴定阳性克隆，对初步鉴定出来的阳性克隆进行测序。</p><p><strong>最后，几个主要注意事项：</strong></p><ol><li><p>载体克隆位点选择尽量选择无重复序列，且 GC 含量比较均匀的区域进行克隆。当克隆位点上下游 20 bp 区域内 GC 含量均在 40%～60% 范围之内时， 克隆效率将达到最大.</p></li><li><p>最适克隆载体与插入片段摩尔比为 1:2，即最适插入片段使用量为 0.06 pmol。这些摩尔数对应的 DNA 质量可由以下公式粗略计算获得：</p></li></ol><p>最适克隆载体使用量 &#x3D; [0.02 × 克隆载体碱基对数] ng（0.03 pmol）</p><p>最适插入片段使用量 &#x3D; [0.04 × 插入片段碱基对数] ng（0.06 pmol）</p><ol start="3"><li>双酶切 1 和 2，在设置酶切体系时要考虑酶切温度以及 Activity in NEBbuffer 的问题。</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;分子生物学研究中质粒构建是最常用的实验技术。原理依赖于限制性核酸内切酶，DNA 连接酶和其他修饰酶的作用，分别对目的基因和载体 DNA 进行适当切割和修饰后，将二者连接在一起，再导入宿主细胞，实现目的基因在宿主细胞内的正确表达。&lt;/p&gt;
&lt;p&gt;同源重组的基因克隆方法， 相比</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>表达载体的构建方法及步骤</title>
    <link href="http://nikolahuang.github.io/2024/03/18/%E8%A1%A8%E8%BE%BE%E8%BD%BD%E4%BD%93%E7%9A%84%E6%9E%84%E5%BB%BA%E6%96%B9%E6%B3%95%E5%8F%8A%E6%AD%A5%E9%AA%A4/"/>
    <id>http://nikolahuang.github.io/2024/03/18/%E8%A1%A8%E8%BE%BE%E8%BD%BD%E4%BD%93%E7%9A%84%E6%9E%84%E5%BB%BA%E6%96%B9%E6%B3%95%E5%8F%8A%E6%AD%A5%E9%AA%A4/</id>
    <published>2024-03-18T15:08:00.000Z</published>
    <updated>2024-03-18T15:38:28.948Z</updated>
    
    <content type="html"><![CDATA[<p><strong>一、载体的选择及如何阅读质粒图谱</strong><br>目前，载体主要有病毒和非病毒两大类,其中质粒 DNA 是一种新的非病毒转基因载体。<br>一个合格质粒的组成要素：<br>（1）复制起始位点 Ori 即控制复制起始的位点。原核生物 DNA 分子中只有一个复制起始点。而<br>真核生物 DNA 分子有多个复制起始位点。<br>（2）抗生素抗性基因可以便于加以检测，如 Amp+ ,Kan+<br>（3）多克隆位点 MCS 克隆携带外源基因片段<br>（4） P&#x2F;E 启动子&#x2F;增强子<br>（5）Terms 终止信号<br>（6）加 poly（A）信号可以起到稳定 mRNA 作用<br>选择载体主要依据构建的目的，同时要考虑载体中应有合适的限制酶切位点。如果构建的目<br>的是要表达一个特定的基因，则要选择合适的表达载体。<br>载体选择主要考虑下述3点：<br>【1】.构建 DNA 重组体的目的，克隆扩增&#x2F;基因表达，选择合适的克隆载体&#x2F;表达载体。<br>【2】.载体的类型：<br>（1）克隆载体的克隆能力－据克隆片段大小（大选大，小选小）。如&lt;10kb 选质粒。<br>（2）表达载体据受体细胞类型－原核&#x2F;真核&#x2F;穿梭，E.coli&#x2F;哺乳类细胞表达载体。<br>（3）对原核表达载体应该注意：选择合适的启动子及相应的受体菌，用于表达真核蛋白质时注意克服4个困难和阅读框错位；表达天然蛋白质或融合蛋白作为相应载体的参考。<br>【3】载体 MCS 中的酶切位点数与组成方向因载体不同而异，适应目的基因与载体易于链接，不能产生阅读框架错位。<br>综上所述，选用质粒（最常用）做载体的5点要求：<br>（1）选分子量小的质粒，即小载体（1－1.5kb）→不易损坏，在细菌里面拷贝数也多（也有大载<br>体）；<br>（2）一般使用松弛型质粒在细菌里扩增不受约束，一般 10个以上的拷贝，而严谨型质粒&lt;10个。<br>（3）必需具备一个以上的酶切位点，有选择的余地；<br>（4）必需有易检测的标记，多是抗生素的抗性基因，不特指多位 Ampr（试一试）。<br>（5）满足自己的实验需求，是否需要包装病毒，是否需要加入荧光标记，是否需要加入标签蛋白，是否需要真核抗性（如Puro、G418）等等。<br>无论选用哪种载体，首先都要获得载体分子，然后采用适当的限制酶将载体 DNA 进行切割，获得线性载体分子，以便于与目的基因片段进行连接。<br>如何阅读质粒图谱<br>第一步：首先看 Ori 的位置，了解质粒的类型（原核&#x2F;真核&#x2F;穿梭质粒）<br>第二步：再看筛选标记，如抗性，决定使用什么筛选标记。<br>（1）Ampr 水解β－内酰胺环，解除氨苄的毒性。<br>（2）tetr 可以阻止四环素进入细胞。<br>（3）camr 生成氯霉素羟乙酰基衍生物，使之失去毒性。<br>（4）neor（kanr）氨基糖苷磷酸转移酶使 G418（长那霉素衍生物）失活<br>（5）hygr 使潮霉素β失活。<br>第三步：看多克隆位点（MCS）。它具有多个限制酶的单一切点。便于外源基因的插入。如果在这些酶切位点以外有外源基因的插入，会导致某种标志基因的失活，而便于筛选。决定能不能放目的基因以及如何放置目的基因。<br>第四步：再看外源 DNA 插入片段大小。质粒一般只能容纳小于10Kb 的外源 DNA 片段。一般来说，外源 DNA 片段越长，越难插入，越不稳定，转化效率越低。<br>第五步：是否含有表达系统元件，即启动子－核糖体结合位点－克隆位点－转录终止信号。这是用来区别克隆载体与表达载体。克隆载体中加入一些与表达调控有关的元件即成为表达载体。选用那种载体，还是要以实验目的为准绳。<br>第六步：启动子－核糖体结合位点－克隆位点－转录终止信号<br>（1）启动子－促进 DNA 转录的 DNA 序列，这个 DNA 区域常在基因或操纵子编码序列的上游，是 DNA 分子上可以与 RNApol 特异性结合并使之开始转录的部位，但启动子本身不被转录。<br>（2）增强子&#x2F;沉默子－为真核基因组（包括真核病毒基因组）中的一种具有增强邻近基因转录过程的调控顺序。其作用与增强子所在的位置或方向无关。即在所调控基因上游或下游均可发挥作用。&#x2F;沉默子－负增强子，负调控序列。<br>（3）核糖体结合位点&#x2F;起始密码&#x2F;SD 序列（Rbs&#x2F;AGU&#x2F;SDs）：mRNA 有核糖体的两个结合位点，对于原核而言是 AUG（起始密码）和 SD 序列。<br>（4）转录终止序列（终止子）&#x2F;翻译终止密码子：结构基因的最后一个外显子中有一个 AATAAA的保守序列，此位点 down－stream 有一段 GT 或 T 富丰区，这2部分共同构成 poly（A）加尾信号。结构基因的最后一个外显子中有一个 AATAAA 的保守序列，此位点 down－stream 有一段GT 或 T 富丰区，这2部分共同构成 poly（A）加尾信号。<br>质粒图谱上有的箭头顺时针有的箭头逆时针，那其实是代表两条 DNA 链，即质粒是环状双链DNA，它的启动子等在其中一条链上，而它的抗性基因在另一条链上 .根据表达宿主不同，构建时所选择的载体也会不同。</p><p><strong>二、目的基因的获得</strong><br>一般来说，目的基因的获得有三种途径：<br>调取基因：根据目的基因的序列，设计引物从含有目的基因的cDNA中通过PCR的方法调取目的基因，链接到克隆载体挑取单克隆进行测序，以获得想要的基因片段，这种方法相对成本较低，但是调取到的基因往往含有突变，还有不同基因的表达丰度不同，转录本比较复杂，或是基因片段很长，这些情况都很难调取到目的基因。<br>全基因合成：根据目的基因的DNA序列，直接设计合成目的基因。此方法准确性高，相对成本会高一些，个人操作比较困难，需要专业的合成公司完成。优点是可以合成难调取及人工改造的任何基因序列，同时可以进行密码子优化，提高目的基因在宿主内的表达量。</p><p><strong>三、克隆构建</strong><br>目前，克隆构建的方法多种多样，除了应用广泛的酶切链接以外，现在还有很多不依赖酶切位点的克隆构建方式。下面具体说一下双酶切方法构建载体的步骤。<br>实验材料</p><p>实验试剂</p><table><thead><tr><th>试剂名称</th><th>生产厂家</th></tr></thead><tbody><tr><td>载体pCDNA3.1</td><td>Transheep</td></tr><tr><td>大肠杆菌菌株DH5α</td><td>Tiangen</td></tr><tr><td>限制性内切酶</td><td>Fermentas</td></tr><tr><td>T4连接酶</td><td>Fermentas</td></tr><tr><td>质粒DNA小,大量抽提试剂盒</td><td>Axygen</td></tr><tr><td>凝胶回收试剂盒</td><td>Axygen</td></tr><tr><td>琼脂糖</td><td>Biowest</td></tr><tr><td>DNA ladder</td><td>Fermentas</td></tr></tbody></table><p>（2）X基因慢病毒载体的构建<br>X基因基因由Transheep全基因合成，构建于载体PUC57中。<br>PUC57-X基因 EcoRI&#x2F;BamHI酶切结果：</p><p><img src="https://assets.dxycdn.com/third-party/xheditor/xheditor_skin/blank.gif" alt="img"></p><p><img src="https://assets.dxycdn.com/third-party/xheditor/xheditor_skin/blank.gif" alt="img"></p><p>酶切完成后进行胶回收<br>\2. 载体用pCDNA3.1双酶切，酶切体系如下。<br>20ul酶切体系 37度3小时<br>4ul pCDNA3.1载体（500 ng&#x2F;ul）<br>1ul BamHI<br>1ul EcoRI<br>2ul 10×buffer<br>12 ul H2O<br>酶切完成后胶回收（见附录）</p><p><img src="https://assets.dxycdn.com/third-party/xheditor/xheditor_skin/blank.gif" alt="img"><img src="https://assets.dxycdn.com/third-party/xheditor/xheditor_skin/blank.gif" alt="img"></p><p>处理好的目的片段与载体连接反应体系：<br>6ul PCR 酶切回收片段（约50ng&#x2F;ul）<br>1ul 酶切好的载体（约50ng&#x2F;ul）<br>2ul ligase buffer<br>1ul T4ligase<br>10ul H2O<br>以上连接液在16℃过夜。<br>转化 (感受态细胞: DH5a),具体步骤见附录转化部分。<br>抗性: Amp; 37℃，培养过夜<br>转化后X基因分别平板挑菌, 37℃ 250转&#x2F;分钟摇菌14小时，PCR鉴定后，将阳性菌液送上海权阳生物技术有限公司测序。<br>X基因慢病毒载体单克隆菌落PCR鉴定（使用载体通用引物,PCR条带大小应比实际大200bp左右）：</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;一、载体的选择及如何阅读质粒图谱&lt;/strong&gt;&lt;br&gt;目前，载体主要有病毒和非病毒两大类,其中质粒 DNA 是一种新的非病毒转基因载体。&lt;br&gt;一个合格质粒的组成要素：&lt;br&gt;（1）复制起始位点 Ori 即控制复制起始的位点。原核生物 DNA 分子中只有</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>蛋白质组学数据分析和展示</title>
    <link href="http://nikolahuang.github.io/2024/03/17/%E8%9B%8B%E7%99%BD%E8%B4%A8%E7%BB%84%E5%AD%A6%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%92%8C%E5%B1%95%E7%A4%BA/"/>
    <id>http://nikolahuang.github.io/2024/03/17/%E8%9B%8B%E7%99%BD%E8%B4%A8%E7%BB%84%E5%AD%A6%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%92%8C%E5%B1%95%E7%A4%BA/</id>
    <published>2024-03-17T09:03:15.000Z</published>
    <updated>2024-04-05T16:51:50.682Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><p>使用Maxquant对原始谱图搜库完成后，可以得到大量蛋白质的鉴定和定量信息。下一步就需要通过统计分析和生物信息学分析，从搜库得到的大量信息中筛选和寻找关键蛋白和信号通路，以及进行相关功能的验证。本讲我们会为大家介绍如何进行蛋白质组学的定量数据分析以及结果展示，主要包括：蛋白质鉴定和定量数据统计、差异表达蛋白筛选、功能注释和富集分析以及蛋白互作网络分析。</p><h3 id="定量数据统计和展示"><a href="#定量数据统计和展示" class="headerlink" title="定量数据统计和展示"></a><strong>定量数据统计和展示</strong></h3><p>在蛋白质组学数据分析过程中，首先会对所有的鉴定和定量数据进行统计和展示，主要关注蛋白鉴定数目、肽段鉴定数目、肽段分布情况以及样品相关性和重复性等内容，展示蛋白质组学数据的定量深度、可信度和重复性等。</p><p>如下图所示，蛋白质组定量深度主要体现在各个样品中鉴定及定量到的蛋白和肽段数量，数量越多，表明定量深度越深，意味着能够获得更全面的蛋白质组学信息。同时，不同样品间定量深度的差异，也可以初步反映样品和方法的重复性和稳定性。</p><p><img src="https://pic3.zhimg.com/80/v2-6d39941370abb6c9338a6034c662b122_1440w.webp" alt="img"></p><p>（肽段数量统计图（上）和蛋白数量统计图（下）[1]）</p><p>蛋白质组学数据的可信度，可通过各个蛋白鉴定到的肽段数量以及各条肽段鉴定到的谱图数量分别展示。一般认为鉴定到2条及以上肽段的蛋白或2张及以上谱图的肽段为可信度更高的鉴定结果。</p><p><img src="https://pic3.zhimg.com/80/v2-6f67c0ec5eb6fbaf6dbfc9cf5407c916_1440w.webp" alt="img"></p><p>（谱图数量分布图（上）&#x2F;肽段数量分布图（下） [1]）</p><p>蛋白质组定量数据的相关性和重复性可通过相关系数来体现，组内样品间的蛋白质组定量相关系数往往较高，而组间样品的相关系数则会稍低（如左图）。PCA分析则是通过降维算法，将数百乃至上万个蛋白的定量数据降维为2个或3个反映定量特征的主成分，从而直观展示不同样品之间的定量相关性，在空间位置上接近的点表明其定量特征接近，也就是数据相关性更高。同一组的样品在PCA分析结果中往往会更为聚集（如右图）。</p><p><img src="https://pic1.zhimg.com/80/v2-d51216dbd0bc17a7c9b47261d4ac4490_1440w.webp" alt="img"></p><p>（相关系数热图（左）和PCA分析图（右）[2]）</p><p>定量热图也是蛋白质组学中常用的展示定量数据的结果图形。在定量热图中，通常每一列代表一个样品，每一行代表一个蛋白，以色块颜色表示各个样品中蛋白的定量水平。通过颜色的变化和分布可以直观的展示不同样品中蛋白定量水平的相关性和差异性。</p><p><img src="https://pic2.zhimg.com/80/v2-fa5113e8db515018b2c6cb37dbd261b9_1440w.webp" alt="img"></p><p>（蛋白定量热图[3]）</p><h3 id="差异表达分析"><a href="#差异表达分析" class="headerlink" title="差异表达分析"></a><strong>差异表达分析</strong></h3><p>找出不同处理组间差异表达蛋白是蛋白质组学研究的重要目标之一。统计学上一般选取P值（P-value）和差异倍数（Fold change）两个参数实现差异蛋白的筛选，其中P-value由比较两组样品蛋白定量数据的T检验计算得出，要求各组样品数量不少于3个；Fold change是两样品中同一个蛋白的表达差异倍数，主要根据蛋白定量值计算。如下图所示，根据显著性P&lt;0.05和 Fold Change&gt;1.5或&lt;1&#x2F;1.5设定阈值可挑选出符合标准的差异蛋白质。</p><p><img src="https://pic4.zhimg.com/80/v2-391ee040bee2210b184a2c91e62b7893_1440w.webp" alt="img"></p><p>（差异蛋白火山图[4]）</p><p>筛选出差异表达蛋白后，也可再次通过定量热图与PCA分析图，更为直观地展示这些差异蛋白的定量特征，以及各样本组内及组间的相似和变异程度。</p><h3 id="功能注释和富集分析"><a href="#功能注释和富集分析" class="headerlink" title="功能注释和富集分析"></a><strong>功能注释和富集分析</strong></h3><p>以上分析完成后，有些实验还需要对蛋白的功能、分布、参与的通路等方面进行注释和富集，可为后续生物学和功能机制的研究提供参考和线索。</p><p>蛋白功能注释是将生物学信息关联到蛋白质序列的过程，使用的数据库主要有GO(gene ontology）、KEGG(Kyoto encyclopedia of genes and genomes)、COG(Clusters of Orthologous Groups of proteins)、HallmarkGeneset、Reactome等。以GO分析为例，可理解为将蛋白对应的基因分门别类地放入一个个功能条目的盒子中去，从功能（Molecular Function）、参与的生物途径（Biological Process）和细胞中的定位（Cellular Component）三个维度来较为全面地描述一个蛋白。如下图GO注释，饼图的每一个分区表示一个GO条目，分区大小表示本条目中蛋白数量在差异蛋白中的占比。</p><p><img src="https://pic1.zhimg.com/80/v2-8ca44ab2fd975cfc805711b88cb7c800_1440w.webp" alt="img"></p><p>（GO注释饼状图[5] ）</p><p>富集分析则是在功能注释的基础上的进一步分析，其主要目的是以背景蛋白为参照，分析差异蛋白较为集中分布的注释条目，从而筛选出与差异蛋白更相关、更可能具有生物学意义的功能注释条目。目前最常用的富集分析算法是基于超几何分布的Fisher精确检验。</p><p>富集分析通常以P&lt;0.05作为条目显著富集的筛选阈值。富集得到的注释条目可通过如下柱状图进行展示。其中GO富集分析通常会以不同颜色表示GO条目所属大类。</p><p><img src="https://pic1.zhimg.com/80/v2-337b34639e4ba370168261dffd1c8794_1440w.webp" alt="img"></p><p><img src="https://pic1.zhimg.com/80/v2-57c2e0b655f6116cb3d0092fc6ad3e98_1440w.webp" alt="img"></p><p>（GO富集柱状图（上）和KEGG富集柱状图（下）[6]）</p><p>气泡图也是富集分析常见图形展示，相比柱状图可以通过气泡的横坐标、颜色、大小展示更多维度的富集参数，包括E-ratio（富集倍数）、p值和条目中蛋白数量等。其中富集倍数越大、p值越小说明该条目在差异蛋白中富集程度越显著。</p><p><img src="https://pic2.zhimg.com/80/v2-b68e4e71aab7f9d68310089014ed8f31_1440w.webp" alt="img"></p><p>（GO富集气泡图（左）和KEGG富集气泡图（右）[1]）</p><h3 id="互作网络分析"><a href="#互作网络分析" class="headerlink" title="互作网络分析"></a><strong>互作网络分析</strong></h3><p>在生物体内，蛋白质并非单独发挥作用，其功能的行使须依赖于其他蛋白的调控和介导，这种调控和介导要求蛋白质之间存在直接或间接的相互作用。</p><p>STRING（Search Tool for the Retrieval of Interaction Gene&#x2F;Proteins）数据库是目前使用最广泛、信息最全面的蛋白互作网络分析工具，既包含了已有报道的蛋白质互作数据，也包含了基于预测的蛋白质互作信息。文章中一般以PPI（Protein‑Protein Interaction）互作网络图进行展示，每个节点为一个差异蛋白，节点之间的连线表示两个蛋白之间存在已知的或预测可能存在的蛋白相互作用，节点颜色表示该蛋白在比较组中的定量信息，如下图所示。PPI互作网络可以直观的展示蛋白间的相互关联，并进一步帮助我们寻找其中的关键节点。</p><p><img src="https://pic4.zhimg.com/80/v2-1d8530ad5f6fd4601149dbaa9211b53f_1440w.webp" alt="img"></p><p>（蛋白互作网络图[7]）</p><p><strong>总结</strong></p><p>蛋白质组学的数据分析通常包含以下内容：通过比较不同蛋白质在不同样本中的表达情况，找到差异表达蛋白；通过功能注释和富集分析，找到差异蛋白显著富集的生物学功能和信号通路；对差异表达蛋白进行蛋白互作网络分析，展示差异蛋白间的相互关联，从而寻找网络中的关键节点。这些分析能够帮助我们筛选获得关键蛋白、生物学功能和信号通路，对于深度解析蛋白质组学数据，指导后续功能研究等具有重要意义。</p><p><strong>参考文献</strong></p><ol><li>Shu T, Ning W, Wu D, et al. Plasma Proteomics Identify Biomarkers and Pathogenesis of COVID-19[J]. Immunity, 2020, 53(5): 1108-1122</li><li>Lin Y H, Platt M P, Fu H, et al. Global Proteome and Phosphoproteome Characterization of Sepsis-induced Kidney Injury[J]. Mol Cell Proteomics, 2020, 19(12): 2030-2047.</li><li>Zhang Q, Lou Y, Yang J, et al. Integrated multiomic analysis reveals comprehensive tumour heterogeneity and novel immunophenotypic classification in hepatocellular carcinomas[J]. Gut, 2019, 68(11): 2019-2031.</li><li>Mohanty V, Subbannayya Y, Patil S, et al. Molecular alterations in oral cancer using high-throughput proteomic analysis of formalin-fixed paraffin-embedded tissue[J]. Journal of cell communication and signaling, 2021, 15(3): 447-459.</li><li>Wen L, Liu Y F, Jiang C, et al. Comparative Proteomic Profiling and Biomarker Identification of Traditional Chinese Medicine-Based HIV&#x2F;AIDS Syndromes[J]. Sci Rep, 2018, 8(1): 4187-4197.</li><li>Zhou F, Luo Q, Han L, et al. Proteomics reveals urine apolipoprotein A-I as a potential biomarker of acute kidney injury following percutaneous coronary intervention in elderly patients[J]. Exp Ther Med, 2021, 22(1): 745-755.</li><li>Ji F, Zhou M, Sun Z, et al. Integrative proteomics reveals the role of E3 ubiquitin ligase SYVN1 in hepatocellular carcinoma metastasis[J]. Cancer Commun (Lond), 2021, 41(10): 1007-1023.</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;使用Maxquant对原始谱图搜库完成后，可以得到大量蛋白质的鉴定和定量信息。下一步就需要通过统计分析和生物信息学分析，从搜库得到的大量信息中筛选和寻找关键蛋白和信号通路，以及进行相关功能的验证。本讲我们会为大家介绍如何进行蛋白质组学的定量数据分析</summary>
      
    
    
    
    
    <category term="BioInfo" scheme="http://nikolahuang.github.io/tags/BioInfo/"/>
    
  </entry>
  
  <entry>
    <title>WES数据分析流程(下)--可视化</title>
    <link href="http://nikolahuang.github.io/2024/03/17/WES%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B-%E4%B8%8B/"/>
    <id>http://nikolahuang.github.io/2024/03/17/WES%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B-%E4%B8%8B/</id>
    <published>2024-03-17T06:53:33.000Z</published>
    <updated>2024-04-05T16:53:13.943Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><p>转自<a href="https://zhuanlan.zhihu.com/p/380684876">Die Linke</a></p><p>MyNotes：</p><p>总体概括为：全外显子测序的标准分析流程通常包括以下步骤：</p><p><strong>质量控制（Quality Control，QC）</strong></p><p>对原始测序数据进行质量控制，包括去除低质量的序列片段、过滤掉低质量的碱基和低覆盖度的测序片段等。</p><p><strong>读取比对（Read Alignment）</strong></p><p>将过滤后的测序数据比对到参考基因组上，以确定每个片段的位置和方向。</p><p><strong>变异检测（Variant Calling）</strong></p><p>通过对比测序数据和参考基因组，识别出样本中存在的单核苷酸多态性（Single Nucleotide Polymorphism，SNP）和插入&#x2F;删除多态性（Insertion&#x2F;Deletion，InDel）等变异。</p><p><strong>注释（Annotation）</strong></p><p>对检测到的变异进行注释，包括位置信息、功能影响、已知疾病关联等。</p><p><strong>过滤（Filtering）</strong></p><p>根据预设的过滤标准，过滤掉可能为假阳性的变异，如常见的多态性、测序误差等。</p><p><strong>数据解读（Data Interpretation）</strong></p><p>将过滤后的变异进行进一步分析和解读，以确定与研究对象相关的变异。</p><p><strong>功能验证（Functional Validation）</strong></p><p>通过实验验证已识别的变异是否与疾病相关，例如验证变异对基因表达、蛋白质功能的影响等。</p><hr><h3 id="分析流程"><a href="#分析流程" class="headerlink" title="分析流程"></a>分析流程</h3><ol><li><h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作:"></a>准备工作:</h4></li><li><h5 id="数据上传"><a href="#数据上传" class="headerlink" title="数据上传:"></a>数据上传:</h5></li></ol><p>从本地硬盘通过<strong>FileZilla软件</strong>或在云端通过<a href="https://www.zhihu.com/search?q=scp%E5%8D%8F%E8%AE%AE&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">scp协议</a>将所需数据传输至进行分析的服务器.</p><ul><li>FileZilla示例:</li></ul><p>如下图所示，在窗口拖动数据文件到指定目录即可。</p><p><img src="https://pic1.zhimg.com/v2-8111d0db8f7f9825dd9b1e50e8838f78_b.jpg" alt="img"></p><ul><li>scp协议示例:</li></ul><p>命令行输入以下命令进行文件传输。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">scp -r local_folder remote_user_name@remote_ip:remote_folder</span><br><span class="line">#-r表示递归传出路径下所有文件</span><br><span class="line">#local_folder为传出的本地文件夹</span><br><span class="line">#remote_user_name为接收文件的远程用户名</span><br><span class="line">#remote_ip为接收文件的远程用户所在的ip地址</span><br><span class="line"># remote_folder为远程用户下储存接收文件的文件夹</span><br></pre></td></tr></table></figure><ol start="2"><li><h5 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装:"></a>软件安装:</h5></li></ol><ul><li>先在服务器上安装conda, conda的安装使用请参照之前的文章<a href="https://zhuanlan.zhihu.com/p/174802525">生科院的老张：无root权限conda安装PyRosetta同源建模</a>，安装好后通过conda进一步安装软件<strong>fastqc, multiqc, trimmomatic, bwa, samtools, bcftools, vcftools, gffread</strong>, 参考代码如下:</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda create -n WES_WGS_WGRS #新建一个名为WES_WGS_WGRS的conda环境</span><br><span class="line">conda activate WES_WGS_WGRS#激活进入新建的WES_WGS_WGRS环境</span><br><span class="line">conda install fastqc multiqc trimmomatic bwa samtools bcftools vcftools gffread #在该环境下安装fastqc等软件</span><br></pre></td></tr></table></figure><ul><li>如下图所示，<strong>ANNOVAR</strong>软件需要在官网 <a href="https://link.zhihu.com/?target=https://annovar.openbioinformatics.org/en/latest/user-guide/download/">Download ANNOVAR - ANNOVAR Documentation</a> 通过教育邮箱申请下载链接下载。</li></ul><p><img src="https://pic2.zhimg.com/v2-93f49395e5d0c2147f7287f37e7b7485_b.jpg" alt="img"></p><ul><li>通过wget下载安装gtfToGenePred:</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget http://hgdownload.cse.ucsc.edu/admin/exe/linux.x86_64.v369/gtfToGenePred</span><br><span class="line">mkdir -p /path/to/save/gtfToGenePred/bin #创建gtfToGenePred的储存路径并创建bin目录</span><br><span class="line">cp gtfToGenePred /path/to/save/gtfToGenePred/bin #将gtfToGenePred移入储存路径下的bin目录</span><br><span class="line">chmod +x /path/to/save/gtfToGenePred/bin/gtfToGenePred #赋予其读写执行全部权限</span><br></pre></td></tr></table></figure><ul><li>在R中安装stringr, circlize, grid, ComplexHeatmap, 需先安装Bioconductor, 详见之前的文章<a href="https://zhuanlan.zhihu.com/p/345896914">生科院的老张：RNAseq转录组差异表达分析教程</a>:</li></ul><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">BiocManager<span class="operator">::</span>install<span class="punctuation">(</span><span class="string">&#x27;stringr&#x27;</span><span class="punctuation">)</span></span><br><span class="line">BiocManager<span class="operator">::</span>install<span class="punctuation">(</span><span class="string">&#x27;circlize&#x27;</span><span class="punctuation">)</span></span><br><span class="line">BiocManager<span class="operator">::</span>install<span class="punctuation">(</span><span class="string">&#x27;grid&#x27;</span><span class="punctuation">)</span></span><br><span class="line">BiocManager<span class="operator">::</span>install<span class="punctuation">(</span><span class="string">&#x27;ComplexHeatmap&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure><ol start="3"><li><h5 id="参考基因组和基因组注释文件"><a href="#参考基因组和基因组注释文件" class="headerlink" title="参考基因组和基因组注释文件:"></a>参考基因组和<a href="https://www.zhihu.com/search?q=%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%B3%A8%E9%87%8A&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">基因组注释</a>文件:</h5></li></ol><p>在对应的网站下载参考基因组和基因组注释文件, 如在NCBI的genome搜索<strong>ZM4</strong>能找到我要的物种对应的<strong>reference genome</strong>和<strong>annotation</strong>. </p><p>如图所示，点击红色方框内的genome和GFF会分别下载到.fasta格式的参考<a href="https://www.zhihu.com/search?q=%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%BA%8F%E5%88%97&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">基因组序列</a>和.gff格式的基因组注释。<strong>下方的基因组全长可以记录下来，在之后的分析中会使用到</strong>。</p><p><img src="https://pic4.zhimg.com/v2-f1c0fc836b2974bb1e039a656ad3cc17_b.jpg" alt="img"></p><hr><ol start="2"><li><h4 id="质量控制"><a href="#质量控制" class="headerlink" title="质量控制:"></a>质量控制:</h4></li></ol><p>任何组学分析第一步都是对测序数据进行质量控制，细节可以参考之前的转录组教程 <a href="https://zhuanlan.zhihu.com/p/345896914">生科院的老张：RNAseq转录组差异表达分析教程</a> , 和转录组一样，使用md5检查数据完整性，fastqc进行质量检测，multiqc合并报告，trimmomatic进行质量过滤,参考代码如下：</p><ol><li><h5 id="md5检查数据完整性："><a href="#md5检查数据完整性：" class="headerlink" title="md5检查数据完整性："></a>md5检查数据完整性：</h5></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">md5sum *gz &gt; md5.txt &amp;&amp; md5sum -c md5.txt</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">*gz 任意以gz结尾的文件</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">&gt; 运行结果保存至</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">&amp;&amp; 连接符，前一命令完成继续执行下一命令</span></span><br></pre></td></tr></table></figure><p>2.2.2 fastqc质量控制与multiqc合并质控报告:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fastqc *gz &amp;&amp; multiqc ./</span><br><span class="line"># 对所有gz结尾文件进行质控并对当前目录下所有质控报告进行合并</span><br></pre></td></tr></table></figure><p>2.2.3 trimmomatic质量过滤:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">trimmomatic </span><br><span class="line">PE #双端测序，单端测序为SE</span><br><span class="line">-threads 4 #指定线程数为4</span><br><span class="line">~/WES_WGS_WGRS/data/sample1/sample1_1.fq.gz #输入序列</span><br><span class="line">~/WES_WGS_WGRS/data/sample1/sample1_2.fq.gz</span><br><span class="line">~/WES_WGS_WGRS/data/sample1/sample1_paired_clean_1.fq.gz #输出配对序列和非配对序列</span><br><span class="line">~/WES_WGS_WGRS/data/sample1/sample1_unpair_clean_1.fq.gz </span><br><span class="line">~/WES_WGS_WGRS/data/sample1/sample1_paired_clean_2.fq.gz</span><br><span class="line">~/WES_WGS_WGRS/data/sample1/sample1_unpair_clean_2.fq.gz</span><br><span class="line">ILLUMINACLIP:/data1/guest/yinlei/miniconda3/pkgs/trimmomatic-0.39-1/share/trimmomatic/adapters/TruSeq3-PE-2.fa:2:30:10:1:true </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">去除ILLUMINA接头，根据质控报告选择trimmomatic文件夹adapters路径下的接头文件</span></span><br><span class="line">LEADING:3 #从reads开头切除质量低于阈值3的碱基</span><br><span class="line">TRAILING:3 #从reads末尾切除质量低于阈值3的碱基</span><br><span class="line">SLIDINGWINDOW:4:20 #从reads 5‘端开始进行长度为4的滑窗过滤，切除碱基质量低于阈值20的碱基</span><br><span class="line">MINLEN:50 #丢弃剪切后长度低于阈值50的reads</span><br><span class="line">TOPHRED33 #将reads的碱基质量值体系转为phred-33，若为phred-64则为TOPHRED64</span><br></pre></td></tr></table></figure><p>由于一批测序数据中有多个测序文件，因此需要循环以上过程，参考代码如下图所示：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for dir in A B C D; #循环读取A,B,C,D四个目录</span><br><span class="line">do XXXX; #执行XXXX</span><br><span class="line">done #结束命令</span><br></pre></td></tr></table></figure><p><img src="https://pic4.zhimg.com/v2-9703758821f41b86bfa57ed16c315d27_b.jpg" alt="img"></p><p>trimmomatic质量过滤</p><hr><ol start="3"><li><h4 id="bwa序列比对"><a href="#bwa序列比对" class="headerlink" title="bwa序列比对:"></a>bwa序列比对:</h4></li></ol><p>将经过质量控制的序列与<a href="https://www.zhihu.com/search?q=%E5%8F%82%E8%80%83%E5%9F%BA%E5%9B%A0%E7%BB%84&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">参考基因组</a>进行比对，参考代码如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">建立比对索引</span></span><br><span class="line">bwa index genome.fa</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将序列与基因组进行比对</span></span><br><span class="line">bwa mem -t 16 genome.fa sample1_paired_clean_1.fq.gz sample1_paired_clean_2.fq.gz &gt; sample1.sam</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">参数如下：</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mem 比对算法</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-t 16 指定线程数为16</span></span><br></pre></td></tr></table></figure><p>同样由于一批测序数据中有多个测序文件，因此需要循环以上过程，参考代码如下图所示：</p><p><img src="https://pic1.zhimg.com/v2-b216223c5c2756b90f70edaf521b5f28_b.png" alt="img"></p><p>bwa比对基因组</p><hr><ol start="4"><li><h4 id="samtools去除PCR重复后排序："><a href="#samtools去除PCR重复后排序：" class="headerlink" title="samtools去除PCR重复后排序："></a>samtools去除PCR重复后排序：</h4></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将比对结果sample1.sam转为.bam格式</span></span><br><span class="line">samtools view -bS sample1.sam &gt; sample1.bam</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">参数如下:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-bS 表示输出bam文件，输入为sam文件</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">去除PCR重复</span></span><br><span class="line">samtools rmdup -s sample1.bam sample1.rm.bam</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">排序</span></span><br><span class="line">samtools sort -@ 16 sample1.rm.bam &gt; sample1.sorted.bam</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">参数如下：</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-@ 16 指定线程数为16</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">建立索引</span></span><br><span class="line">samtools index sample1.sorted.bam</span><br></pre></td></tr></table></figure><p>同样由于一批测序数据中有多个测序文件，因此需要循环以上过程，参考代码如下图所示：</p><p><img src="https://pic4.zhimg.com/v2-4f78fbccb367a64b7a57531bd386ce1b_b.png" alt="img"></p><p>samtools去除PCR重复，排序和建立索引</p><hr><ol start="5"><li><h4 id="samtools进行SNP-calling："><a href="#samtools进行SNP-calling：" class="headerlink" title="samtools进行SNP calling："></a>samtools进行SNP calling：</h4></li></ol><p>得到基因组比对的去重复排序结果后，我们将比对信息中SNP的信息提取出来并整理成通用的突变格式VCF.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">SNP calling</span></span><br><span class="line">samtools mpileup -gSDf genome.fa sample1.sorted.bam sample1.bcf</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将SNP鉴定结果sample1.bcf转为vcf格式</span></span><br><span class="line">bcftools view -cvNg sample1.bcf sample1.vcf</span><br></pre></td></tr></table></figure><p>同样由于一批测序数据中有多个测序文件，因此需要循环以上过程，参考代码如下图所示：</p><p><img src="https://pic3.zhimg.com/v2-3804e06f71efc568efbefce3e3786d9e_b.png" alt="img"></p><p>samtools进行SNP calling</p><p><img src="https://pic1.zhimg.com/v2-32f56b62fbe940b13b82537ce6542244_b.png" alt="img"></p><p>bcftools进行vcf格式转换</p><hr><ol start="6"><li><h4 id="vcftools进行SNP质量过滤："><a href="#vcftools进行SNP质量过滤：" class="headerlink" title="vcftools进行SNP质量过滤："></a>vcftools进行SNP质量过滤：</h4></li></ol><p>得到的VCF文件记录了我们分析得到的外显子(对应WES)或基因组(对应WGS或WGRS)上的全部SNP信息，但是这里边有一些是低质量的噪音信息，我们需要通过设置一系列的筛选标准来将噪音去除，称为SNP质量过滤或数据清洗。我一般选用以下三个标准：</p><ul><li>–max-missing: 最大缺失值</li><li>–minDP: 最小测序深度</li><li>–minQ: 最小碱基质量</li></ul><p>其中比较难以理解的是最大缺失值这个参数，vcftools官方给出的定义是这样的：</p><p><img src="https://pic4.zhimg.com/v2-b3f3afce179cbcf85e1a27f1aa631a43_b.png" alt="img"></p><p>最大缺失值官方定义</p><p>我盯住的是0允许全部缺失而1代表不允许缺失，那就是<strong>说该值是介于0～1之间的浮点数，其大小代表着最少需要多少平行含有该SNP的比例。如0.3就代表至少30%的平行都有该SNP.</strong></p><p>参考代码如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vcftools --vcf sample1.vcf --minDP 3 --max-missing 0.3 --minQ 30 --recode --recode-INFO-all --out sample1.filtered</span><br></pre></td></tr></table></figure><p>同样由于一批测序数据中有多个测序文件，因此需要循环以上过程，参考代码如下图所示：</p><p><img src="https://pic4.zhimg.com/v2-a621573119dd0df2c15dd293d469d9df_b.png" alt="img"></p><p>vcftools进行SNP质量过滤</p><hr><ol start="7"><li><h4 id="ANNOVAR进行SNP注释"><a href="#ANNOVAR进行SNP注释" class="headerlink" title="ANNOVAR进行SNP注释:"></a>ANNOVAR进行SNP注释:</h4></li></ol><p>利用前面下载的基因组和注释文件对质量过滤后的SNP进行注释, 【<strong>将基因组和注释文件放在同一路径下】！</strong></p><ol><li><h5 id="gffread和gtfToGenePred进行注释文件的格式转换："><a href="#gffread和gtfToGenePred进行注释文件的格式转换：" class="headerlink" title="gffread和gtfToGenePred进行注释文件的格式转换："></a>gffread和gtfToGenePred进行注释文件的格式转换：</h5></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">我们下载的参考基因组注释文件是.gff格式的，需要转换为.gtf格式</span></span><br><span class="line">gffread ZM4_annotation.gff -T -o ZM4_annotation.gtf</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将.gtf格式的注释文件转为ANNOVAR需要的输入文件</span></span><br><span class="line">/path/to/bin/gtfToGenePred -genePredExt ZM4_annotation.gtf ZM4_refGene.txt</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">【此时ZM4_refGene.txt应该和ZM4_annotation.gtf, ZM4_genome.fa是同一路径！！！】</span></span><br></pre></td></tr></table></figure><ol start="2"><li><h5 id="ANNOVAR进行注释："><a href="#ANNOVAR进行注释：" class="headerlink" title="ANNOVAR进行注释："></a>ANNOVAR进行注释：</h5></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">建立注释索引</span></span><br><span class="line">perl /path/to/annovar/retrieve_seq_from_fasta.pl --format refGene --seqfile ZM4_genome.fa ZM4_refGene.txt --outfile ZM4_refGeneMrna.fa</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">【此时ZM4_refGeneMrna.fa应该和ZM4_refGene.txt, ZM4_annotation.gtf, ZM4_genome.fa是同一路径！！！】</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将SNP信息文件.vcf转为ANNOVAR需要的输入文件</span></span><br><span class="line">perl /path/to/annovar/convert2annovar.pl -format vcf4old sample1.filtered.recode.vcf &gt; sample1.annovar</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">注释</span></span><br><span class="line">perl /path/to/annovar/annotate_variation.pl -buildver ZM4 -outfile sample1.anno sample1.annovar /path/to/ZM4_refGeneMrna.fa and ZM4_refGene.txt/</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">参数详解：</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-buildver ZM4 指定注释文件的版本是ZM4, 即注释文件XX_refGene.txt和XX_refGeneMrna.fa的前缀XX</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-outfile 输出注释文件</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">然后接输入文件</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">最后接注释文件的储存路径，即ZM4_refGeneMrna.fa, ZM4_refGene.txt, ZM4_annotation.gtf, ZM4_genome.fa的储存路径</span></span><br></pre></td></tr></table></figure><p>SNP注释结果文件预览结果如下图所示：</p><p><img src="https://pic1.zhimg.com/v2-4a973d12b5754a8aafac5ce6e22913cc_b.png" alt="img"></p><p>由左至右各列信息为：</p><ul><li>所在行</li><li>同义&#x2F;非同义突变</li><li>突变基因&#x2F;外显子&#x2F;核苷酸变化及位置&#x2F;氨基酸变化及位置</li><li>染色体</li><li>突变起始位置</li><li>突变终止位置</li><li><a href="https://www.zhihu.com/search?q=%E5%8E%9F%E5%A7%8B%E5%BA%8F%E5%88%97&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">原始序列</a></li><li>突变序列</li><li>同源&#x2F;异源</li><li>FQ: Phred probability of all samples being the same</li><li>XXX </li><li><a href="https://www.zhihu.com/search?q=%E6%B5%8B%E5%BA%8F%E8%B4%A8%E9%87%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">测序质量</a></li></ul><p>同样由于一批测序数据中有多个测序文件，因此需要循环注释过程，参考代码如下图所示：</p><p><img src="https://pic3.zhimg.com/v2-edb807163059c83846400ed378457922_b.png" alt="img"></p><p>ANNOVAR进行SNP注释</p><hr><ol start="8"><li><h4 id="可视化补充信息—-samtools统计测序覆盖度和深度"><a href="#可视化补充信息—-samtools统计测序覆盖度和深度" class="headerlink" title="可视化补充信息—-samtools统计测序覆盖度和深度:"></a>可视化补充信息—-samtools<a href="https://www.zhihu.com/search?q=%E7%BB%9F%E8%AE%A1%E6%B5%8B%E5%BA%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">统计测序</a>覆盖度和深度:</h4></li></ol><p>前方步骤中得到的去除PCR重复排序后的比对结果sample1.sorted.bam, 可通过samtools统计其中包含的测序覆盖度和深度信息用于可视化，参考代码如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">samtools depth sample1.sorted.bam sample1.depth</span><br></pre></td></tr></table></figure><p>得到的.depth文件预览结果如下：</p><ul><li>第一列为染色体名称</li><li>第二列为染色体上的核苷酸位置</li><li>第三列为该位置上的测序深度</li></ul><p><img src="https://pic2.zhimg.com/v2-a731b92c8c2fe25660cdc6fe1a71b2b1_b.jpg" alt="img"></p><p>samtools进行测序覆盖度和深度统计</p><hr><h3 id="可视化："><a href="#可视化：" class="headerlink" title="可视化："></a>可视化：</h3><ol><li><h4 id="测序覆盖度和深度："><a href="#测序覆盖度和深度：" class="headerlink" title="测序覆盖度和深度："></a>测序覆盖度和深度：</h4></li></ol><p>将上一步得到的.depth文件用于统计测序深度与覆盖度，在Python中的参考代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">######################################################PARAMETERS#######################################################</span></span><br><span class="line">work_dir=<span class="string">&#x27;/Users/ZYP/Downloads/WES_analysis_on_ZM4_RNAseq_data/3.raw/depth/&#x27;</span> <span class="comment">#输入和输出文件路径</span></span><br><span class="line">files=[<span class="string">&#x27;8P_MUT1&#x27;</span>,<span class="string">&#x27;8P_OE1&#x27;</span>,<span class="string">&#x27;8P_WT1&#x27;</span>,<span class="string">&#x27;G5_MUT1&#x27;</span>,<span class="string">&#x27;G5_OE1&#x27;</span>,<span class="string">&#x27;G5_WT1&#x27;</span>,<span class="string">&#x27;8P_MUT2&#x27;</span>,<span class="string">&#x27;8P_OE2&#x27;</span>,<span class="string">&#x27;8P_WT2&#x27;</span>,<span class="string">&#x27;G5_MUT2&#x27;</span>,<span class="string">&#x27;G5_OE2&#x27;</span>,<span class="string">&#x27;G5_WT2&#x27;</span>] <span class="comment">#输入文件名前缀</span></span><br><span class="line">start_position=<span class="number">254</span><span class="comment">#from depth file 测序起始位置</span></span><br><span class="line">end_position=<span class="number">2056015</span><span class="comment">#from depth file 测序终止位置</span></span><br><span class="line">distance=<span class="number">1000</span><span class="comment">#distance for calculating average depth 用于统计平均深度和覆盖度的片段大小</span></span><br><span class="line">length_genome=<span class="number">2056363</span><span class="comment">#from genome 基因组总长</span></span><br><span class="line"><span class="comment">#######################################################################################################################</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> files:</span><br><span class="line">    list_pos = []</span><br><span class="line">    list_depth = []</span><br><span class="line">    sum_depths = <span class="number">0</span></span><br><span class="line">    distance_pos = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(work_dir+name+<span class="string">&#x27;.depth&#x27;</span>):</span><br><span class="line">        sum_depths += <span class="built_in">float</span>(line[:-<span class="number">1</span>].split(<span class="string">&#x27;\t&#x27;</span>)[<span class="number">2</span>])</span><br><span class="line">        <span class="keyword">if</span> start_position &gt;distance*distance_pos:</span><br><span class="line">            list_pos.append(distance_pos)</span><br><span class="line">            list_depth.append(<span class="number">0</span>)</span><br><span class="line">            distance_pos+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> start_position==distance*distance_pos <span class="keyword">or</span> start_position==length_genome:</span><br><span class="line">            list_pos.append(distance_pos)</span><br><span class="line">            <span class="keyword">if</span> start_position==distance*distance_pos:</span><br><span class="line">                list_depth.append(sum_depths/distance)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                list_depth.append(sum_depths/(length_genome%distance))</span><br><span class="line">            sum_depths=<span class="number">0</span></span><br><span class="line">            distance_pos += <span class="number">1</span></span><br><span class="line">        start_position+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> start_position &lt; length_genome:</span><br><span class="line">        <span class="keyword">if</span> start_position &gt; distance*(distance_pos-<span class="number">1</span>):</span><br><span class="line">            list_pos.append(distance_pos)</span><br><span class="line">            list_depth.append(sum_depths/(start_position-distance*(distance_pos-<span class="number">1</span>)))</span><br><span class="line">            distance_pos+=<span class="number">1</span></span><br><span class="line">        list_pos.append(distance_pos)</span><br><span class="line">        list_depth.append(<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;data loading finished!&#x27;</span>)</span><br><span class="line">    ax=sns.barplot(x=list_pos,y=list_depth)</span><br><span class="line">    ax.spines[<span class="string">&#x27;top&#x27;</span>].set_visible(<span class="literal">False</span>)</span><br><span class="line">    ax.spines[<span class="string">&#x27;right&#x27;</span>].set_visible(<span class="literal">False</span>)</span><br><span class="line">    ax.spines[<span class="string">&#x27;left&#x27;</span>].set_color(<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line">    ax.spines[<span class="string">&#x27;bottom&#x27;</span>].set_color(<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line">    plt.savefig(work_dir+name+<span class="string">&#x27;_depth.pdf&#x27;</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure><p>运行结果如下图所示：</p><p><img src="https://pic2.zhimg.com/v2-77bad2eefbf63f30555d5127f8a5fd4d_b.png" alt="img"></p><p>全基因组测序深度覆盖图</p><hr><ol start="2"><li><h4 id="SNP在基因组浏览器IGV的可视化"><a href="#SNP在基因组浏览器IGV的可视化" class="headerlink" title="SNP在基因组浏览器IGV的可视化:"></a>SNP在<a href="https://www.zhihu.com/search?q=%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%B5%8F%E8%A7%88%E5%99%A8&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">基因组浏览器</a>IGV的可视化:</h4></li></ol><p>前方得到的去重复排序后的比对结果文件.sorted.bam可以在基因组浏览器IGV (下载链接为 <a href="https://link.zhihu.com/?target=http://software.broadinstitute.org/software/igv/download">http://software.broadinstitute.org/software/igv/download</a> ) 中打开，从而在基因组全局和单核苷酸局部进行个性化浏览和分析。</p><p><img src="https://pic3.zhimg.com/v2-4ae5313aef5006834c505a4738709c3e_b.jpg" alt="img"></p><p>IGV可视化基因组</p><hr><ol start="3"><li><h4 id="SNV-单核苷酸变异-和InDel-插入缺失-分析："><a href="#SNV-单核苷酸变异-和InDel-插入缺失-分析：" class="headerlink" title="SNV(单核苷酸变异)和InDel(插入缺失)分析："></a>SNV(单核苷酸变异)和InDel(插入缺失)分析：</h4></li></ol><p>包括以下部分：</p><ul><li>SNV(单核苷酸变异，包括同义突变和<a href="https://www.zhihu.com/search?q=%E9%9D%9E%E5%90%8C%E4%B9%89%E7%AA%81%E5%8F%98&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">非同义突变</a>)</li><li>Nonsynonymous SNV(非同义突变单核苷酸变异)</li><li>Amino Acid Substitution(由非同义突变造成的氨基酸替换)</li></ul><p>以ANNOVAR的SNP注释结果文件为输入，在Python中的参考代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">#######################################################PARAMETERS#######################################################</span></span><br><span class="line">path=<span class="string">&#x27;/Users/ZYP/Downloads/WES_analysis_on_ZM4_RNAseq_data/3.raw/annotation/&#x27;</span> <span class="comment">#输入和输出文件路径</span></span><br><span class="line">files=[<span class="string">&#x27;8P_MUT1&#x27;</span>,<span class="string">&#x27;8P_OE1&#x27;</span>,<span class="string">&#x27;8P_WT1&#x27;</span>,<span class="string">&#x27;G5_MUT1&#x27;</span>,<span class="string">&#x27;G5_OE1&#x27;</span>,<span class="string">&#x27;G5_WT1&#x27;</span>,<span class="string">&#x27;8P_MUT2&#x27;</span>,<span class="string">&#x27;8P_OE2&#x27;</span>,<span class="string">&#x27;8P_WT2&#x27;</span>,<span class="string">&#x27;G5_MUT2&#x27;</span>,<span class="string">&#x27;G5_OE2&#x27;</span>,<span class="string">&#x27;G5_WT2&#x27;</span>] <span class="comment">#输入文件名前缀</span></span><br><span class="line"><span class="comment">########################################################################################################################</span></span><br><span class="line">list_sample_SNV=[]</span><br><span class="line">list_para_SNV=[]</span><br><span class="line">list_SNV_name=[]</span><br><span class="line">list_sample_SNV_nonsy=[]</span><br><span class="line">list_para_SNV_nonsy=[]</span><br><span class="line">list_SNV_nonsy_name=[]</span><br><span class="line">list_sample_cAA=[]</span><br><span class="line">list_para_cAA=[]</span><br><span class="line">list_cAA_name=[]</span><br><span class="line">save_file_cAA=<span class="built_in">open</span>(path+<span class="string">&#x27;AA_substitution.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">save_file_cAA.write(<span class="string">&#x27;Sample&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;SNP type&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;Gene&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;REF NA&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;ALT NA&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;POS NA&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;REF AA&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;ALT AA&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;POS AA&#x27;</span>+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">save_file_InDel=<span class="built_in">open</span>(path+<span class="string">&#x27;InDel.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">save_file_InDel.write(<span class="string">&#x27;Sample&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;SNP type&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;Hom/Het&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;GeneFrom&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;GeneIn&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;Frame&#x27;</span>+<span class="string">&#x27;\t&#x27;</span>+<span class="string">&#x27;Effect&#x27;</span>+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">    sample=file[:-<span class="number">1</span>]</span><br><span class="line">    para=file[-<span class="number">1</span>]</span><br><span class="line">    dict_SNV = &#123;<span class="string">&#x27;A&gt;T|T&gt;A&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;A&gt;C|T&gt;G&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;A&gt;G|T&gt;C&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;C&gt;G|G&gt;C&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;G&gt;A|C&gt;T&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;G&gt;T|C&gt;A&#x27;</span>:<span class="number">0</span>&#125;</span><br><span class="line">    dict_SNV_nonsy = &#123;<span class="string">&#x27;A&gt;T|T&gt;A&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;A&gt;C|T&gt;G&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;A&gt;G|T&gt;C&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;C&gt;G|G&gt;C&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;G&gt;A|C&gt;T&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;G&gt;T|C&gt;A&#x27;</span>:<span class="number">0</span>&#125;</span><br><span class="line">    dict_cAA = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(path+<span class="string">&#x27;SNP_annotation_&#x27;</span>+file+<span class="string">&#x27;.txt&#x27;</span>):</span><br><span class="line">        kind=line.split(<span class="string">&#x27;\t&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> kind <span class="keyword">in</span> [<span class="string">&#x27;frameshift insertion&#x27;</span>,<span class="string">&#x27;framshift deletion&#x27;</span>]:</span><br><span class="line">            confusion=line.split(<span class="string">&#x27;\t&#x27;</span>)[<span class="number">8</span>]</span><br><span class="line">            geneFrom_geneIn_frame_effect = line.split(<span class="string">&#x27;\t&#x27;</span>)[<span class="number">2</span>]</span><br><span class="line">            geneFrom=geneFrom_geneIn_frame_effect.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">            geneIn=geneFrom_geneIn_frame_effect.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">            frame=geneFrom_geneIn_frame_effect.split(<span class="string">&#x27;:&#x27;</span>)[-<span class="number">2</span>]</span><br><span class="line">            effect=geneFrom_geneIn_frame_effect.split(<span class="string">&#x27;:&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">            save_file_InDel.write(file+<span class="string">&#x27;\t&#x27;</span>+kind+<span class="string">&#x27;\t&#x27;</span>+confusion+<span class="string">&#x27;\t&#x27;</span>+geneFrom+<span class="string">&#x27;\t&#x27;</span>+geneIn+<span class="string">&#x27;\t&#x27;</span>+frame+<span class="string">&#x27;\t&#x27;</span>+effect+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> kind <span class="keyword">in</span> [<span class="string">&#x27;synonymous SNV&#x27;</span>,<span class="string">&#x27;nonsynonymous SNV&#x27;</span>]:</span><br><span class="line">            gene_cNA_cAA=line.split(<span class="string">&#x27;\t&#x27;</span>)[<span class="number">2</span>]</span><br><span class="line">            gene=gene_cNA_cAA.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">            cNA=gene_cNA_cAA.split(<span class="string">&#x27;:&#x27;</span>)[-<span class="number">2</span>][<span class="number">2</span>:]</span><br><span class="line">            cAA=gene_cNA_cAA.split(<span class="string">&#x27;:&#x27;</span>)[-<span class="number">1</span>][<span class="number">2</span>:-<span class="number">1</span>]</span><br><span class="line">            REF_NA=cNA[<span class="number">0</span>]</span><br><span class="line">            ALT_NA=cNA[-<span class="number">1</span>]</span><br><span class="line">            POS_NA=cNA[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">            REF_AA=cAA[<span class="number">0</span>]</span><br><span class="line">            ALT_AA=cAA[-<span class="number">1</span>]</span><br><span class="line">            POS_AA=cAA[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">            save_file_cAA.write(file+<span class="string">&#x27;\t&#x27;</span>+kind+<span class="string">&#x27;\t&#x27;</span>+gene+<span class="string">&#x27;\t&#x27;</span>+REF_NA+<span class="string">&#x27;\t&#x27;</span>+ALT_NA+<span class="string">&#x27;\t&#x27;</span>+POS_NA+<span class="string">&#x27;\t&#x27;</span>+REF_AA+<span class="string">&#x27;\t&#x27;</span>+ALT_AA+<span class="string">&#x27;\t&#x27;</span>+POS_AA+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> key <span class="keyword">in</span> dict_SNV.keys():</span><br><span class="line">                list_changes=key.split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">                <span class="keyword">for</span> change <span class="keyword">in</span> list_changes:</span><br><span class="line">                    <span class="keyword">if</span> REF_NA==change[<span class="number">0</span>] <span class="keyword">and</span> ALT_NA==change[-<span class="number">1</span>]:</span><br><span class="line">                        dict_SNV[key]+=<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> kind==<span class="string">&#x27;nonsynonymous SNV&#x27;</span>:</span><br><span class="line">                name_cAA=REF_AA+<span class="string">&#x27;&gt;&#x27;</span>+ALT_AA</span><br><span class="line">                <span class="keyword">for</span> key <span class="keyword">in</span> dict_SNV_nonsy.keys():</span><br><span class="line">                    list_changes = key.split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">                    <span class="keyword">for</span> change <span class="keyword">in</span> list_changes:</span><br><span class="line">                        <span class="keyword">if</span> REF_NA==change[<span class="number">0</span>] <span class="keyword">and</span> ALT_NA==change[-<span class="number">1</span>]:</span><br><span class="line">                            dict_SNV_nonsy[key]+=<span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> name_cAA <span class="keyword">not</span> <span class="keyword">in</span> dict_cAA.keys():</span><br><span class="line">                    dict_cAA[name_cAA]=<span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dict_cAA[name_cAA]+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> SNV <span class="keyword">in</span> dict_SNV.keys():</span><br><span class="line">        <span class="keyword">for</span> time <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,dict_SNV[SNV]):</span><br><span class="line">            list_sample_SNV.append(sample)</span><br><span class="line">            list_para_SNV.append(para)</span><br><span class="line">            list_SNV_name.append(SNV)</span><br><span class="line">    <span class="keyword">for</span> SNV_nonsy <span class="keyword">in</span> dict_SNV_nonsy.keys():</span><br><span class="line">        <span class="keyword">for</span> time <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, dict_SNV[SNV_nonsy]):</span><br><span class="line">            list_sample_SNV_nonsy.append(sample)</span><br><span class="line">            list_para_SNV_nonsy.append(para)</span><br><span class="line">            list_SNV_nonsy_name.append(SNV_nonsy)</span><br><span class="line">    <span class="keyword">for</span> cAA <span class="keyword">in</span> dict_cAA.keys():</span><br><span class="line">        <span class="keyword">for</span> time <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, dict_cAA[cAA]):</span><br><span class="line">            list_sample_cAA.append(sample)</span><br><span class="line">            list_para_cAA.append(para)</span><br><span class="line">            list_cAA_name.append(cAA)</span><br><span class="line">data_SNV=&#123;<span class="string">&#x27;sample&#x27;</span>:list_sample_SNV,<span class="string">&#x27;parallel&#x27;</span>:list_para_SNV,<span class="string">&#x27;SNV&#x27;</span>:list_SNV_name&#125;</span><br><span class="line">data_SNV=pd.DataFrame(data_SNV)</span><br><span class="line">ax1=sns.catplot(x=<span class="string">&#x27;SNV&#x27;</span>, hue=<span class="string">&#x27;parallel&#x27;</span>, col=<span class="string">&#x27;sample&#x27;</span>, kind=<span class="string">&#x27;count&#x27;</span>,data=data_SNV,palette=<span class="string">&#x27;Set1&#x27;</span>)</span><br><span class="line">plt.savefig(path+<span class="string">&#x27;SNV.pdf&#x27;</span>)</span><br><span class="line">data_SNV_nonsy=&#123;<span class="string">&#x27;sample&#x27;</span>:list_sample_SNV_nonsy,<span class="string">&#x27;parallel&#x27;</span>:list_para_SNV_nonsy,<span class="string">&#x27;nonsynonymous SNV&#x27;</span>:list_SNV_nonsy_name&#125;</span><br><span class="line">data_SNV_nonsy=pd.DataFrame(data_SNV_nonsy)</span><br><span class="line">ax2=sns.catplot(x=<span class="string">&#x27;nonsynonymous SNV&#x27;</span>, hue=<span class="string">&#x27;parallel&#x27;</span>, col=<span class="string">&#x27;sample&#x27;</span>, kind=<span class="string">&#x27;count&#x27;</span>,data=data_SNV_nonsy,palette=<span class="string">&#x27;Set1&#x27;</span>)</span><br><span class="line">plt.savefig(path+<span class="string">&#x27;Nonsynonymous_SNV.pdf&#x27;</span>)</span><br><span class="line">data_cAA=&#123;<span class="string">&#x27;sample&#x27;</span>:list_sample_cAA,<span class="string">&#x27;parallel&#x27;</span>:list_para_cAA,<span class="string">&#x27;AA substitution&#x27;</span>:list_cAA_name&#125;</span><br><span class="line">data_cAA=pd.DataFrame(data_cAA)</span><br><span class="line">ax3=sns.catplot(x=<span class="string">&#x27;AA substitution&#x27;</span>, hue=<span class="string">&#x27;parallel&#x27;</span>, col=<span class="string">&#x27;sample&#x27;</span>, kind=<span class="string">&#x27;count&#x27;</span>,data=data_cAA,palette=<span class="string">&#x27;Set1&#x27;</span>)</span><br><span class="line">plt.savefig(path+<span class="string">&#x27;AA_substitution.pdf&#x27;</span>)</span><br><span class="line">save_file_cAA.close()</span><br></pre></td></tr></table></figure><p>如图所示，运行结束得到可视化结果和记录SNV与InDel的两个文件SNV.txt和InDel.txt .</p><p><img src="https://pic4.zhimg.com/v2-0af7b94649de8f5025e4e4b815e2a5c7_b.jpg" alt="img"></p><p>SNV and AA substitution</p><p><img src="https://pic4.zhimg.com/v2-d2403cc08e122cc8961f30bbedfb7e3f_b.jpg" alt="img"></p><p>SNV and InDel</p><hr><ol start="4"><li><h4 id="全基因组测序圈图可视化："><a href="#全基因组测序圈图可视化：" class="headerlink" title="全基因组测序圈图可视化："></a>全基因组测序圈图可视化：</h4></li></ol><p>以前文中提到的测序深度文件.depth, ANNOVAR的SNP注释结果文件, 以及基因组注释文件.gff为输入，在R中的参考代码如下：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br></pre></td><td class="code"><pre><span class="line">library<span class="punctuation">(</span>stringr<span class="punctuation">)</span>    <span class="comment">#方便处理字符串</span></span><br><span class="line">library<span class="punctuation">(</span>circlize<span class="punctuation">)</span>    <span class="comment">#绘制圈图</span></span><br><span class="line">library<span class="punctuation">(</span>grid<span class="punctuation">)</span>    <span class="comment">#设置画板</span></span><br><span class="line">library<span class="punctuation">(</span>ComplexHeatmap<span class="punctuation">)</span>    <span class="comment">#绘制图例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####################################PARAMETERS####################################</span></span><br><span class="line">sample_name <span class="operator">&lt;-</span><span class="string">&#x27;G5_WT2&#x27;</span><span class="comment">#测序样本名称</span></span><br><span class="line">ref_name <span class="operator">&lt;-</span><span class="string">&#x27;ZM4_genome&#x27;</span><span class="comment">#参考基因组名称</span></span><br><span class="line">genome_size <span class="operator">&lt;-</span><span class="number">205636</span> <span class="comment">#参考基因组长度</span></span><br><span class="line">out_dir<span class="operator">=</span> <span class="string">&#x27;/Users/ZYP/Downloads/WES_analysis_on_ZM4_RNAseq_data/results/Analysis/&#x27;</span> <span class="comment">#输出路径</span></span><br><span class="line">genome_gff <span class="operator">&lt;-</span> <span class="string">&#x27;/Users/ZYP/Downloads/WES_analysis_on_ZM4_RNAseq_data/results/IGV visualization/ZM4_annotation.gff&#x27;</span> <span class="comment">#参考基因组gff注释文件</span></span><br><span class="line">SNP_file <span class="operator">&lt;-</span><span class="string">&#x27;/Users/ZYP/Downloads/WES_analysis_on_ZM4_RNAseq_data/raw/annotation/SNP_annotation_G5_WT2.txt&#x27;</span> <span class="comment">#SNP注释文件</span></span><br><span class="line">depth_base_stat <span class="operator">&lt;-</span> <span class="string">&#x27;/Users/ZYP/Downloads/WES_analysis_on_ZM4_RNAseq_data/raw/depth/G5_WT2.depth&#x27;</span> <span class="comment">#测序深度覆盖度文件</span></span><br><span class="line">seq_split <span class="operator">&lt;-</span> 1000  <span class="comment">#滑窗大小用于统计平均测序深度和SNP密度</span></span><br><span class="line"><span class="comment">##################################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##测序覆盖度、平均深度统计</span></span><br><span class="line">depth_base <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>depth_base_stat<span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>depth_base<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;gene&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;pos&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;depth&#x27;</span><span class="punctuation">)</span></span><br><span class="line">depth <span class="operator">&lt;-</span> depth_base<span class="operator">$</span>depth</span><br><span class="line">depth_base <span class="operator">&lt;-</span> depth_base<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">depth_base<span class="operator">$</span>end <span class="operator">&lt;-</span> depth_base<span class="operator">$</span>pos</span><br><span class="line">depth_base<span class="operator">$</span>depth <span class="operator">&lt;-</span> depth</span><br><span class="line"></span><br><span class="line">depth_exist <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>depth_base<span class="punctuation">,</span> depth <span class="operator">!=</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">coverage <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span><span class="number">100</span> <span class="operator">*</span> <span class="built_in">sum</span><span class="punctuation">(</span>depth_exist<span class="operator">$</span>seq_end <span class="operator">-</span> depth_exist<span class="operator">$</span>seq_start <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">/</span> genome_size<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">average_depth <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span>mean<span class="punctuation">(</span>depth_base<span class="operator">$</span>depth<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">depth_stat <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line">gene <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>depth_exist<span class="operator">$</span>gene<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>gene_n <span class="keyword">in</span> gene<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  depth_subset <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>depth_exist<span class="punctuation">,</span> gene <span class="operator">==</span> gene_n<span class="punctuation">)</span></span><br><span class="line">  seq_end <span class="operator">&lt;-</span> seq_split</span><br><span class="line">  depth_num <span class="operator">&lt;-</span> 0</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>depth_subset<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="punctuation">(</span>depth_subset<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;pos&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;=</span> seq_end<span class="punctuation">)</span> depth_num <span class="operator">&lt;-</span> depth_num <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span> <span class="punctuation">&#123;</span></span><br><span class="line">      depth_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>depth_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>gene_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span>depth_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">      </span><br><span class="line">      seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">      depth_num <span class="operator">&lt;-</span> 0</span><br><span class="line">      <span class="keyword">while</span> <span class="punctuation">(</span>depth_subset<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;pos&#x27;</span><span class="punctuation">]</span> <span class="operator">&gt;</span> seq_end<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">        depth_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>depth_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>gene_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> depth_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">        seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">      depth_num <span class="operator">&lt;-</span> depth_num <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> <span class="punctuation">(</span>seq_end <span class="operator">&lt;</span> depth_stat<span class="punctuation">[</span>gene_n<span class="punctuation">,</span><span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    depth_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>depth_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>gene_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> depth_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">    seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">    depth_num <span class="operator">&lt;-</span> 0</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  depth_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>depth_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>gene_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_stat<span class="punctuation">[</span>gene_n<span class="punctuation">,</span><span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">]</span><span class="punctuation">,</span> depth_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">depth_stat <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>depth_stat<span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>depth_stat<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;gene&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_start&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;depth_num&#x27;</span><span class="punctuation">)</span></span><br><span class="line">depth_stat<span class="operator">$</span>seq_start <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>depth_stat<span class="operator">$</span>seq_start<span class="punctuation">)</span></span><br><span class="line">depth_stat<span class="operator">$</span>seq_end <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>depth_stat<span class="operator">$</span>seq_end<span class="punctuation">)</span></span><br><span class="line">depth_stat<span class="operator">$</span>depth_num <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>depth_stat<span class="operator">$</span>depth_num<span class="punctuation">)</span></span><br><span class="line">depth_stat</span><br><span class="line"></span><br><span class="line">seq_stat <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>gene <span class="keyword">in</span> unique<span class="punctuation">(</span>depth_base<span class="operator">$</span>gene<span class="punctuation">)</span><span class="punctuation">)</span> seq_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>seq_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>gene<span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">2056363</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">seq_stat <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>seq_stat<span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>seq_stat<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_start&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">)</span></span><br><span class="line">rownames<span class="punctuation">(</span>seq_stat<span class="punctuation">)</span> <span class="operator">&lt;-</span> seq_stat<span class="operator">$</span>seq_ID</span><br><span class="line">seq_stat<span class="operator">$</span>seq_start <span class="operator">&lt;-</span> <span class="built_in">as.integer</span><span class="punctuation">(</span>seq_stat<span class="operator">$</span>seq_start<span class="punctuation">)</span></span><br><span class="line">seq_stat<span class="operator">$</span>seq_end <span class="operator">&lt;-</span> <span class="built_in">as.integer</span><span class="punctuation">(</span>seq_stat<span class="operator">$</span>seq_end<span class="punctuation">)</span></span><br><span class="line">seq_stat</span><br><span class="line"></span><br><span class="line"><span class="comment">##参考基因组基因信息，CDS &amp; rRNA &amp; tRNA</span></span><br><span class="line">gene <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>genome_gff<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&#x27;#&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">gene <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>gene<span class="punctuation">,</span> V3 <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;CDS&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;rRNA&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;tRNA&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>gene<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_start&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;type&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;strand&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">gene<span class="punctuation">[</span>which<span class="punctuation">(</span>gene<span class="operator">$</span>type <span class="operator">==</span> <span class="string">&#x27;CDS&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span></span><br><span class="line">gene<span class="punctuation">[</span>which<span class="punctuation">(</span>gene<span class="operator">$</span>type <span class="operator">==</span> <span class="string">&#x27;rRNA&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">2</span></span><br><span class="line">gene<span class="punctuation">[</span>which<span class="punctuation">(</span>gene<span class="operator">$</span>type <span class="operator">==</span> <span class="string">&#x27;tRNA&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">3</span></span><br><span class="line">gene<span class="operator">$</span>type <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>gene<span class="operator">$</span>type<span class="punctuation">)</span></span><br><span class="line">gene <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>subset<span class="punctuation">(</span>gene<span class="punctuation">,</span> strand <span class="operator">==</span> <span class="string">&#x27;-&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">,</span> subset<span class="punctuation">(</span>gene<span class="punctuation">,</span> strand <span class="operator">==</span> <span class="string">&#x27;+&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">gene</span><br><span class="line"></span><br><span class="line"><span class="comment">#读取 SNP 文件，统计 SNP 类型</span></span><br><span class="line">snp <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>SNP_file<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> colClasses <span class="operator">=</span> <span class="string">&#x27;character&#x27;</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&#x27;#&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">,</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">snp<span class="operator">$</span>V5 <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>snp<span class="operator">$</span>V5<span class="punctuation">)</span></span><br><span class="line">snp<span class="operator">$</span>change <span class="operator">&lt;-</span> str_c<span class="punctuation">(</span>snp<span class="operator">$</span>V7<span class="punctuation">,</span> snp<span class="operator">$</span>V8<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;AT&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;A&gt;T|T&gt;A&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;AG&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;A&gt;G|T&gt;C&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;ti&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;AC&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;A&gt;C|T&gt;G&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line"></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;TA&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;A&gt;T|T&gt;A&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;TG&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;A&gt;C|T&gt;G&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;TC&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;A&gt;G|T&gt;C&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;ti&#x27;</span></span><br><span class="line"></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;GA&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;G&gt;A|C&gt;T&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;ti&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;GT&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;G&gt;T|C&gt;A&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;GC&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;G&gt;C|C&gt;G&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line"></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;CA&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;G&gt;T|C&gt;A&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;CT&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;G&gt;A|C&gt;T&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;ti&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;CG&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;G&gt;C|C&gt;G&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line"></span><br><span class="line">change_list <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;A&gt;T|T&gt;A&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;A&gt;G|T&gt;C&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;A&gt;C|T&gt;G&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;G&gt;A|C&gt;T&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;G&gt;T|C&gt;A&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;G&gt;C|C&gt;G&#x27;</span><span class="punctuation">)</span></span><br><span class="line">change_type <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;synonymous SNV&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;nonsynonymous SNV&#x27;</span><span class="punctuation">)</span></span><br><span class="line">anno_list <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#length(anno_list) &lt;- length(change_list) * length(change_type)</span></span><br><span class="line">l <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">anno <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>SNP_file<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> colClasses <span class="operator">=</span> <span class="string">&#x27;character&#x27;</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&#x27;#&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">,</span> <span class="number">12</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">anno<span class="operator">$</span>V7 <span class="operator">&lt;-</span>snp<span class="operator">$</span>type1</span><br><span class="line">anno<span class="operator">$</span>V5 <span class="operator">&lt;-</span> <span class="built_in">as.integer</span><span class="punctuation">(</span>anno<span class="operator">$</span>V5<span class="punctuation">)</span></span><br><span class="line">anno<span class="operator">$</span>V5.1 <span class="operator">&lt;-</span> <span class="built_in">as.integer</span><span class="punctuation">(</span>anno<span class="operator">$</span>V5.1<span class="punctuation">)</span></span><br><span class="line">anno<span class="operator">$</span>V12 <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>anno<span class="operator">$</span>V12<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>anno<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">6</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;seq_start&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;change&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;ratio&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;type&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> change_list<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="keyword">for</span> <span class="punctuation">(</span>j <span class="keyword">in</span> change_type<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    select <span class="operator">&lt;-</span> anno<span class="punctuation">[</span>which<span class="punctuation">(</span>anno<span class="operator">$</span>change <span class="operator">==</span> i <span class="operator">&amp;</span> anno<span class="operator">$</span>type <span class="operator">==</span> j<span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">    <span class="keyword">if</span> <span class="punctuation">(</span><span class="built_in">length</span><span class="punctuation">(</span>row.names<span class="punctuation">(</span>select<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">!=</span><span class="number">0</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    l <span class="operator">=</span> l <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">    anno_list<span class="punctuation">[[</span>l<span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> select</span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">snp_ti <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type2 <span class="operator">==</span> <span class="string">&#x27;ti&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">snp_tv <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type2 <span class="operator">==</span> <span class="string">&#x27;tv&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">snp_at <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type1 <span class="operator">==</span> <span class="string">&#x27;A&gt;T|T&gt;A&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">snp_ag <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type1 <span class="operator">==</span> <span class="string">&#x27;A&gt;G|T&gt;C&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">snp_ac <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type1 <span class="operator">==</span> <span class="string">&#x27;A&gt;C|T&gt;G&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">snp_ga <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type1 <span class="operator">==</span> <span class="string">&#x27;G&gt;A|C&gt;T&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">snp_gt <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type1 <span class="operator">==</span> <span class="string">&#x27;G&gt;T|C&gt;A&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">snp_gc <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type1 <span class="operator">==</span> <span class="string">&#x27;G&gt;C|C&gt;G&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#统计 SNP 密度</span></span><br><span class="line">snp <span class="operator">&lt;-</span> snp<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">colnames<span class="punctuation">(</span>snp<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_site&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">snp_stat <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line">seq_ID <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>snp<span class="operator">$</span>seq_ID<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>seq_ID_n <span class="keyword">in</span> seq_ID<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  snp_subset <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>snp<span class="punctuation">,</span> seq_ID <span class="operator">==</span> seq_ID_n<span class="punctuation">)</span></span><br><span class="line">  seq_end <span class="operator">&lt;-</span> seq_split</span><br><span class="line">  snp_num <span class="operator">&lt;-</span> 0</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>snp_subset<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="punctuation">(</span>snp_subset<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;seq_site&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;=</span> seq_end<span class="punctuation">)</span> snp_num <span class="operator">&lt;-</span> snp_num <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span> <span class="punctuation">&#123;</span></span><br><span class="line">      snp_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>snp_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> snp_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">      </span><br><span class="line">      seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">      snp_num <span class="operator">&lt;-</span> 0</span><br><span class="line">      <span class="keyword">while</span> <span class="punctuation">(</span>snp_subset<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;seq_site&#x27;</span><span class="punctuation">]</span> <span class="operator">&gt;</span> seq_end<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">        snp_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>snp_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> snp_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">        seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">      snp_num <span class="operator">&lt;-</span> snp_num <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> <span class="punctuation">(</span>seq_end <span class="operator">&lt;</span> seq_stat<span class="punctuation">[</span>seq_ID_n<span class="punctuation">,</span><span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    snp_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>snp_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> snp_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">    seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">    snp_num <span class="operator">&lt;-</span> 0</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  snp_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>snp_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_stat<span class="punctuation">[</span>seq_ID_n<span class="punctuation">,</span><span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">]</span><span class="punctuation">,</span> snp_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">snp_stat <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>snp_stat<span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>snp_stat<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_start&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;snp_num&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp_stat<span class="operator">$</span>seq_start <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>snp_stat<span class="operator">$</span>seq_start<span class="punctuation">)</span></span><br><span class="line">snp_stat<span class="operator">$</span>seq_end <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>snp_stat<span class="operator">$</span>seq_end<span class="punctuation">)</span></span><br><span class="line">snp_stat<span class="operator">$</span>snp_num <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>snp_stat<span class="operator">$</span>snp_num<span class="punctuation">)</span></span><br><span class="line">snp_stat</span><br><span class="line"></span><br><span class="line"><span class="comment">#读取 SNP 文件，统计 InDel 长度</span></span><br><span class="line">snp <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>SNP_file<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> colClasses <span class="operator">=</span> <span class="string">&#x27;character&#x27;</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&#x27;#&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">,</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">snp<span class="operator">$</span>V5 <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>snp<span class="operator">$</span>V5<span class="punctuation">)</span></span><br><span class="line">snp<span class="operator">$</span>change <span class="operator">&lt;-</span> str_c<span class="punctuation">(</span>snp<span class="operator">$</span>V7<span class="punctuation">,</span> snp<span class="operator">$</span>V8<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">indel <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>SNP_file<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> colClasses <span class="operator">=</span> <span class="string">&#x27;character&#x27;</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&#x27;#&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">,</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">indel<span class="operator">$</span>V5 <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>indel<span class="operator">$</span>V5<span class="punctuation">)</span></span><br><span class="line">indel<span class="operator">$</span><span class="built_in">length</span> <span class="operator">&lt;-</span> str_length<span class="punctuation">(</span>indel<span class="punctuation">[</span> <span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">-</span> str_length<span class="punctuation">(</span>indel<span class="punctuation">[</span> <span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">indel_insert <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>indel<span class="operator">$</span><span class="built_in">length</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">indel_delet <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>indel<span class="operator">$</span><span class="built_in">length</span> <span class="operator">&lt;</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#统计 InDel 密度</span></span><br><span class="line">indel <span class="operator">&lt;-</span> indel<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">colnames<span class="punctuation">(</span>indel<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_site&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">indel_stat <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line">seq_ID <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>indel<span class="operator">$</span>seq_ID<span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>seq_ID_n <span class="keyword">in</span> seq_ID<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  indel_subset <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>indel<span class="punctuation">,</span> seq_ID <span class="operator">==</span> seq_ID_n<span class="punctuation">)</span></span><br><span class="line">  seq_end <span class="operator">&lt;-</span> seq_split</span><br><span class="line">  indel_num <span class="operator">&lt;-</span> 0</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>indel_subset<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="punctuation">(</span>indel_subset<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;seq_site&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;=</span> seq_end<span class="punctuation">)</span> indel_num <span class="operator">&lt;-</span> indel_num <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span> <span class="punctuation">&#123;</span></span><br><span class="line">      indel_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>indel_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> indel_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">      </span><br><span class="line">      seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">      indel_num <span class="operator">&lt;-</span> 0</span><br><span class="line">      <span class="keyword">while</span> <span class="punctuation">(</span>indel_subset<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;seq_site&#x27;</span><span class="punctuation">]</span> <span class="operator">&gt;</span> seq_end<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">        indel_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>indel_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> indel_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">        seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">      indel_num <span class="operator">&lt;-</span> indel_num <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">while</span> <span class="punctuation">(</span>seq_end <span class="operator">&lt;</span> seq_stat<span class="punctuation">[</span>seq_ID_n<span class="punctuation">,</span><span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    indel_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>indel_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> indel_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">    seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">    indel_num <span class="operator">&lt;-</span> 0</span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  indel_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>indel_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_stat<span class="punctuation">[</span>seq_ID_n<span class="punctuation">,</span><span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">]</span><span class="punctuation">,</span> indel_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">indel_stat <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>indel_stat<span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>indel_stat<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_start&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;indel_num&#x27;</span><span class="punctuation">)</span></span><br><span class="line">indel_stat<span class="operator">$</span>seq_start <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>indel_stat<span class="operator">$</span>seq_start<span class="punctuation">)</span></span><br><span class="line">indel_stat<span class="operator">$</span>seq_end <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>indel_stat<span class="operator">$</span>seq_end<span class="punctuation">)</span></span><br><span class="line">indel_stat<span class="operator">$</span>indel_num <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>indel_stat<span class="operator">$</span>indel_num<span class="punctuation">)</span></span><br><span class="line">indel_stat</span><br><span class="line"></span><br><span class="line">pdf<span class="punctuation">(</span>str_c<span class="punctuation">(</span>out_dir<span class="punctuation">,</span> sample_name<span class="punctuation">,</span> <span class="string">&#x27;.circlize.pdf&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">40</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">28</span><span class="punctuation">)</span></span><br><span class="line">circle_size <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="string">&#x27;snpc&#x27;</span><span class="punctuation">)</span></span><br><span class="line">circos.par<span class="punctuation">(</span>gap.degree <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> start.degree <span class="operator">=</span> <span class="number">90</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第一圈，染色体区域</span></span><br><span class="line">circos.genomicInitialize<span class="punctuation">(</span>seq_stat<span class="punctuation">,</span> plotType <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;axis&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;labels&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> major.by <span class="operator">=</span> <span class="number">250000</span><span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">)</span><span class="comment">#, gap.degree=1</span></span><br><span class="line"></span><br><span class="line">circos.genomicTrackPlotRegion<span class="punctuation">(</span></span><br><span class="line">  seq_stat<span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span> stack <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">  panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    circos.genomicRect<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;#049a0b&#x27;</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第二圈，覆盖度 &amp; 深度</span></span><br><span class="line">circos.genomicTrack<span class="punctuation">(</span></span><br><span class="line">  depth_stat<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.08</span><span class="punctuation">,</span>  ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="built_in">max</span><span class="punctuation">(</span>depth_stat<span class="operator">$</span>depth<span class="punctuation">)</span> <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> bg.col <span class="operator">=</span> <span class="string">&#x27;#EEEEEE6E&#x27;</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">  panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span>value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    circos.genomicRect<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ytop.column <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> ybottom <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">    circos.lines<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="punctuation">(</span>region<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>average_depth<span class="punctuation">,</span> average_depth<span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;red3&#x27;</span><span class="punctuation">,</span> lwd<span class="operator">=</span><span class="number">0.15</span><span class="punctuation">,</span> lty <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">    circos.yaxis<span class="punctuation">(</span> lwd <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">,</span> tick.length <span class="operator">=</span> convert_x<span class="punctuation">(</span><span class="number">0.15</span><span class="punctuation">,</span> <span class="string">&#x27;mm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span>labels.cex <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第三圈，CDS &amp; rRNA &amp; tRNA</span></span><br><span class="line">color_assign <span class="operator">&lt;-</span> colorRamp2<span class="punctuation">(</span>breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#00ADFF&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green2&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">circos.genomicTrackPlotRegion<span class="punctuation">(</span></span><br><span class="line">  gene<span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.16</span><span class="punctuation">,</span> stack <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">  panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    circos.genomicRect<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> col <span class="operator">=</span> color_assign<span class="punctuation">(</span>value<span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第四圈，SNP 密度</span></span><br><span class="line">value_max <span class="operator">&lt;-</span> <span class="built_in">max</span><span class="punctuation">(</span>snp_stat<span class="operator">$</span>snp_num<span class="punctuation">)</span></span><br><span class="line">colorsChoice <span class="operator">&lt;-</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#245B8E&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">color_assign <span class="operator">&lt;-</span> colorRamp2<span class="punctuation">(</span>breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="operator">:</span>value_max<span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> colorsChoice<span class="punctuation">(</span>value_max <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">circos.genomicTrackPlotRegion<span class="punctuation">(</span></span><br><span class="line">  snp_stat<span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.08</span><span class="punctuation">,</span> stack <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">  panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    circos.genomicRect<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> col <span class="operator">=</span> color_assign<span class="punctuation">(</span>value<span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第五圈，InDel 密度</span></span><br><span class="line">value_max <span class="operator">&lt;-</span> <span class="built_in">max</span><span class="punctuation">(</span>indel_stat<span class="operator">$</span>indel_num<span class="punctuation">)</span></span><br><span class="line">colorsChoice <span class="operator">&lt;-</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#7744A4&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">color_assign <span class="operator">&lt;-</span> colorRamp2<span class="punctuation">(</span>breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="operator">:</span>value_max<span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> colorsChoice<span class="punctuation">(</span>value_max <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">circos.genomicTrackPlotRegion<span class="punctuation">(</span></span><br><span class="line">  indel_stat<span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.08</span><span class="punctuation">,</span> stack <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">  panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    circos.genomicRect<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> col <span class="operator">=</span> color_assign<span class="punctuation">(</span>value<span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第六圈, SNV分布图</span></span><br><span class="line">color_assign <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#BC80BD&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FDB462&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#80B1D3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FB8072&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#8DD3C7&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FFFFB3&#x27;</span><span class="punctuation">)</span></span><br><span class="line">pch_assign <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">16</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">circos.genomicTrackPlotRegion<span class="punctuation">(</span></span><br><span class="line">  anno_list<span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.08</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> bg.lwd <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">,</span></span><br><span class="line">  panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  n <span class="operator">=</span> getI<span class="punctuation">(</span>...<span class="punctuation">)</span></span><br><span class="line">  circos.genomicPoints<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">1.0</span><span class="punctuation">,</span> pch <span class="operator">=</span> pch_assign<span class="punctuation">[</span>ifelse<span class="punctuation">(</span>n<span class="operator">%%</span><span class="number">2</span><span class="punctuation">,</span> n<span class="operator">%%</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> col <span class="operator">=</span> color_assign<span class="punctuation">[</span>ifelse<span class="punctuation">(</span>n<span class="operator">%%</span><span class="number">6</span><span class="punctuation">,</span> n<span class="operator">%%</span><span class="number">6</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">  circos.yaxis<span class="punctuation">(</span>labels.cex <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">,</span> tick.length <span class="operator">=</span> convert_x<span class="punctuation">(</span><span class="number">0.15</span><span class="punctuation">,</span> <span class="string">&#x27;mm&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  xlim <span class="operator">=</span> CELL_META<span class="operator">$</span>xlim</span><br><span class="line">  ylim <span class="operator">=</span> CELL_META<span class="operator">$</span>ylim</span><br><span class="line">  <span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#draw.sector(start.degree, end.degree, clock.wise = FALSE)#突出显示</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#测序深度、覆盖度图例</span></span><br><span class="line">depth_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">  at <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> labels <span class="operator">=</span> str_c<span class="punctuation">(</span><span class="string">&#x27; Depth ( average: &#x27;</span><span class="punctuation">,</span> average_depth<span class="punctuation">,</span> <span class="string">&#x27; X )&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  title <span class="operator">=</span> str_c<span class="punctuation">(</span><span class="string">&#x27;Coverage: &#x27;</span><span class="punctuation">,</span> coverage <span class="punctuation">,</span> <span class="string">&#x27; %&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> title_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  grid_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> grid_width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;points&#x27;</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> background <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#CDS &amp; rRNA &amp; tRNA 图例</span></span><br><span class="line">gene_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">  at <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27; CDS&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; rRNA&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; tRNA&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  title <span class="operator">=</span> <span class="string">&#x27;CDS | rRNA | tRNA&#x27;</span><span class="punctuation">,</span> title_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">  grid_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> grid_width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;points&#x27;</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> background <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#00ADFF&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green2&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#SNP 密度图例</span></span><br><span class="line">snp_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">  at <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="punctuation">(</span>snp_stat<span class="operator">$</span>snp_num<span class="punctuation">)</span><span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  col_fun <span class="operator">=</span> colorRamp2<span class="punctuation">(</span><span class="built_in">round</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="punctuation">(</span>snp_stat<span class="operator">$</span>snp_num<span class="punctuation">)</span><span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#245B8E&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  title_position <span class="operator">=</span> <span class="string">&#x27;topleft&#x27;</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;SNP density&#x27;</span><span class="punctuation">,</span> legend_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> title_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#SNV 分布图例</span></span><br><span class="line">snv_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">  at <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">,</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27; SNP: A&gt;T|T&gt;A&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; SNP: A&gt;G|T&gt;C&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; SNP: A&gt;C|T&gt;G&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; SNP: G&gt;A|C&gt;T&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; SNP: G&gt;T|C&gt;A&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; SNP: G&gt;C|C&gt;G&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;synonymous SNV&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;nonsynonymous SNV&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;variant type\n&#x27;</span><span class="punctuation">,</span> title_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  grid_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> grid_width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;points&#x27;</span><span class="punctuation">,</span> background <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">  legend_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#BC80BD&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FDB462&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#80B1D3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FB8072&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#8DD3C7&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FFFFB3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  pch <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span> <span class="number">20</span><span class="punctuation">,</span> <span class="number">20</span><span class="punctuation">,</span> <span class="number">20</span><span class="punctuation">,</span> <span class="number">20</span><span class="punctuation">,</span> <span class="number">20</span><span class="punctuation">,</span> <span class="number">16</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#左侧统计总览（涵括了上文大部分的统计概况，例如 SNP 替换类型统计等）</span></span><br><span class="line">stat_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">  at <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span><span class="punctuation">,</span> labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> title_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">  grid_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> grid_width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;points&#x27;</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> background <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> </span><br><span class="line">  title <span class="operator">=</span> str_c<span class="punctuation">(</span><span class="string">&#x27;Sample: &#x27;</span><span class="punctuation">,</span> sample_name<span class="punctuation">,</span> <span class="string">&#x27;\nRefer species: &#x27;</span><span class="punctuation">,</span> ref_name<span class="punctuation">,</span> <span class="string">&#x27;\nRefer size: &#x27;</span><span class="punctuation">,</span> genome_size<span class="punctuation">,</span> <span class="string">&#x27; bp\n\n\nTotal SNP: &#x27;</span><span class="punctuation">,</span> snp_ti <span class="operator">+</span> snp_tv<span class="punctuation">,</span> <span class="string">&#x27;\nTransitions: &#x27;</span><span class="punctuation">,</span> snp_ti<span class="punctuation">,</span> <span class="string">&#x27;\nTransversions: &#x27;</span><span class="punctuation">,</span> snp_tv<span class="punctuation">,</span> <span class="string">&#x27;\nTi/Tv: &#x27;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span>snp_ti <span class="operator">/</span> snp_tv<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&#x27;\nA&gt;T|T&gt;A: &#x27;</span><span class="punctuation">,</span> snp_at<span class="punctuation">,</span> <span class="string">&#x27;\nA&gt;G|T&gt;C: &#x27;</span><span class="punctuation">,</span> snp_ag<span class="punctuation">,</span> <span class="string">&#x27;\nA&gt;C|T&gt;G: &#x27;</span><span class="punctuation">,</span> snp_ac<span class="punctuation">,</span> <span class="string">&#x27;\nG&gt;A|C&gt;T: &#x27;</span><span class="punctuation">,</span> snp_ga<span class="punctuation">,</span> <span class="string">&#x27;\nG&gt;T|C&gt;A: &#x27;</span><span class="punctuation">,</span> snp_gt<span class="punctuation">,</span> <span class="string">&#x27;\nG&gt;C|C&gt;G: &#x27;</span><span class="punctuation">,</span> snp_gc<span class="punctuation">,</span> <span class="string">&#x27;\n\n\nTotal InDel: &#x27;</span><span class="punctuation">,</span> indel_insert <span class="operator">+</span> indel_delet<span class="punctuation">,</span> <span class="string">&#x27;\nInsert: &#x27;</span><span class="punctuation">,</span> indel_insert<span class="punctuation">,</span> <span class="string">&#x27;\nDelet: &#x27;</span><span class="punctuation">,</span> indel_delet<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#图例存放位置</span></span><br><span class="line">y_coord <span class="operator">&lt;-</span> 1.01</span><br><span class="line">x_coord <span class="operator">&lt;-</span> 0.275</span><br><span class="line"></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> x_coord<span class="operator">+</span><span class="number">0.05</span><span class="punctuation">,</span> y <span class="operator">=</span> y_coord<span class="operator">-</span><span class="number">0.208</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>stat_legend<span class="punctuation">)</span></span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> x_coord<span class="operator">-</span><span class="number">0.0005</span> <span class="punctuation">,</span> y <span class="operator">=</span> y_coord<span class="operator">-</span><span class="number">0.165</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>depth_legend<span class="punctuation">)</span></span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> x_coord<span class="operator">-</span><span class="number">0.005</span> <span class="punctuation">,</span> y <span class="operator">=</span> y_coord<span class="operator">-</span><span class="number">0.197</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>gene_legend<span class="punctuation">)</span></span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> x_coord<span class="operator">-</span><span class="number">0.0097</span> <span class="punctuation">,</span> y <span class="operator">=</span> y_coord<span class="operator">-</span><span class="number">0.25</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>snp_legend<span class="punctuation">)</span></span><br><span class="line">y_coord <span class="operator">&lt;-</span> y_coord</span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> x_coord<span class="operator">-</span><span class="number">0.0097</span> <span class="punctuation">,</span> y <span class="operator">=</span> y_coord<span class="operator">-</span><span class="number">0.3</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>indel_legend<span class="punctuation">)</span></span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>snv_legend<span class="punctuation">)</span></span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">circos.clear<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span><span class="comment">#保存</span></span><br></pre></td></tr></table></figure><p>运行结果如图所示，由外向内依次是：</p><ul><li>左上方图例和统计信息</li><li>基因组</li><li>染色体</li><li>测序深度与覆盖度</li><li>编码区和<a href="https://www.zhihu.com/search?q=%E9%9D%9E%E7%BC%96%E7%A0%81%E5%8C%BA&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">非编码区</a></li><li>SNV和InDel密度</li><li>SNV分布</li><li>SNV类型</li></ul><p><img src="https://pic1.zhimg.com/v2-015b406c0f4b81f31bfd5c180b32798c_b.jpg" alt="img"></p><p>全基因组测序圈图</p><p><img src="https://pic4.zhimg.com/v2-bae7e95a80a91430a351d587f163290f_b.jpg" alt="img"></p><p>全基因组测序圈图参数</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;转自&lt;a href=&quot;https://zhuanlan.zhihu.com/p/380684876&quot;&gt;Die Linke&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;MyNotes：&lt;/p&gt;
&lt;p&gt;总体概括为：全外显子测序的标准分析流程通常包括以下步骤：&lt;/p&gt;
&lt;p&gt;</summary>
      
    
    
    
    
    <category term="BioInfo" scheme="http://nikolahuang.github.io/tags/BioInfo/"/>
    
  </entry>
  
  <entry>
    <title>WES数据分析流程(上)</title>
    <link href="http://nikolahuang.github.io/2024/03/17/WES%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B-%E4%B8%8A/"/>
    <id>http://nikolahuang.github.io/2024/03/17/WES%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B-%E4%B8%8A/</id>
    <published>2024-03-17T05:09:57.000Z</published>
    <updated>2024-04-05T16:52:25.458Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><p>来源：<a href="https://www.zhihu.com/people/ma-pan-13-72">多啦A梦詹</a>；<a href="https://www.zhihu.com/question/432826287/answer/3080622038">菩年</a>;<a href="https://zhuanlan.zhihu.com/p/380684876">Die Linke</a></p><hr><ol><li>WES，WGS和WGRS的区别和联系是什么？</li></ol><ul><li><strong>WES (whole exome sequencing, <a href="https://www.zhihu.com/search?q=%E5%85%A8%E5%A4%96%E6%98%BE%E5%AD%90%E7%BB%84%E6%B5%8B%E5%BA%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">全外显子组测序</a>)</strong>: 是指利用序列捕获技术将【全基因组的外显子区域DNA】捕获富集后进行高通量测序，能够直接发现与蛋白质功能变异相关的遗传变异SNP(单核苷酸多态性)。以<a href="https://www.zhihu.com/search?q=%E4%BA%BA%E7%B1%BB%E5%9F%BA%E5%9B%A0%E7%BB%84&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">人类基因组</a>为例，虽然外显子(蛋白质编码区)只占基因组的1%，但人类基因组85%的致病突变都在外显子区域，因此具有重要意义。</li><li><strong>WGS (whole genome sequencing, 全基因组测序)</strong>: 是指对基因组整体进行<a href="https://www.zhihu.com/search?q=%E9%AB%98%E9%80%9A%E9%87%8F%E6%B5%8B%E5%BA%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">高通量测序</a>，分析不同个体间的差异，同时完成SNP及基因组结构注释。</li><li><strong>WGRS (whole genome re-sequencing, <a href="https://www.zhihu.com/search?q=%E5%85%A8%E5%9F%BA%E5%9B%A0%E7%BB%84%E9%87%8D%E6%B5%8B%E5%BA%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">全基因组重测序</a>)</strong>: 是指对已知参考基因组和注释的物种进行不同个体间的全基因组测序(WGS)<strong>，</strong>并在此基础上对个体或群体进行<a href="https://www.zhihu.com/search?q=%E5%B7%AE%E5%BC%82%E6%80%A7%E5%88%86%E6%9E%90&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">差异性分析</a>，鉴定出与某类表型相关的SNP.</li></ul><p>通过比较可以发现，这三个测序技术<strong>其实都是在找基因组上的SNP(<a href="https://www.zhihu.com/search?q=%E5%8D%95%E6%A0%B8%E8%8B%B7%E9%85%B8%E5%A4%9A%E6%80%81%E6%80%A7&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">单核苷酸多态性</a>)</strong>, SNP分为四种：</p><ol><li>SNV(单核苷酸变异)</li><li>InDel(插入缺失)</li><li>SV(结构变异)</li><li>CNV(<a href="https://www.zhihu.com/search?q=%E6%8B%B7%E8%B4%9D%E6%95%B0%E5%8F%98%E5%BC%82&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">拷贝数变异</a>)</li></ol><p>只是这三个技术的<strong>覆盖程度不同</strong>：</p><ul><li>WES：覆盖全基因组上的外显子区域</li><li>WGS：覆盖全基因组</li><li>WGRS：覆盖全基因组，是WGS在不同样本上的重复</li></ul><p>只要你掌握了其中一种的<a href="https://www.zhihu.com/search?q=%E6%B5%8B%E5%BA%8F%E5%88%86%E6%9E%90&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%22380684876%22%7D">测序分析</a>与可视化，剩下的两种其实是一样的，本文就以WES测序分析与可视化为例（原因是手头只有RNA-Seq的转录组数据，勉强可以用来做WES数据的替代品吧），进行WES&#x2F;WGS&#x2F;WGRS的分析教学。</p><p>外显子是基因组中能够转录组出成熟RNA的部分。一个基因组中所有外显子的集合，即为<a href="https://www.zhihu.com/search?q=%E5%A4%96%E6%98%BE%E5%AD%90%E7%BB%84&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:%223080622038%22%7D">外显子组</a>。值得注意的是，通常所说的全外显子组测序，是指针对蛋白编码基因的外显子，很少涉及非编码基因。</p><p>基因(gene)是DNA中含有特定遗传信息的一段<a href="https://www.zhihu.com/search?q=%E6%A0%B8%E8%8B%B7%E9%85%B8%E5%BA%8F%E5%88%97&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:%223080622038%22%7D">核苷酸序列</a>的总称，是具有遗传效应的DNA分子片段,是控制生物性状的基本遗传单位。人类基因区间的大小可从数百个bp至超过200万个bp不等。根据<a href="https://www.zhihu.com/search?q=%E4%BA%BA%E7%B1%BB%E5%9F%BA%E5%9B%A0%E7%BB%84%E8%AE%A1%E5%88%92&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:%223080622038%22%7D">人类基因组计划</a>(The Human Genome Project)估计，人类拥有20000-25000个蛋白编码基因。</p><p>基因组(genome)指一个生物体所包含DNA的全部遗传信息。基因组由基因区域和非编码区域组成。**人类的基因组大小约为30亿个碱基对(bp)(3GB)**，其中非编码区域占到绝大多数，编码蛋白质的区域仅占约2%左右。</p><p>外显子组(exome)是基因组中所有外显子的集合。人类拥有约18万个外显子，约占人类基因组的1%，即<strong>约3000万个bp(30MB)。</strong></p><p><img src="https://pica.zhimg.com/80/v2-0aa2c0929b7fc072f415fb3e52f9321a_1440w.webp" alt="img"></p><p>图：蛋白编码基因由内含子(非编码序列)和外显子(包括编码序列以及UTR区域)组成。要翻译有功能的蛋白，要进行以下步骤：基因从DNA转录为RNA前体，通过剪接形成成熟RNA，成熟RNA序列翻译成氨基酸链，以及蛋白质分子的翻译后修饰。</p><p>关于外显子，需要注意的一个特殊情况是非翻译区(UTR)。在mRNA的两侧分别存在5’UTR(前导序列)和3’UTR(尾部序列)，它们的作用分别是调控翻译的启动和终止。它们由外显子序列构成，但不会被翻译成氨基酸。 所以，并非所有外显子序列都会被翻译成氨基酸。</p><p><img src="https://pica.zhimg.com/80/v2-d72f78f1b03486e21ddc1bc10ccb5d68_1440w.webp" alt="img"></p><p>图：信使RNA前体(pre-mRNA)中的外显子。外显子既包括编码氨基酸的序列(红色)，也包括不被翻译的序列(灰色)。</p><p>对外显子组(基因组里的所有外显子)进行测序的方法，即为 全外显子组测序 (Whole-Exome Sequencing，WES)，也称为 外显子组测序、全<a href="https://www.zhihu.com/search?q=%E5%A4%96%E6%98%BE%E5%AD%90%E6%B5%8B%E5%BA%8F&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:%223080622038%22%7D">外显子测序</a>，全外测序 等。</p><p>全基因组测序(Whole-Genome Sequencing, WGS)是对整个基因组进行测序。靶向测序(Targeted-sequencing，也称Panel sequencing)是对选定的基因进行测序，通常有几十个至一千个基因不等。因而，从覆盖基因组的范围来说，全基因组测序&gt;全外显子组测序&gt;靶向测序。</p><p>全外测序可以视作一种特殊的靶向测序——它靶向的区域是基因组上的所有外显子。</p><p><img src="https://pic1.zhimg.com/80/v2-29a4d2c84fbc1e7621f1239b79b8f1ea_1440w.webp" alt="img"></p><p>panel测序有两种技术原理：杂交捕获测序和多重扩增子测序。全外是基于序列杂交原理实现的</p><p>需要特别说明的是对CNV的检测。使用全外检测CNV时，在杂交捕获过程中，由于各个外显子的杂交效率不同，故不同外显子的覆盖率差异会较大。当出现阳性结果时，无法判断是由于杂交未捕获到，还是由于缺失。 故使用全外检测CNV容易出现假阳性结果。一般情况下，全外测序不用于CNV的检测 ，但在癌症研究中，利用癌组织和癌旁组织对照，可以检测体细胞CNV。</p><p>人类全外显子组所占基因组比例不超过2%，但它包含了约85%与疾病相关的变异，因此在研究编码基因变异层面，全外测序是比全基因组测序更为经济高效的替代方法。全外测序适用于<a href="https://www.zhihu.com/search?q=%E5%AD%9F%E5%BE%B7%E5%B0%94&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:%223080622038%22%7D">孟德尔</a>疾病、肿瘤、复杂疾病等多个研究领域。对于表现出异质性的疾病，或者患者表现出多个系统受累的复杂疾病症状时，尤为适合使用全外测序。</p><p>例如在肿瘤临床检测中，寻求肺癌靶向治疗的患者通常会先做panel测序，因为与肺癌靶向治疗相关的基因是比较明确的，几十至一百多个基因的panel测序通常就可以满足需求。而对于寻求免疫治疗的患者，通常会使用全外或大panel测序，来评估肿瘤突变负荷(Tumor Mutational Burden, TMB)，TMB高的患者通常对免疫治疗有更好的响应。全外测序是业内公认的评估TMB的金标准。</p><p>*<strong>WES检测流程*</strong></p><p>一个WES测序的工作流程，大体可以分为这3个部分：文库制备，测序，生信分析。</p><p>文库制备通常包含这些步骤：样本处理，DNA提取，定量，建库，杂交捕获，扩增，质控。</p><p>测序，目前的仪器包括国外Illumina公司测序平台，以及<a href="https://www.zhihu.com/search?q=%E5%8D%8E%E5%A4%A7%E6%99%BA%E9%80%A0&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:%223080622038%22%7D">华大智造</a>国产测序平台等。</p><p>生信分析的流程通常包含这些步骤：质控，拼接比对，去重和重排，变异检测，降噪和过滤，注释等。常用的软件有FastQC，BWA，GATK，ANNOVAR等。</p><p>一个完整的全外显子组测序，从样本处理到完成数据分析，通常需要10天左右时间。</p><p><em><strong>捕获探针性能的评估指标</strong></em></p><p>市面上的厂商会提供现成的全外探针，我们可以根据自己的需要来选择，也可以定制更为符合自己需要的“全外+”探针。</p><p>如果选择现成的探针产品，除了关注下面的探针评价指标外，也需要考虑探针大小、探针长度、探针设计等是否符合我们的样品和研究需求。</p><p>如果选择定制的产品，则可以在现成的探针产品上加入自己感兴趣的区域，也可以完全自主设计。在设计探针时常用的参考数据库有RefSeq、CCDS、Ensembl、GENCODE和ClinVar等。除了设计捕获区域外，还可以要求对某些特别的区域增加探针密度以提高捕获效率。</p><p><strong>中靶率</strong></p><p>中靶率(On-target rate)是一个百分数，用来表示测序数据中有多少能够比对到目标区域上。</p><p>在基因组上有许多与外显子有同源性的部分(比如内含子和<a href="https://www.zhihu.com/search?q=%E5%9F%BA%E5%9B%A0%E9%97%B4%E5%8C%BA&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:%223080622038%22%7D">基因间区</a>)，在实际工作中，这些并不属于目标(外显子)的部分在杂交过程中也会被捕获下来。这种探针捕获到非目标区域片段的情况称为脱靶(off target)。脱靶的数据是无效的，不能用于后续分析，即这部分测序数据被浪费了。</p><p>同等情况下，中靶率越高，由于脱靶产生的浪费越少，这款探针越好。</p><p><strong>覆盖度</strong></p><p>覆盖度(coverage)经常是和深度一起出现的，比如“10X覆盖度”、“30X覆盖度”。比如，“10X覆盖度为90%”指测序数据比对到目标区域后，有90%的区域被覆盖了至少10次，或者说有90%的区域有至少10条reads覆盖。</p><p>如果覆盖度没有和深度一起出现，则可以理解为“1X覆盖度”。比如“覆盖度为95%”，指95%的目标区域有至少1条reads覆盖到。换言之，有5%的目标区域连1条覆盖到的reads都没有，它们在这次测序中完全没被测到，被漏掉了。</p><p>同等情况下，覆盖度越高，越少比例的目标区域被漏掉，这款探针越好。</p><p><strong>均一性</strong></p><p>目标区域内不同的位点被覆盖的情况是不同的。比如一次WES测序的平均深度是60X，很有可能有的位点深度为10X，有的为40X，有的为90X这样的情况。均一性(uniformity)越好，即这些位点各自的深度越接近平均深度。</p><p>在实际工作中，我们根据期望达到的目标测序深度来分配数据量，即决定了这次测序的平均深度(平均深度&#x3D;数据量&#x2F;探针大小)。当某个区域的实际测序深度高于目标深度时，造成数据的浪费;而当某个区域的实际测序深度低于目标深度时，我们可能会认为这部分数据质量不好而丢弃它，导致这一区域无测序数据。均一性优良的探针可以帮助减少这两种情况的发生。</p><p>Fold-80是用来评价均一性的指标。它的定义是，为确保80%的目标碱基达到平均深度所需的额外测序的倍数。Fold-80越低，捕获效率越高，测序浪费越少。理想情况下的Fold-80为1。</p><p>Fold-80越低，均一性越好，越能节约测序成本，这款探针越好。</p><p><strong>重复率</strong></p><p>重复率(Dup rate)指的是<a href="https://www.zhihu.com/search?q=%E9%87%8D%E5%A4%8D%E5%BA%8F%E5%88%97&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:%223080622038%22%7D">重复序列</a>(Duplicate reads)在总测序序列中的占比。由于这些重复序列不能带来额外信息，相反会影响变异检测结果准确性，因此需要在下游生信分析中去除这些重复序列。Dup rate越高，数据利用率越低，浪费的测序成本也就越多。</p><p>同等情况下，重复率越低，越能节省测序成本，这款探针越好</p><p><strong>WES对于涉及<a href="https://www.zhihu.com/search?q=%E6%8B%B7%E8%B4%9D%E6%95%B0%E5%8F%98%E5%BC%82&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:%223080622038%22%7D">拷贝数变异</a>、非编码区变异和结构变异的疾病研究不适用。其次，在对目标区域进行捕获时, 存在捕获不均、捕获偏差等现象, 可以通过增加测序深度, 获得更多的序列信息进行统计分析, 以尽可能弥补这些偏差。</strong></p><p>首先创建一个项目目录wes和存放每个步骤生成文件的子目录raw, clean, align, genome, hg19_VCF</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir &#123;raw,clean,align,genome,hg19_VCF&#125;</span><br></pre></td></tr></table></figure><p>此流程包含两个raw外显子测序文件：wes.1.fq.gz，wes.2.fq.gz；存放于raw目录</p><h3 id="原始数据质控，用fastp"><a href="#原始数据质控，用fastp" class="headerlink" title="原始数据质控，用fastp"></a>原始数据质控，用fastp</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 项目主目录下运行，在clean目录下生成两个过滤的fq文件</span><br><span class="line">nohup fastp -i raw/wes.1.fq.gz -o clean/wes.1.clean.fq.gz -I raw/wes.2.fq.gz -O clean/wes.2.clean.fq.gz &amp;</span><br></pre></td></tr></table></figure><h3 id="下载参考基因组（hg19）文件，存放于genome目录，并建立索引："><a href="#下载参考基因组（hg19）文件，存放于genome目录，并建立索引：" class="headerlink" title="下载参考基因组（hg19）文件，存放于genome目录，并建立索引："></a>下载参考基因组（hg19）文件，存放于genome目录，并建立索引：</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">for i in $(seq 1 22) X Y M;</span><br><span class="line">do </span><br><span class="line">nohup wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/chromosomes/chr$&#123;i&#125;.fa.gz &amp; </span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for i in $(seq 1 22) X Y M;</span><br><span class="line">do cat chr$&#123;i&#125;.fa &gt;&gt; hg19.fa;</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nohup bwa index -a bwtsw -p hg19 hg19.fa  &amp;</span><br></pre></td></tr></table></figure><h3 id="比对"><a href="#比对" class="headerlink" title="比对"></a>比对</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># clean目录下运行此命令，在align目录下生成sam文件</span><br><span class="line">nohup bwa mem -t 4 -M -R &quot;@RG\tID:lane1\tPL:illumina\tLB:library\tSM:wes&quot; ../genome/hg19  wes.1.clean.fq.gz  wes.2.clean.fq.gz &gt;../align/wes.sam 2&gt;wes.bwa.align.log &amp;</span><br><span class="line">-t，线程数；</span><br><span class="line">  -M , -M 将 shorter split hits 标记为次优，以兼容 Picard markDuplicates 软件;</span><br><span class="line">  -R 接的是 Read Group的字符串信息，它是用来将比对的read进行分组的，这个信息对于我们后续对比对数据进行错误率分析和Mark duplicate时非常重要。</span><br><span class="line">  (1) ID，这是Read Group的分组ID，一般设置为测序的lane ID</span><br><span class="line">  (2) PL，指的是所用的测序平台</span><br><span class="line">  (3) SM，样本ID</span><br><span class="line">  (4) LB，测序文库的名字</span><br><span class="line">这些信息设置好之后，在RG字符串中要用制表符（\t）将它们分开</span><br><span class="line">samtools view -b -S wes.sam &gt; wes.bam  #sam2bam,便于存储</span><br><span class="line">samtools sort wes.bam -o wes.sorted.bam    #有顺序的排序，便于后面的操作</span><br><span class="line">samtools flagstat wes.sorted.bam &gt; wes.sorted.bam.flagstat    #统计比对信息</span><br><span class="line">1. QC pass的reads的数量为5002344 ，未通过QC的reads数量为0，意味着一共有5002344条reads；</span><br><span class="line">2.标记为secondary的read</span><br><span class="line">3. 嵌合体reads</span><br><span class="line">4.PCR 重复引起的reads</span><br><span class="line">5.  比对到参考基因组上的reads数量；</span><br><span class="line">6.  paired reads数据数量；</span><br><span class="line">7.  read1的数量；</span><br><span class="line">8.  read2 的数量；</span><br><span class="line">9.  正确地匹配到参考序列的reads数量；</span><br><span class="line">10.  一对reads都比对到了参考序列上的数量，但是并不一定比对到同一条染色体上；</span><br><span class="line">11. 一对reads中只有一条与参考序列相匹配的数量； </span><br><span class="line">12.  一对reads比对到不同染色体的数量；</span><br><span class="line">13.  一对reads比对到不同染色体的且比对质量值大于5的数量。</span><br></pre></td></tr></table></figure><h3 id="外显子区域覆盖度"><a href="#外显子区域覆盖度" class="headerlink" title="外显子区域覆盖度"></a>外显子区域覆盖度</h3><p>需要生成外显子interval文件，生成这个文件的前提又需要dict文件和外显子bed文件（此处用的是安捷伦外显子bed文件，也可以去UCSC下载）。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gatk CreateSequenceDictionary -R hg19.fa -O hg19.dict</span><br><span class="line">gatk BedToIntervalList -I S31285117_Regions.bed -O Exon.Interval.bed -SD ./genome/hg19.dict</span><br><span class="line">gatk CollectHsMetrics -BI Exon.Interval.bed -TI Exon.Interval.bed -I wes.sorted.bam -O wes.stat.txt</span><br></pre></td></tr></table></figure><h3 id="标记PCR重复序列并建立索引"><a href="#标记PCR重复序列并建立索引" class="headerlink" title="标记PCR重复序列并建立索引"></a>标记PCR重复序列并建立索引</h3><p>以前用picard标记重复序列，现在这个工具全部整合到gatk中了</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nohup gatk --java-options &quot;-Xmx10G -Djava.io.tmpdir=./&quot; MarkDuplicates -I wes.sorted.bam -O wes.sorted.MarkDuplicates.bam -M wes.sorted.bam.metrics &gt; log.mark 2&gt;&amp;1 &amp;</span><br><span class="line">samtools view -f 1024 wes.sorted.MarkDuplicates.bam | less</span><br><span class="line">samtools index wes.sorted.MarkDuplicates.bam</span><br></pre></td></tr></table></figure><p>wes.sorted.bam.metrics有统计信息 wes.sorted.MarkDuplicates.bam创建索引文件，他的作用能够让我们可以随机访问这个文件中的任意位置，而且后面的步骤也要求这个bam文件一定要有索引。</p><h3 id="变异检测"><a href="#变异检测" class="headerlink" title="变异检测"></a>变异检测</h3><h3 id="重新校正碱基质量值（BQSR）"><a href="#重新校正碱基质量值（BQSR）" class="headerlink" title="重新校正碱基质量值（BQSR）"></a>重新校正碱基质量值（BQSR）</h3><p><strong>变异检测是一个极度依赖测序碱基质量值，因为这个质量值是衡量我们测序出来的这个碱基到底有多正确的重要指标</strong>。它来自于测序图像数据的base calling，因此，基本上是由测序仪和测序系统来决定的，计算出来的碱基质量值未必与真实结果统一。 BQSR（Base Quality Score Recalibration）这个步骤主要是通过机器学习的方法构建测序碱基的错误率模型，然后对这些碱基的质量值进行相应的调整。 这里包含了两个步骤： 第一步，BaseRecalibrator，这里计算出了所有需要进行重校正的read和特征值，然后把这些信息输出为一份校准表文件（wes.recal_data.table） 第二步，ApplyBQSR，这一步利用第一步得到的校准表文件（wes.recal_data.table）重新调整原来BAM文件中的碱基质量值，并使用这个新的质量值重新输出一份新的BAM文件。</p><h3 id="首先下载变异注释文件"><a href="#首先下载变异注释文件" class="headerlink" title="首先下载变异注释文件"></a>首先下载变异注释文件</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">wget  -c -r -nd -np -k -L -p ftp://gsapubftp-anonymous@ftp.broadinstitute.org/bundle/hg19</span><br><span class="line">下载文件均为压缩文件，需要解压才能使用</span><br><span class="line">samtools faidx hg19.fa</span><br><span class="line">GENOME=./genome/hg19.fa</span><br><span class="line">hg19_VCF=./hg19_VCF/</span><br><span class="line">gatk --java-options &quot;-Xmx10G -Djava.io.tmpdir=./&quot; BaseRecalibrator \</span><br><span class="line">-R $GENOME -I ./align/wes.sorted.MarkDuplicates.bam \</span><br><span class="line">--known-sites $hg19_VCF/1000G_phase1.indels.hg19.sites.vcf \</span><br><span class="line">--known-sites $hg19_VCF/Mills_and_1000G_gold_standard.indels.hg19.sites.vcf \</span><br><span class="line">--known-sites $hg19_VCF/dbsnp_138.hg19.vcf \</span><br><span class="line">-L S31285117_Regions.bed -O wes.recal_data.table</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gatk --java-options &quot;-Xmx10G -Djava.io.tmpdir=./&quot; ApplyBQSR \</span><br><span class="line">-R $GENOME -I ./align/wes.sorted.MarkDuplicates.bam \</span><br><span class="line">-bqsr wes.recal_data.table -L S31285117_Regions.bed  \</span><br><span class="line">-O wes.sorted.MarkDuplicates.BQSR.bam</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># gatk AnalyzeCovariates -bqsr wes.recal_data.table -plots wes.recal_data.table.plot</span><br></pre></td></tr></table></figure><h3 id="变异检测-1"><a href="#变异检测-1" class="headerlink" title="变异检测"></a>变异检测</h3><p>HaplotypeCaller的应用有两种做法，差别只在于要不要在中间生成一个gVCF： （1）直接进行HaplotypeCaller，这适合于单样本，或者那种固定样本数量的情况，也就是只执行一次HaplotypeCaller。如果增加一个样本就得重新运行这个HaplotypeCaller，而这个时候算法需要重新去读取所有人的BAM文件，浪费大量时间； （2）每个样本先各自生成gVCF，然后再进行群体joint-genotype。gVCF全称是genome VCF，是每个样本用于变异检测的中间文件，格式类似于VCF，它把joint-genotype过程中所需的所有信息都记录在这里面，文件无论是大小还是数据量都远远小于原来的BAM文件。这样一旦新增加样本也不需要再重新去读取所有人的BAM文件了，只需为新样本生成一份gVCF，然后重新执行这个joint-genotype就行了。</p><p>推荐使用第二种，<strong>变异检测不是一个样本的事情，有越多的同类样本放在一起joint calling结果将会越准确，而如果样本足够多的话，在低测序深度的情况下也同样可以获得完整并且准确的结果。</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">第一种方法</span><br><span class="line">gatk --java-options &quot;-Xmx8G -Djava.io.tmpdir=./&quot; HaplotypeCaller \</span><br><span class="line">-R $GENOME -I wes.sorted.MarkDuplicates.BQSR.bam \</span><br><span class="line">-D $hg19_VCF/dbsnp_138.hg19.vcf -L S31285117_Regions.bed \</span><br><span class="line">-O wes.raw1.vcf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">第二种方法</span><br><span class="line"># 1.生成中间文件gvcf</span><br><span class="line">gatk --java-options &quot;-Xmx8G -Djava.io.tmpdir=./&quot; HaplotypeCaller -R $GENOME \</span><br><span class="line">--emit-ref-confidence GVCF -I wes.sorted.MarkDuplicates.BQSR.bam \</span><br><span class="line">-D $hg19_VCF/dbsnp_138.hg19.vcf -L S31285117_Regions.bed  -O wes.gvcf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 2.通过gvcf检测变异</span><br><span class="line">gatk --java-options &quot;-Xmx8G -Djava.io.tmpdir=./&quot; GenotypeGVCFs \</span><br><span class="line">-R $GENOME -V wes.gvcf -L S31285117_Regions.bed  \</span><br><span class="line">-O wes.raw.vcf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">若有多个样本的gvcf文件，运行gatk CombineGVCFs  \</span><br><span class="line">-V 1.gvcf –V 2.gvcf ……  -O final.gvcf ，再用final.gvcf运行第二步</span><br></pre></td></tr></table></figure><h3 id="变异质控与过滤"><a href="#变异质控与过滤" class="headerlink" title="变异质控与过滤"></a>变异质控与过滤</h3><p><strong>质控的含义和目的是指通过一定的标准，最大可能地剔除假阳性的结果，并尽可能地保留最多的正确数据。 第一种方法 GATK VQSR</strong>，它通过机器学习的方法利用多个不同的数据特征训练一个模型（高斯混合模型）对变异数据进行质控，使用VQSR需要具备以下两个条件： 第一，需要一个精心准备的已知变异集，它将作为训练质控模型的真集。比如，Hapmap、OMNI，1000G和dbsnp等这些国际性项目的数据，这些可以作为高质量的已知变异集。 第二，要求新检测的结果中有足够多的变异，不然VQSR在进行模型训练的时候会因为可用的变异位点数目不足而无法进行。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">gatk --java-options &quot;-Xmx8G -Djava.io.tmpdir=./&quot; VariantRecalibrator -R $GENOME -V wes.raw.vcf \</span><br><span class="line">-resource hapmap,known=false,training=true,truth=true,prior=15.0:$hg19_VCF/hapmap_3.3.hg19.sites.vcf \</span><br><span class="line">-resource omini,known=false,training=true,truth=false,prior=12.0:$hg19_VCF/1000G_omni2.5.hg19.sites.vcf \ </span><br><span class="line">-resource 1000G,known=false,training=true,truth=false,prior=10.0:$hg19_VCF/1000G_phase1.snps.high_confidence.hg19.sites.vcf \</span><br><span class="line">-resource dbsnp,known=true,training=false,truth=false,prior=6.0:$hg19_VCF/dbsnp_138.hg19.vcf \</span><br><span class="line">-an QD -an MQ -an MQRankSum -an ReadPosRankSum -an FS -an SOR -an DP -mode SNP \</span><br><span class="line">-O wes.snps.recal.vcf --tranches-file wes.snps.tranches --rscript-file wes.snps.plots.R &amp; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">gatk  ApplyRecalibration  -V wes.raw.vcf -O wes.VQSR.vcf --recal-file wes.snps.recal.vcf  \</span><br><span class="line">--tranches-file wes.snps.tranches  -mode SNP</span><br></pre></td></tr></table></figure><p>此方法要求新检测的结果中有足够多的变异，不然VQSR在进行模型训练的时候会因为可用的变异位点数目不足而无法进行。可能很多非人的物种在完成变异检测之后没法使用GATK VQSR的方法进行质控，一些小panel、外显子测序，由于最后的变异位点不够，也无法使用VQSR。全基因组分析或多个样本的全外显子组分析适合用此方法。</p><p><strong>第二种方法通过过滤指标过滤。</strong> QualByDepth（QD）：QD是变异质量值（Quality）除以覆盖深度（Depth）得到的比值。 FisherStrand (FS)：FS是一个通过Fisher检验的p-value转换而来的值，它要描述的是测序或者比对时对于只含有变异的read以及只含有参考序列碱基的read是否存在着明显的正负链特异性（Strand bias，或者说是差异性） StrandOddsRatio (SOR)：对链特异（Strand bias）的一种描述. RMSMappingQuality (MQ)：MQ这个值是所有比对至该位点上的read的比对质量值的均方根. MappingQualityRankSumTest (MQRankSum) ReadPosRankSumTest (ReadPosRankSum) <strong>通过过滤指标过滤</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">使用SelectVariants，选出SNP</span><br><span class="line">gatk SelectVariants -select-type SNP -V wes.raw.vcf -O wes.snp.vcf</span><br><span class="line"># 为SNP作过滤</span><br><span class="line">gatk VariantFiltration -V wes.snp.vcf --filter-expression &quot;QD &lt; 2.0 || MQ &lt; 40.0 || FS &gt; 60.0 || SOR &gt; 3.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&quot; --filter-name &quot;PASS&quot; -O wes.snp.filter.vcf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用SelectVariants，选出Indel</span><br><span class="line">gatk SelectVariants -select-type INDEL -V wes.raw.vcf -O wes.indel.vcf</span><br><span class="line"># 为Indel作过滤</span><br><span class="line">gatk VariantFiltration -V wes.indel.vcf --filter-expression &quot;QD &lt; 2.0 || FS &gt; 200.0 || SOR &gt; 10.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&quot; --filter-name &quot;PASS&quot; -O wes.indel.filter.vcf</span><br></pre></td></tr></table></figure><h3 id="突变注释"><a href="#突变注释" class="headerlink" title="突变注释"></a>突变注释</h3><p>ANNOVAR是一个perl编写的命令行工具，能在安装了perl解释器的多种操作系统上执行。允许多种输入文件格式，包括最常被使用的VCF格式。输出文件也有多种格式，包括注释过的VCF文件、用tab或者逗号分隔的txt文件，ANNOVAR能快速注释遗传变异并预测其功能。这个软件需要edu邮箱注册才能下载。 ANNOVAR website</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">数据库下载</span><br><span class="line">perl annotate_variation.pl -buildver hg19 -downdb -webfrom annovar refGene humandb/</span><br><span class="line"> # -buildver 表示version </span><br><span class="line"> # -downdb 下载数据库的指令</span><br><span class="line"> # -webfrom annovar 从annovar提供的镜像下载，不加此参数将寻找数据库本身的源</span><br><span class="line"> # humandb/ 存放于humandb/目录下</span><br><span class="line">其它数据库下载</span><br><span class="line">perl annotate_variation.pl --buildver hg19 --downdb gwascatalog humandb/ &amp;</span><br><span class="line">perl annotate_variation.pl --buildver hg19 --downdb ljb26_all --webfrom annovar humandb/ &amp;</span><br><span class="line">perl annotate_variation.pl --buildver hg19 --downdb esp6500siv2_ea --webfrom annovar humandb/ &amp;</span><br><span class="line">perl annotate_variation.pl --buildver hg19 --downdb esp6500siv2_all --webfrom annovar humandb/ &amp;</span><br><span class="line">perl annotate_variation.pl --buildver hg19 --downdb 1000g2014oct humandb/ &amp;</span><br><span class="line">perl annotate_variation.pl --buildver hg19 --downdb cytoBand humandb/ &amp;</span><br><span class="line">perl annotate_variation.pl --buildver hg19 --downdb avsift -webfrom annovar humandb/ &amp;</span><br><span class="line">perl annotate_variation.pl --buildver hg19 --downdb snp138 humandb/ &amp;</span><br><span class="line">perl annotate_variation.pl --buildver hg19 --downdb genomicSuperDups humandb/ &amp;</span><br><span class="line">perl annotate_variation.pl --buildver hg19 --downdb phastConsElements46way humandb/ &amp;</span><br><span class="line">perl annotate_variation.pl --buildver hg19 --downdb tfbs humandb/</span><br></pre></td></tr></table></figure><h3 id="三种注释方式"><a href="#三种注释方式" class="headerlink" title="三种注释方式"></a>三种注释方式</h3><p>**Gene-based Annotation(基于基因的注释)**：基于基因的注释（gene-based annotation）揭示variant与已知基因直接的关系以及对其产生的功能性影响。 <strong>Region-based Annotation（基于区域的注释）</strong>：基于过滤的注释精确匹配查询变异与数据库中的记录：如果它们有相同的染色体，起始位置，结束位置，REF的等位基因和ALT的等位基因，才能认为匹配。基于区域的注释看起来更像一个区域的查询（这个区域也可以是一个单一的位点），在一个数据库中，它不在乎位置的精确匹配，它不在乎核苷酸的识别。基于区域的注释（region-based annotation）揭示variant与不同基因组特定段的关系。 <strong>Filter-based Annotation（基于过滤的注释）</strong>：filter-based和region-based主要的区别是，filter-based针对mutation（核苷酸的变化）而region-based针对染色体上的位置。如在全基因组数据中的变异频率，可使用1000g2015aug、kaviar_20150923等数据库；在全外显组数据中的变异频率，可使用exac03、esp6500siv2等；在孤立的或者低代表人群中的变异频率，可使用ajews等数据库。 <strong>用table_annovar.pl进行注释，可一次性完成三种类型的注释。</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">convert2annovar.pl # 将多种格式转为.avinput的程序</span><br><span class="line">convert2annovar.pl -format vcf4   wes.snp.filter.vcf &gt;snp.avinput</span><br><span class="line">格式如下：</span><br><span class="line">chr1    69511   69511   A       G       hom     1736.03 53</span><br><span class="line">chr1    877831  877831  T       C       hom     85.10   4</span><br><span class="line">chr1    881627  881627  G       A       het     399.60  37</span><br><span class="line">chr1    887801  887801  A       G       hom     1623.03 39</span><br><span class="line">chr1    888639  888639  T       C       hom     3991.03 106</span><br><span class="line">chr1    888659  888659  T       C       hom     4114.03 109</span><br><span class="line">chr1    897325  897325  G       C       hom     3998.03 113</span><br><span class="line">chr1    898852  898852  C       T       het     647.60  38</span><br><span class="line">chr1    900505  900505  G       C       het     478.60  35</span><br><span class="line">chr1    906272  906272  A       C       het     540.60  30</span><br></pre></td></tr></table></figure><p>avinput文件由tab分割，最重要的地方为前5列，分别是: 1. 染色体(Chromosome) 2. 起始位置(Start) 3. 结束位置(End) 4. 参考等位基因(Reference Allele) 5. 替代等位基因(Alternative Allele) ANNOVAR主要也是利用前五列信息对数据库进行比对，注释变异。</p><h3 id="SNP注释："><a href="#SNP注释：" class="headerlink" title="SNP注释："></a>SNP注释：</h3><p><strong>用table_annovar.pl进行注释，可一次性完成三种类型的注释。</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">table_annovar.pl snp.avinput $humandb -buildver hg19 -out snpanno \</span><br><span class="line">-remove -protocol refGene,cytoBand,genomicSuperDups,esp6500siv2_all \</span><br><span class="line">-operation g,r,r,f -nastring . -csvout</span><br></pre></td></tr></table></figure><p>-buildver hg19 表示使用hg19版本 -out snpanno 表示输出文件的前缀为snpanno -remove 表示删除注释过程中的临时文件 -protocol 表示注释使用的数据库，用逗号隔开，且要注意顺序 -operation 表示对应顺序的数据库的类型（g代表gene-based、r代表region-based、f代表filter-based），用逗号隔开，注意顺序 -nastring . 表示用点号替代缺省的值 -csvout 表示最后输出.csv文件</p><h3 id="Indel注释同上"><a href="#Indel注释同上" class="headerlink" title="Indel注释同上"></a>Indel注释同上</h3><p>测试数据：链接：<a href="https://link.zhihu.com/?target=https://pan.baidu.com/s/16tX5GrCLBAov9k_GjYYOyA">https://pan.baidu.com/s/16tX5GrCLBAov9k_GjYYOyA</a> 提取码：9pab</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;来源：&lt;a href=&quot;https://www.zhihu.com/people/ma-pan-13-72&quot;&gt;多啦A梦詹&lt;/a&gt;；&lt;a href=&quot;https://www.zhihu.com/question/432826287/answer/30</summary>
      
    
    
    
    
    <category term="BioInfo" scheme="http://nikolahuang.github.io/tags/BioInfo/"/>
    
  </entry>
  
  <entry>
    <title>使用CRISPR/Cas9的人类B细胞基因组工程</title>
    <link href="http://nikolahuang.github.io/2024/03/16/%E4%BD%BF%E7%94%A8CRISPR-Cas9%E7%9A%84%E4%BA%BA%E7%B1%BBB%E7%BB%86%E8%83%9E%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%B7%A5%E7%A8%8B/"/>
    <id>http://nikolahuang.github.io/2024/03/16/%E4%BD%BF%E7%94%A8CRISPR-Cas9%E7%9A%84%E4%BA%BA%E7%B1%BBB%E7%BB%86%E8%83%9E%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%B7%A5%E7%A8%8B/</id>
    <published>2024-03-16T15:09:12.000Z</published>
    <updated>2024-04-05T16:53:32.356Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><p>First Published: November 3rd, 2020</p><p>DOI:<a href="https://dx.doi.org/10.3791/61855">10.3791&#x2F;61855</a></p><iframe src="//player.bilibili.com/player.html?aid=1101771635&bvid=BV14w4m1o7fh&cid=1472242106&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><hr><h2 id="MyNotes"><a href="#MyNotes" class="headerlink" title="MyNotes:"></a>MyNotes:</h2><p>本文作者的研究工作集中于运用CRISPR&#x2F;Cas9基因编辑技术在人类B细胞中进行基因敲除（KO）和敲入（KI）操作，以便深入研究B细胞中特定基因的功能，并将其应用于B细胞疗法的开发。这项研究创新性地优化了从<strong>外周血单核细胞</strong>（PBMCs）中分离、扩增B细胞的流程，同时改进了CRISPR&#x2F;Cas9系统的转染效率和安全性。</p><p>实验过程中，作者首先采用了一套高效且标准化的步骤分离并大量扩增B细胞，使其能在7天内增加44倍，这对于后续基因编辑的成功至关重要。然后，利用<strong>电穿孔技术</strong>将CRISPR&#x2F;Cas9 mRNA与针对CD19基因的sgRNA导入B细胞，以实现CD19基因的精准敲除。实验结果显示，这种方法成功诱导了预期的双链断裂（DSB），并通过非同源末端连接（NHEJ）机制引起了<strong>CD19基因</strong>的失活，其有效性通过流式细胞术和TIDE（Tracking of Indels by Decomposition）分析得到验证，结果显示CD19蛋白的表达显著减少。</p><p>此外，作者还展示了如何利用CRISPR&#x2F;Cas9与重组腺相关病毒（rAAV6）载体结合，将绿色荧光蛋白（EGFP）基因特异整合到AAVS1位点，实现了高效的基因敲入。实验结果显示，经过工程化的B细胞在12天后能稳定表达EGFP，并且通过PCR和流式细胞术证实了基因整合的发生。</p><p>尽管如此，研究也指出CRISPR&#x2F;Cas9技术存在潜在的脱靶效应和染色体易位风险，因此作者强调了优化实验条件的重要性，比如选择合适的sgRNA以降低脱靶效应，并探讨了使用碱基编辑器作为更为精确的基因编辑手段的可能性。</p><p>具体实验步骤流程概括可以如下：</p><ol><li><p><strong>B细胞分离与激活</strong>：</p><ul><li>从外周血单核细胞（PBMCs）中分离B细胞，通过密度梯度离心法和负选择试剂盒进行纯化。</li><li>对分离出的B细胞进行体外扩增，每两天更换新鲜的激活因子，并严格控制细胞密度。</li></ul></li><li><p><strong>CRISPR&#x2F;Cas9介导的基因敲除（KO）</strong>：</p><ul><li>设计并合成针对目标基因（如CD19）的sgRNA。</li><li>制备CRISPR&#x2F;Cas9-sgRNA复合物，通过电穿孔技术将复合物导入B细胞。</li><li>经过电穿孔后的细胞在特定时间内静置和恢复，随后进行细胞培养。</li><li>在转染后的第5天，使用流式细胞术检测CD19表达水平，并通过TIDE分析确定DNA双链断裂后引发的Indel形成。</li></ul></li><li><p><strong>基因敲入（KI）实验</strong>：</p><ul><li>使用重组腺相关病毒（rAAV6）载体携带目的基因（如EGFP）和同源臂。</li><li>将CRISPR&#x2F;Cas9系统与rAAV6载体一同导入B细胞，诱导同源定向修复（HDR）介导的敲入。</li><li>工程化后的第12天，通过流式细胞术和PCR分析评估EGFP基因是否成功整合及表达。</li></ul></li></ol><p>整个实验流程旨在通过精细调控B细胞的分离、激活和基因编辑过程，高效地实现对B细胞基因组的精准工程改造，进而研究基因功能及其在B细胞治疗中的应用潜力。同时，实验关注了优化细胞健康和基因编辑效率的关键步骤，以及对可能存在的脱靶效应和染色体易位等问题的考量。</p><hr><h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>在这里，我们为CRISPR&#x2F;Cas9基础基因组工程提供详细的分步协议，用于基因敲除（KO）和敲击（KI），以研究B细胞中基因的生物功能和B细胞治疗的开发。</p><h3 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h3><p>B细胞是从造血干细胞中提取的淋巴细胞，是适应性免疫系统幽默手臂的关键组成部分。他们之所以成为细胞疗法的候选者，是因为它们容易与周围血液隔离，体外扩张能力，以及体内寿命。此外，它们的正常生物功能——产生大量的抗体——可以用来表达大量的治疗性蛋白质，如抗感染的重组抗体，或用于治疗酶病变的酶。在这里，我们提供详细的方法，将原人类B细胞从外周血单核细胞（PBMCs）中分离，并在体外激活&#x2F;扩大分离的B细胞。然后，我们演示了使用CRISPR&#x2F;Cas9系统在B细胞中针对内源基因的部位特定KO所涉及的步骤。这种方法可以有效地利用各种基因的KO，用于研究感兴趣的基因的生物功能。然后，我们演示了使用CRISPR&#x2F;Cas9系统以及重组的、与腺相关的病毒（rAAV）载体的步骤，以有效实现B细胞中转基因表达盒的现场特定集成。该协议共同提供了一个分步工程平台，可用于人类B细胞的初级研究基因的生物功能以及B细胞治疗的开发。</p><hr><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>B细胞是来自造血干细胞的淋巴细胞系的子群。他们在适应性幽默免疫系统中发挥关键作用，产生大量的抗体来应对免疫挑战[1]。B细胞也是记忆B细胞和最终分化的长寿血浆细胞的前体，从而提供持久的幽默免疫力[2]。特别是等离子体细胞，在免疫细胞中独一无二，它们能够产生大量的特定抗体，同时存活多年或几十年。此外，从外周血液隔离的便利性使B细胞血统成为新细胞疗法[4]的极好候选者。</p><p>以前，随机整合方法，如那些使用扁桃体载体或<em>睡美人</em>转子，已经被用来工程B细胞的转基因传递和表达[5，6，7，8]。然而，这些方法的非特异性使得研究B细胞中特定基因的生物功能变得困难，并具有在治疗环境中插入突变和可变转基因表达和&#x2F;或沉默的固有风险。</p><p>CRISPR&#x2F;Cas9系统是一个强大的基因组工程工具，使研究人员能够精确编辑许多物种中各种细胞的基因组。最近，包括我们自己的两组已经成功地开发出了原始人类B细胞[9,10]的外活扩张和靶向基因组工程方法。我们将描述从白血病样本中净化原人类B细胞的过程。之后，我们将描述我们更新的 B 细胞扩展和激活孤立 B 细胞的协议。然后，我们将描述一个通过电波将CRISPR&#x2F;Cas9 mRNA与CD19 sgRNA一起引入激活的B细胞，从而敲除分化19（CD19）的簇、特定的B细胞受体和B细胞的标志的过程。</p><p>Cas9 mRNA 被翻译并绑定到 CD19 sgRNA，以形成 CRISPR&#x2F;Cas9-sgRNA 核糖核蛋白复合物 （RNP）。随后，复合物中的sgRNA导致Cas9在基因exon2上的目标序列中产生双链断裂（DSB）。细胞将通过引入或删除核苷酸来修复DSB，导致帧移位突变并导致基因被消灭。然后，我们将用流细胞测量测量CD19的损失，并通过分解（TIDE）分析对英德尔的形成进行跟踪分析。</p><hr><h3 id="代表结果解读"><a href="#代表结果解读" class="headerlink" title="代表结果解读"></a>代表结果解读</h3><p>更新的扩增和激活协议能够在7天内将B细胞快速扩增至44倍（图1；n &#x3D; 3个捐赠者）。在KO实验中，使用 Trypan 蓝染色测定的B细胞计数显示，电穿孔后24小时，对照组和CD19 KO样本的存活率均超过80%，但细胞回收略有下降（图2A；p ≥ 0.05，n &#x3D; 3个捐赠者）。这一结果表明，电穿孔对B细胞的整体健康略有影响。在转染后的第5天收集B细胞进行流式细胞术和TIDE分析。对照组和KO样本的代表性散点图显示，分别为14%和95%的CD19阴性细胞（图2B）。流式细胞术图的定量分析显示，与对照组相比，KO样本的CD19表达显著降低（图2B；p ≤ 0.0001，n &#x3D; 3个捐赠者）。</p><p>基因组测序的色谱图（见表3中的引物序列）在CD19 KO B细胞中显示双峰，表明在CRISPR&#x2F;Cas9介导的DSB后发生了核苷酸的插入&#x2F;缺失，而在对照组中观察到单峰，表明此样本中未发生DSB（图3A）。KO样本的Indel分析色谱图（使用一个免费的在线TIDE分析工具）在CD19位点上的Indel形成百分比很高（&gt;90%），这与流式细胞术检测到的CD19蛋白损失百分比一致（图3B；p ≥ 0.05，n &#x3D; 3个捐赠者）。这些结果表明，CRISPR&#x2F;Cas9有效地在B细胞中产生了CD19 KO。</p><p>KI实验的B细胞在工程化后的第12天收集，用于流式细胞术和连接PCR分析（表4）。接收rAAV6载体的样本的散点图显示EGFP阳性细胞占64%（图4），而在对照组中没有观察到EGFP阳性细胞；仅接收AAV载体的样本中观察到最小的EGFP阳性（图5A）。连接PCR扩增（见表3中的引物序列）在KI样本中显示出1.5 Kbps的扩增子（图5B），而在对照组或仅接收载体的样本中没有观察到PCR产物。细胞计数显示，工程化过程对KI样本的细胞回收影响大于对照组或仅接收载体的样本（图5B）。然而，所有样本在工程化后的3天内迅速恢复（图5B）。这些结果表明，成功在AAVS1位点整合EGFP至少在工程化后的12天内能够稳定表达EGFP。</p><hr><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/61855fig01.jpg" alt="Figure 1" style="zoom:50%;"><p>[^图1：体外B细胞扩张]: B细胞在第0天（零）在1个×106 个细胞播种，密度为5×每mL105， 并在7天内扩大44倍（n&#x3D;3独立捐赠者）。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/61855fig02a.jpg" alt="Figure 2A" style="zoom:50%;"><p>[^图2A]: </p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/61855fig02b.jpg" alt="Figure 2B" style="zoom:50%;"><p>[^图2B]: </p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/61855fig02c.jpg" alt="Figure 2C" style="zoom:50%;"><p>[^图2C]: <strong>CRISPR&#x2F;Cas9介质CD19淘汰赛（KO）在B细胞中。</strong>（<strong>A</strong>） 条形图显示 &amp; gt;70% 细胞恢复（左面板）和 &gt;80% 的存活率 （右面板） 细胞在输电后 24 小时在控制和 CD19 KO 样本中观察到。（<strong>B</strong>） 活细胞CD19门控的代表流动图分别显示对照样本和CD19 KO样本中84.3%和3.43%的CD19阳性细胞。（<strong>C</strong>） 条形图显示 CRISPR&#x2F;Cas9 介控 CD19 KO 组 CD19 显著减少（p ≤ 0.0001）。</p><p>然后，我们将描述使用CRISPR&#x2F;Cas9与重组AAV6载体（rAAV6，同源定向修复（HDR）的捐赠模板）一起，以调解在腺相关病毒集成站点1（AAVS1）基因中插入增强型绿色荧光蛋白<em>（EGFP）</em> 的现场特定插入过程。AAVS1基因是一种没有已知生物功能的活性球体，也是人类基因组上的AAV病毒整合站点：因此，它被认为是基因组工程的”安全港”。在这里，我们报告说，B细胞的膨胀和激活允许在7天的培养中扩大44倍（<strong>图1）。</strong>B细胞的电扩散显示，在24小时后，整体细胞健康（<strong>图2A）</strong>略有下降。对 CD19 标记（<strong>图 2B）</strong>的分散图分析显示编辑的单元块（<strong>图 2C）减少高达</strong>83%。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/61855fig03a.jpg" alt="Figure 3A" style="zoom:50%;"><p>[^图3A]: </p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/61855fig03b.jpg" alt="Figure 3B" style="zoom:50%;"><p>[^图3B]: <strong>CD19蛋白质损失与英德尔形成。</strong>（<strong>A</strong>） 色谱图描绘了控制和 CD19 淘汰 （KO） 样本的测序峰值。控制峰值上的灰色框突出显示 CD19 gRNA 的目标序列，并带有箭头指示的预测切割位置。CD19 KO 显示”双峰”测序围绕预测的切割点，指示在双链断裂后插入&#x2F;删除核苷酸。（<strong>B</strong>） 条形图显示 CD19 蛋白质损失百分比与 CD19 轨迹（p ≥ 0.05）的英德尔形成之间的一致结果。</p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/61855fig04.jpg" alt="Figure 4" style="zoom:50%;"><p>[^图4：rAAV6 AAVS1 MND-GFP矢量构造。]: ****表达盒包含一个强大的合成促进器 （MND） 序列，紧接着是增强的绿色荧光蛋白 （EGFP） 编码序列和聚腺素化 （Poly A） 序列。AAVS1 同源臂侧翼在 MND 发起器上游和聚 A 序列的下游。EGFP 将根据 MND 发起人的法规进行表达。在构造的每个组件上方指示序列长度。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/61855fig05a.jpg" alt="Figure 5A"></p><p>[^图5A]: </p><img src="/2024/03/16/%E4%BD%BF%E7%94%A8CRISPR-Cas9%E7%9A%84%E4%BA%BA%E7%B1%BBB%E7%BB%86%E8%83%9E%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%B7%A5%E7%A8%8B/61855fig05b.jpg" alt="Figure 5B" style="zoom:50%;"><p>[^图5B]: </p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/61855fig05c.jpg" alt="Figure 5C"></p><p>[^图5C]: <strong>CRISPR&#x2F;Cas9-和rAAV6在工程后第12天将EGFP记者录音带在B单元中的具体集成。</strong>（<strong>A</strong>） 代表流图显示控制或仅矢量样本中无EGFP阳性 B 细胞，而敲击 （KI） 样本中 EGFP 阳性 B 细胞为 64.4%。（<strong>B</strong>） KI样品的交界聚合酶链反应显示预测的1.5 Kbps波段：在控制或仅矢量样本中未发现带。在 PCR 过程中，水用于确保无污染。（<strong>C</strong>） 条形图描绘了在工程后 3 天内控制、仅矢量和 EGFP-KI 样本的细胞生长。断线表示 1 × 106 单元输入。</p><p>TIDE对色谱仪（<strong>图3A）</strong>的分析显示，英德尔的百分比与流动细胞仪（<strong>图3B）</strong>所导致的蛋白质损失相似。KI实验的流动细胞学分析表明，接受AAV载体（<strong>图4）</strong>的细胞与RNP一起表示高达64%的EGFP阳性细胞（<strong>图5A），</strong>随后通过结点聚合酶链反应（PCR）（<strong>图5B）</strong>显示成功整合。细胞计数显示，所有样本在工程后3天内迅速恢复（<strong>图5C）。</strong></p><hr><h3 id="protocol"><a href="#protocol" class="headerlink" title="protocol"></a><strong>protocol</strong></h3><p>从当地血库获得了健康捐赠者的白细胞分离样本。在此描述的所有实验均被明尼苏达大学的机构审查委员会（IRB）认定为研究豁免，并获得了机构生物安全委员会（IBC）的批准。<br>注意：所有实验均按照血源性病原体的通用预防措施进行，使用无菌&#x2F;无菌技术和适当的生物安全二级设备。</p><ol><li><h4 id="一、准备B细胞扩增培养基的补充剂"><a href="#一、准备B细胞扩增培养基的补充剂" class="headerlink" title="一、准备B细胞扩增培养基的补充剂"></a>一、准备B细胞扩增培养基的补充剂</h4></li></ol><p>  将CpG寡核苷酸复溶至1 mg&#x2F;mL的浓度。<br>  将CD40配体（CD40L）复溶至100 μg&#x2F;mL的浓度。<br>  将重组人IL-10（rhIL-10）复溶至50 μg&#x2F;mL的浓度。<br>  将重组人IL-15（rhIL-15）复溶至10 μg&#x2F;mL的浓度。<br>  注意：将每种补充剂分装成小份，在-20°C至-80°C下保存，最多可保存6个月。</p><ol start="2"><li><h4 id="二、准备基础培养基"><a href="#二、准备基础培养基" class="headerlink" title="二、准备基础培养基"></a>二、准备基础培养基</h4></li></ol><p>  将B细胞基础培养基与5%（体积&#x2F;体积）的体外免疫细胞扩增培养基补充剂（例如，CTS免疫细胞SR）和1%（体积&#x2F;体积）的青霉素和链霉素混合。<br>  使用0.22 µm过滤器适配器对基础培养基进行过滤灭菌，装入已灭菌的瓶子中。<br>  将基础培养基在4°C下保存，最多可保存1个月。</p><ol start="3"><li><h4 id="三、准备B细胞扩增培养基"><a href="#三、准备B细胞扩增培养基" class="headerlink" title="三、准备B细胞扩增培养基"></a>三、准备B细胞扩增培养基</h4></li></ol><p>  将所需量的基础培养基转移到无菌容器中，以5 × 10^5细胞&#x2F;mL的密度培养B细胞。<br>  用1 μg&#x2F;mL CpG、100 ng&#x2F;mL CD40L、50 ng&#x2F;mL rhIL-10和10 ng&#x2F;mL rhIL-15补充基础培养基。<br>  使用0.22 µm过滤器过滤B细胞扩增培养基。<br>  在使用前，将B细胞扩增培养基在37°C、5% CO2、湿度条件下在组织培养孵箱中平衡至少30分钟。<br>  注意：准备新鲜的B细胞扩增培养基以供当天使用。不要准备用于多天的B细胞扩增培养基。此培养基配方鼓励记忆B细胞和激活的原代人B细胞的增殖。</p><ol start="4"><li><h4 id="四、人B细胞的纯化和扩增"><a href="#四、人B细胞的纯化和扩增" class="headerlink" title="四、人B细胞的纯化和扩增"></a>四、人B细胞的纯化和扩增</h4></li></ol><p>  注意：按照制造商的说明，在开始第4.1步之前，向温控冷冻容器中加入99-100%异丙醇，并将冷冻容器在4°C下冷却。</p><ol><li><h5 id="从白细胞分离样本中分离出外周血单核细胞（PBMC）"><a href="#从白细胞分离样本中分离出外周血单核细胞（PBMC）" class="headerlink" title="从白细胞分离样本中分离出外周血单核细胞（PBMC）"></a>从白细胞分离样本中分离出外周血单核细胞（PBMC）</h5><ol><li>将大约8-10 mL的白细胞分离样本转移到无菌的50 mL锥形管中。</li><li>用无菌的1x磷酸盐缓冲液（PBS）将体积补至35 mL。</li><li>小心地将35 mL白细胞分离样本层叠在15 mL密度梯度介质上。</li><li>在500 × g下离心25分钟，不使用制动，去除血浆层，不要扰动富含单核细胞的层（PBMC层），从界面收集PBMCs，并转移到新的无菌50 mL锥形管中。</li><li>用1x PBS将PBMCs的体积补至50 mL。</li><li>在500 × g下离心5分钟，不使用制动。去除上清液，不要扰动可能呈现红色的PBMC沉淀。</li><li>加入7 mL的氯化铵-氯化钾溶胞缓冲液，用移液管轻轻吹打混合3次，并在室温（RT）下孵育3分钟。</li><li>用1x PBS将体积补至50 mL。</li><li>在400 × g、低阻力制动的条件下离心5分钟。去除上清液，不要扰动沉淀。沉淀应呈粉红色或白色。<br>注意：为了继续培养新鲜分离的B细胞，请在开始B细胞分离（第4.2步）之前准备B细胞扩增培养基。</li></ol></li><li><h5 id="使用人原代B细胞负选试剂盒从PBMCs中分离B细胞"><a href="#使用人原代B细胞负选试剂盒从PBMCs中分离B细胞" class="headerlink" title="使用人原代B细胞负选试剂盒从PBMCs中分离B细胞"></a>使用人原代B细胞负选试剂盒从PBMCs中分离B细胞</h5><ol><li>用隔离缓冲液将PBMCs重新悬浮至5 × 10^7细胞&#x2F;mL的浓度。<br>注意：如果PBMC总数少于5 × 10^7细胞，则减少隔离缓冲液的体积以保持5 × 107细胞&#x2F;mL。细胞悬浮液的最小和最大体积分别为0.25 mL和8 mL。</li><li>将最多8 mL（5 × 10^7细胞&#x2F;mL）转移到带有盖子的无菌、聚丙烯、圆底试管中。</li><li>向PBMCs中加入50 μL&#x2F;mL的Cocktail增强剂。</li><li>向PBMCs中加入50 μL&#x2F;mL的隔离鸡尾酒，盖上试管盖，倒置2-3次以混合。</li><li>在RT下孵育5分钟；在孵育的第4分钟，至少30秒涡旋磁性微球。</li><li>每1 mL PBMCs转移50 μL磁性微球，盖上试管盖，倒置2-3次以混合。</li><li>用隔离缓冲液补至10 mL，并轻轻上下吸液2-3次。</li><li>将试管放在磁性站中，在RT下孵育3分钟。</li><li>握住磁铁和试管，将磁铁和试管一起倒置，将细胞悬浮液倒入新试管中。丢弃旧试管。</li><li>重复步骤4.2.8（将孵育时间减少至2分钟），并将B细胞悬浮液倒入干净的锥形管中。</li><li>富集的B细胞准备使用。如果立即使用细胞，请继续第4.3节（人B细胞扩增）。通过流式细胞术（可选）检查分离的B细胞的纯度。如果在使用前需要冷冻细胞，请继续步骤4.2.12。</li><li>为了冷冻B细胞，在400 × g下离心5分钟，去除上清液，不要扰动沉淀。</li><li>用冷冻培养基以10^7细胞&#x2F;mL的浓度重新悬浮细胞，并分装到1 mL&#x2F;冻存管中。</li><li>将冻存管放入冷却的冷冻容器中，在-80°C下储存过夜；然后，将冷冻的冻存管转移到液氮罐中；可保存冻结细胞长达1年。<br>注意：预计分离的B细胞产量为总PBMC的2%-8%，存活率为95%-99%。</li></ol></li><li><h4 id="人B细胞扩增"><a href="#人B细胞扩增" class="headerlink" title="人B细胞扩增"></a>人B细胞扩增</h4><p>注意：如果使用新鲜分离的B细胞，请跳过步骤4.3.1-4.3.5。计数细胞，并将所需数量的细胞转移到无菌锥形管中，然后继续进行步骤4.3.6。</p><ol><li>在使用前，将胎牛血清（FBS）在温水浴中预温。准备20 mL的B细胞扩增培养基，转移到T25烧瓶中，并在使用前至少15分钟在组织培养孵箱中预平衡培养基（在37°C、5% CO2、湿度的条件下）。</li><li>在37°C水浴中解冻B细胞。等待期间，将2 mL预热的FBS转移到无菌的15 mL锥形管中。</li><li>B细胞完全解冻后，立即向样本中逐滴加入1 mL预热的FBS，并在RT下孵育1分钟。</li><li>轻轻吸液以重新悬浮样本，并将整个体积逐滴转移到含有2 mL预热的FBS的锥形管中。</li><li>用无菌的1x PBS将体积补至15 mL，盖上试管盖，轻轻倒置2-3次。</li><li>在400 × g下离心5分钟。</li><li>去除上清液，不要扰动细胞沉淀，用1 mL预平衡的B细胞扩增培养基重新悬浮细胞沉淀，并计数细胞。总细胞数应约为10^7细胞。</li><li>将细胞转移到含有20 mL预平衡的B细胞扩增培养基的烧瓶中。细胞的最终浓度应约为5 × 10^5细胞&#x2F;mL。</li><li>垂直将烧瓶放入组织培养孵箱中孵育。</li><li>每2天通过将B细胞的全部体积转移到无菌锥形管中并重复步骤4.3.6-4.3.9来完全更换扩增培养基。<br>注意：T25烧瓶可以容纳10-20 mL的培养基；T75烧瓶可以容纳多达20-60 mL的培养基。</li></ol></li><li><h4 id="五、人原代B细胞的工程化处理"><a href="#五、人原代B细胞的工程化处理" class="headerlink" title="五、人原代B细胞的工程化处理"></a>五、人原代B细胞的工程化处理</h4></li></ol><p>为了获得最佳结果，在扩增&#x2F;激活后的48 ± 2小时对B细胞进行工程化处理。准备B细胞扩增培养基，将1 mL培养基分装到48孔组织培养板中，并在使用前至少15分钟在组织培养孵箱中预平衡。<br>注意：在设计CRISPR&#x2F;Cas9 sgRNA进行基因编辑时，请遵循以下步骤。</p><p>   1）使用在线工具设计sgRNAs。</p><p>   2）在所有蛋白质变体的共有外显子上设计sgRNAs。</p><p>   3）从信誉良好的公司订购化学修饰的sgRNA。</p><p>  4）sgRNA通常以冻干形式提供；用无菌的DNase&#x2F;RNase-free Tris-EDTA（TE）缓冲液复溶sgRNA，浓度为1 μg&#x2F;μL。</p><pre><code>1. 通过将每个转染反应中的1 μL（1 μg/μL）化学修饰的sgRNA与1.5 μL（1 μg/μL）化学修饰的链球菌Cas9（S.p. Cas9）核酸酶混合来准备CRISPR/Cas9转染底物。对于对照组，使用1 μL TE缓冲液代替sgRNA。 注意：当使用CD19 sgRNA进行基因敲除（KO）实验时，请参阅图2的结果。当使用AAVS1 sgRNA进行基因敲入（KI）实验时，请参阅图5的结果。 **将所有组分保持在冰上。**2. 轻轻混合，并将每个反应的2.5 μL CRISPR/Cas9转染底物转移到0.2 mL 8管条的管中；在室温下放置备用。3. 打开核转染仪（电穿孔仪），并准备转染试剂，如表格1所示。 注意：如果需要，这是一个暂停的好步骤，将所有试剂放在冰上。准备好继续实验时，从冰上取下所有试剂。使用S.p. Cas9蛋白时，研究者必须通过将1 μg sgRNA与5 μg SpCas9蛋白混合，避免产生气泡，并在使用前在室温下孵育至少20分钟以获得最佳结果。4. 计数并将每10^6个B细胞转移到无菌锥形管中进行转染反应。5. 用无菌的1x PBS将体积补至15 mL，并在400 × g下离心5分钟。等待时，准备主要细胞转染试剂（表格2）并在室温下放置备用。6. 去除上清液，不要扰动细胞沉淀。7. 用10 mL无菌的1x PBS重新悬浮细胞沉淀，并在400 × g下离心5分钟。8. 完全去除上清液，不要扰动细胞沉淀。9. 向每10^6个B细胞的细胞沉淀中转移0.5 μg化学修饰的GFP mRNA（作为转染报告物，可选）。10. 用每10^6个B细胞的20 μL主要细胞转染试剂重新悬浮细胞沉淀；轻轻通过吸液5-6次混合。将每个反应的20.5 μL转移到含有2.5 μL CRISPR/Cas9转染底物的0.2 mL管中。11. 上下吸液一次以混合，并将整个体积（23 μL）转移到转染槽中。盖上盖子，轻轻在台面上敲打试管，以确保液体覆盖槽的底部。12. 使用核转染仪的人原代B细胞协议进行转染。    注意：核转染仪（电穿孔仪）可以放在组织培养罩外使用。盖上盖子以确保无菌。13. 让电穿孔后的细胞在室温下静置15分钟。14. 从组织培养板中转移80 μL预平衡的B细胞扩增培养基到转染反应的试管中。将试管放入组织培养孵箱中孵育30分钟。15. 轻轻吸液几次以混合，并将试管中的样本整体转移到48孔组织培养板中适当孔内，含有1 mL B细胞扩增培养基的孔中。细胞的最终浓度应为10^6细胞/mL。16. 如果进行基因敲入实验，则在电穿孔后大约45分钟，将rAAV6载体以500,000感染复数转移到含有电穿孔细胞的适当孔中。请参阅图4A的rAAV6载体构建示例。    注意：例如：对照样本将不使用CRISPR/Cas9或rAAV6载体进行电穿孔。仅载体样本将不使用CRISPR/Cas9进行电穿孔，然后使用rAAV6载体进行转导。敲入（KI）样本将使用CRISPR/Cas9进行电穿孔，然后使用rAAV6载体进行转导。rAAV6必须在其靶向DSB位点上下游含有同源臂，以进行同源定向修复（HDR）。17. 将培养板放入37°C、5% CO2湿度的组织培养孵箱中。18. 在工程化处理后的第1天计数细胞并记录存活率。19. 每2天通过计数细胞并将细胞的全部体积转移到干净的1.5 mL微量离心管中，然后离心以400 ×g离心5分钟，去除上清液，不要扰动沉淀。用100 µL新鲜的B细胞扩增培养基重新悬浮细胞，并转移到24孔组织培养板的孔中。将培养基体积补至最终细胞浓度达到5 × 10^5细胞/mL。    注意：48孔板每孔最多可容纳1 mL培养基；24孔板每孔最多可容纳2 mL培养基；12孔板每孔最多可容纳4 mL培养基；6孔板每孔最多可容纳8 mL培养基。20. 在至少扩增5天后再进行下游分析，如流式细胞术分析、TIDE分析和连接PCR。</code></pre><hr><h3 id="讨论"><a href="#讨论" class="headerlink" title="讨论"></a>讨论</h3><p>直到最近，对原代人B细胞进行精确的基因组工程仍然是一个挑战。我们之前发表的协议使用了CRISPR&#x2F;Cas9来工程化原代人B细胞。在这里，我们概述了改进的B细胞分离、扩增和工程化协议，以实现对CD19的快速KO或对EGFP的敲入。</p><p>我们证明，我们的扩增协议可以在7天内将B细胞快速扩增至44倍（图1）。这个协议的扩增速率比Johnson等人和Hung等人的报告更快。确保原代人B细胞健康快速扩增的关键步骤是每两天用新鲜的激活因子替换培养基，并确保培养中的总B细胞数不超过2 × 106细胞&#x2F;mL。</p><p>我们还发现，我们改进的CRISPR&#x2F;Cas9转染协议对CD19 KO结果在效率上很高（图2和图3）。与之前的研究一样，我们观察到电穿孔后24小时细胞回收和存活率略有下降。这表明电穿孔会影响原代人B细胞的整体健康；然而，细胞最终在48小时内恢复（数据未显示）。</p><p>使用这种电穿孔器协议的好处是，我们可以以更快的速度（16个反应在1分钟内完成），而之前的协议（9，10）完成16个反应大约需要10-12分钟。此外，这个转染系统消除了之前研究中观察到的电穿孔器可能产生的电弧（9，10）。此外，这个工程化方法可以扩大规模，用于更大数量的B细胞，使用更大型的、商业上可获得的槽（数据未显示）。</p><p>为了确保最佳的细胞整体健康和KO效率，有几个关键步骤：首先，确保B细胞扩增培养基制备并预平衡至少15分钟后使用。其次，转染底物的总体积不应超过核转染试剂的20%（体积&#x2F;体积）。第三，必须扩增&#x2F;激活48 ± 2小时以获得最佳结果。第四，在将电穿孔槽放入电穿孔器之前，轻轻敲打电穿孔槽，以确保转染反应溶液覆盖槽底。第五，确保电穿孔后的细胞在电穿孔槽中仅静置15分钟；电穿孔后长时间留在核转染试剂中可能会损害整体细胞存活率。第六，确保将细胞与培养基在电穿孔槽中的孵育时间不超过30分钟。第七，将106个电穿孔细胞放入1 mL中，在最初的48小时内，这有助于细胞更快恢复，而不是在较低的密度下培养（数据未显示）。最后，使用Cas9 mRNA或Cas9蛋白将导致类似的编辑效率（数据未显示）；然而，我们为了方便和成本效益使用了Cas9 mRNA。</p><p>在使用CRISPR&#x2F;Cas9时，有两个主要担忧：脱靶效应和染色体易位。由于sgRNA与目标序列不匹配的碱基对引起的脱靶效应，导致基因组上可能存在许多可能的结合位点，并产生多个不需要的基因KO。因此，应同时考虑预测的脱靶评分和on-target评分，以尽量减少这个问题。染色体易位可能由于脱靶效应或在敲除多个基因时发生。这可能在实验和临床上造成灾难性事件。碱基编辑器（12种：两种类型的胞嘧啶碱基编辑器和腺嘌呤碱基编辑器）改变一个核苷酸（破坏剪接元件、创建过早终止密码子或创建点突变），导致目标基因KO而不产生DSB（在其他地方详细回顾）。因此，碱基编辑方法可用于单基因或多基因KO，以规避染色体易位问题。</p><p>我们还证明，CRISPR&#x2F;Cas9与rAAV6一起，可以用于高效介导特异性KI，并在AAVS1位点表达EGFP。我们在工程化后的至少12天内观察到EGFP表达。我们还观察到KI样本在第12天有两个EGFP阳性群体：一个高表达群体和一个中表达群体（图5A），而仅接收载体的样本显示出最小比例的细胞中存在中表达EGFP。我们推测这种“高和中表达群体”的现象是由于载体双等位基因整合造成的。进一步使用跨越PCR对中和高表达EGFP细胞进行调查可以确认这个假设。使用AAV作为载体的两个注意事项：首先，AAV载体具有有限的货物容量，高达4.7千字节，当敲入大基因时会引起问题。减少同源臂的大小将允许容纳更大的基因，从而降低KI效率（数据未显示）。或者，可以使用多个基因装载载体的同时或顺序整合。研究报道了在免疫健全的动物模型中AAV转导细胞会产生免疫反应并清除这些细胞。作为替代方案，可以探索非病毒基础的供体HDR模板，以规避这个问题。</p><p>总之，我们已经证明了从分离、扩增到B细胞工程化的全面、分步过程，这些过程导致了高基因修改效率。这种工程化方法可以用于基因敲除，并研究B细胞中基因的功能。此外，这种方法可以用于工程化B细胞以表达重组抗体，用于对抗感染。最后，这种方法可以应用于工程化B细胞以表达和分泌治疗酶，这些酶可以作为自体细胞为基础的治疗方法，用于治疗酶病。</p><p>在未来的研究中，我们可以进一步优化这些协议，提高基因编辑的效率和特异性，并探索新的方法来减少脱靶效应和染色体易位的风险。此外，我们还可以研究如何将这些工程化的B细胞用于临床应用，例如作为免疫治疗或基因治疗的工具。通过不断改进和探索新的技术，我们有望在不久的将来实现更高效、更安全的人B细胞基因组工程。</p><hr><table><thead><tr><th><strong>Name</strong></th><th><strong>gRNA sequence</strong></th></tr></thead><tbody><tr><td>CD19</td><td>5’-GCTGTGCTGCAGTGCCTCAA-3’</td></tr><tr><td>AAVS1</td><td>5’-GTCACCAATCCTGTCCCTAG-3’</td></tr></tbody></table><p><strong>Table 1: gRNA sequences.</strong></p><table><thead><tr><th><strong>Reagents</strong></th><th><strong>Volume per 1 reaction</strong></th></tr></thead><tbody><tr><td>P3 Primary Cell solution</td><td>16.4 mL</td></tr><tr><td>Supplement 1</td><td>3.6 mL</td></tr><tr><td><strong>Total</strong></td><td>20 mL</td></tr></tbody></table><p><strong>Table 2: Preparation of Nucleofection reagent mix.</strong></p><table><thead><tr><th><strong>Description</strong></th><th><strong>Sequence</strong></th><th><strong>Purpose</strong></th></tr></thead><tbody><tr><td>CD19 forward primers</td><td>5’-AAATTCAGGAAAGGGTTGGAAG-3’</td><td>Amplify the CD19 locus for Indel analysis</td></tr><tr><td>CD19 Reverse primer</td><td>5’-GCGGACCTCTTCTGTCCATG-3’</td><td>Amplify the CD19 locus for Indel analysis</td></tr><tr><td>Junction PCR forward primer</td><td>5’-GGACGAGCTGTACAAGTAACG-3’</td><td>Junction PCR</td></tr><tr><td>Junction PCR Reverse primer</td><td>5’-GAGACAGTGACCAACCATCC-3</td><td>Junction PCR</td></tr></tbody></table><p><strong>Table 3: Primers used.</strong></p><table><thead><tr><th><strong>Description</strong></th><th><strong>Fluorophore</strong></th><th><strong>Clone</strong></th></tr></thead><tbody><tr><td>Anti-human CD19</td><td>PerCP</td><td>HIB19</td></tr><tr><td>Viability Dye</td><td>eFlour 780</td><td>-</td></tr></tbody></table><p><strong>Table 4: Flow cytometry antibody and viability dye.</strong></p><hr><h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><ol><li>LeBien, T. W., Thomas, T. F. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=B+lymphocytes:+how+they+develop+and+function.">B lymphocytes: how they develop and function.</a> <em>Blood</em>. <strong>112</strong> (5), 1570-1580 (2008).</li><li>Nutt, S. L., Hodgkin, P. D., Tarlinton, D. M., Corcoran, L. M. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=The+generation+of+antibody-secreting+plasma+cells.">The generation of antibody-secreting plasma cells.</a> <em>Nature Reviews Immunology</em>. <strong>15</strong>, 160-171 (2015).</li><li>Slifka, M. K., Antia, R., Whitmire, J. K., Ahmed, R. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=Humoral+immunity+due+to+long-lived+plasma+cells.">Humoral immunity due to long-lived plasma cells.</a> <em>Immunity</em>. <strong>8</strong> (3), 363-372 (1998).</li><li>Spriggs, M. K., et al. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=Recombinant+human+CD40+ligand+stimulates+B+cell+proliferation+and+immunoglobulin+E+secretion.">Recombinant human CD40 ligand stimulates B cell proliferation and immunoglobulin E secretion.</a> <em>Journal of Experimental Medicines</em>. <strong>176</strong> (6), 1543-1550 (1992).</li><li>Fusil, F., et al. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=A+lentiviral+vector+allowing+physiologically+regulated+membrane-anchored+and+secreted+antibody+expression+depending+on+B-cell+maturation+status.">A lentiviral vector allowing physiologically regulated membrane-anchored and secreted antibody expression depending on B-cell maturation status.</a> <em>Molecular Therapy</em>. <strong>23</strong> (11), 1734-1747 (2015).</li><li>Luo, X. M., et al. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=Engineering+human+hematopoietic+stem/progenitor+cells+to+produce+a+broadly+neutralizing+anti-HIV+antibody+after+in+vitro+maturation+to+human+B+lymphocytes.">Engineering human hematopoietic stem&#x2F;progenitor cells to produce a broadly neutralizing anti-HIV antibody after in vitro maturation to human B lymphocytes.</a> <em>Blood</em>. <strong>113</strong> (7), 1422-1431 (2008).</li><li>Mock, U., Thiele, R., Uhde, A., Fehse, B., Horn, S. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=Efficient+lentiviral+transduction+and+transgene+expression+in+primary+human+B+cells.">Efficient lentiviral transduction and transgene expression in primary human B cells.</a> <em>Human Gene Therapy Methods</em>. <strong>23</strong> (6), 408-415 (2012).</li><li>Heltemes-Harris, L. M., et al. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=Sleeping+Beauty+transposon+screen+identifies+signaling+modules+that+cooperate+with+STAT5+activation+to+induce+B-cell+acute+lymphoblastic+leukemia.">Sleeping Beauty transposon screen identifies signaling modules that cooperate with STAT5 activation to induce B-cell acute lymphoblastic leukemia.</a> <em>Oncogene</em>. <strong>35</strong> (26), 3454-3464 (2016).</li><li>Johnson, M. J., Laoharawee, K., Lahr, W. S., Webber, B. R., Moriarity, B. S. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=Engineering+of+primary+human+B+cells+with+CRISPR/Cas9+targeted+nuclease.">Engineering of primary human B cells with CRISPR&#x2F;Cas9 targeted nuclease.</a> <em>Scientific Reports</em>. <strong>8</strong>, 12144 (2018).</li><li>Hung, K. L., et al. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=Engineering+protein-secreting+plasma+cells+by+homology-directed+repair+in+primary+human+B+cells.">Engineering protein-secreting plasma cells by homology-directed repair in primary human B cells.</a> <em>Molecular Therapy</em>. <strong>26</strong> (2), 456-467 (2018).</li><li>Cui, Y., Xu, J., Cheng, M., Liao, X., Peng, S. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=Review+of+CRISPR/Cas9+sgRNA+design+tools.">Review of CRISPR&#x2F;Cas9 sgRNA design tools.</a> <em>Interdisciplinary Sciences</em>. <strong>10</strong> (2), 455-465 (2018).</li><li>Rees, H. A., Liu, D. R. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=Base+editing:+precision+chemistry+on+the+genome+and+transcriptome+of+living+cells.">Base editing: precision chemistry on the genome and transcriptome of living cells.</a> <em>Nature Reviews Genetics</em>. <strong>19</strong> (12), 770-788 (2018).</li><li>Spiegel, A., Bachmann, M., Jurado Jiménez, G., Sarov, M. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=CRISPR/Cas9-based+knockout+pipeline+for+reverse+genetics+in+mammalian+cell+culture.">CRISPR&#x2F;Cas9-based knockout pipeline for reverse genetics in mammalian cell culture.</a> <em>Methods</em>. <strong>164-165</strong>, 49-58 (2019).</li><li>Suzuki, T., Kazuki, Y., Oshimura, M., Hara, T. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=A+novel+system+for+simultaneous+or+sequential+integration+of+multiple+gene-loading+vectors+into+a+defined+site+of+a+human+artificial+chromosome.">A novel system for simultaneous or sequential integration of multiple gene-loading vectors into a defined site of a human artificial chromosome.</a> <em>PLoS One</em>. <strong>9</strong>, 110404 (2014).</li><li>Bak, R. O., Porteus, M. H. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=CRISPR-mediated+integration+of+large+gene+cassettes+using+AAV+donor+vectors.">CRISPR-mediated integration of large gene cassettes using AAV donor vectors.</a> <em>Cell Reports</em>. <strong>20</strong> (3), 750-756 (2017).</li><li>Shirley, J. L., de Jong, Y. P., Terhorst, C., Herzog, R. W. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=Immune+responses+to+viral+gene+therapy+vectors.">Immune responses to viral gene therapy vectors.</a> <em>Molecular Therapy</em>. <strong>28</strong> (3), 709-722 (2020).</li><li>Martino, A. T., Markusic, D. M. <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?db=PubMed&cmd=Search&doptcmdl=Citation&defaultField=Title+Word&term=Immune+response+mechanisms+against+AAV+vectors+in+animal+models.">Immune response mechanisms against AAV vectors in animal models.</a> <em>Molecular Therapy - Methods and Clinical Development</em>. <strong>17</strong>, 198-208 (2020).</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;First Published: November 3rd, 2020&lt;/p&gt;
&lt;p&gt;DOI:&lt;a href=&quot;https://dx.doi.org/10.3791/61855&quot;&gt;10.3791&amp;#x2F;61855&lt;/a&gt;&lt;/p&gt;
&lt;iframe</summary>
      
    
    
    
    
    <category term="BioProtocol" scheme="http://nikolahuang.github.io/tags/BioProtocol/"/>
    
  </entry>
  
  <entry>
    <title>强化学习在生物信息学与基因编辑领域的应用</title>
    <link href="http://nikolahuang.github.io/2024/03/16/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E5%9C%A8%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E4%B8%8E%E5%9F%BA%E5%9B%A0%E7%BC%96%E8%BE%91%E9%A2%86%E5%9F%9F%E7%9A%84%E5%BA%94%E7%94%A8/"/>
    <id>http://nikolahuang.github.io/2024/03/16/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E5%9C%A8%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6%E4%B8%8E%E5%9F%BA%E5%9B%A0%E7%BC%96%E8%BE%91%E9%A2%86%E5%9F%9F%E7%9A%84%E5%BA%94%E7%94%A8/</id>
    <published>2024-03-16T13:21:13.000Z</published>
    <updated>2024-03-16T15:09:03.863Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-背景介绍"><a href="#1-背景介绍" class="headerlink" title="1.背景介绍"></a>1.背景介绍</h1><p>生物信息学和基因编辑是生物科学和生物技术的重要领域，它们在近年来取得了显著的进展。生物信息学涉及对生物数据的分析和解释，包括基因组学、蛋白质结构和功能等。基因编辑则是对基因组的直接修改，用于治疗疾病和改善生物质量。强化学习（Reinforcement Learning，RL）是一种人工智能技术，它可以帮助机器学习从环境中获取反馈，以优化行为策略。在这篇文章中，我们将探讨如何将强化学习应用于生物信息学和基因编辑领域，以及其潜在的应用和挑战。</p><h1 id="2-核心概念与联系"><a href="#2-核心概念与联系" class="headerlink" title="2.核心概念与联系"></a>2.核心概念与联系</h1><h1 id="2-1生物信息学"><a href="#2-1生物信息学" class="headerlink" title="2.1生物信息学"></a>2.1生物信息学</h1><p>生物信息学是一门集生物学、计算机科学、数学、信息论等多学科知识的 intersection 领域。生物信息学家利用计算机科学的方法来分析和解释生物数据，例如基因组数据、蛋白质序列数据、微阵列数据等。生物信formatio学家的任务包括：</p><ul><li>发现新的基因和蛋白质功能</li><li>研究基因组的演化和多样性</li><li>研究基因表达和控制机制</li><li>研究蛋白质结构和功能</li><li>研究生物网络和路径径</li></ul><h1 id="2-2基因编辑"><a href="#2-2基因编辑" class="headerlink" title="2.2基因编辑"></a>2.2基因编辑</h1><p>基因编辑是一种对基因组进行直接修改的技术，用于治疗疾病和改善生物质量。基因编辑技术包括：</p><ul><li>CRISPR&#x2F;Cas9：一种基因剪接技术，可以精确地修改基因组。</li><li>TALEN：一种基因剪接技术，类似于 CRISPR&#x2F;Cas9。</li><li>ZFN：一种基因剪接技术，类似于 CRISPR&#x2F;Cas9 和 TALEN。</li></ul><p>基因编辑技术的应用包括：</p><ul><li>治疗遗传性疾病，如患血症、癌症等。</li><li>改善农业产品，如增加农作物的抗病毒性、增加粮食产量等。</li><li>研究基因组的功能和表达。</li></ul><h1 id="2-3强化学习"><a href="#2-3强化学习" class="headerlink" title="2.3强化学习"></a>2.3强化学习</h1><p>强化学习是一种人工智能技术，它可以帮助机器学习从环境中获取反馈，以优化行为策略。强化学习的核心概念包括：</p><ul><li>状态（State）：环境的描述。</li><li>动作（Action）：机器可以执行的操作。</li><li>奖励（Reward）：环境给予的反馈。</li><li>策略（Policy）：机器选择动作的规则。</li><li>价值函数（Value Function）：预测状态下策略下的累积奖励。</li></ul><h1 id="3-核心算法原理和具体操作步骤以及数学模型公式详细讲解"><a href="#3-核心算法原理和具体操作步骤以及数学模型公式详细讲解" class="headerlink" title="3.核心算法原理和具体操作步骤以及数学模型公式详细讲解"></a>3.核心算法原理和具体操作步骤以及数学模型公式详细讲解</h1><h1 id="3-1Q-Learning算法"><a href="#3-1Q-Learning算法" class="headerlink" title="3.1Q-Learning算法"></a>3.1Q-Learning算法</h1><p>Q-Learning是一种常用的强化学习算法，它可以帮助机器学习如何在环境中取得最佳的行为策略。Q-Learning的核心思想是通过迭代地更新价值函数，以优化策略。Q-Learning的具体操作步骤如下：</p><ol><li>初始化状态值和动作值。</li><li>选择一个初始状态。</li><li>从初始状态中选择一个动作。</li><li>执行动作并得到环境的反馈。</li><li>更新动作值。</li><li>重复步骤3-5，直到收敛。</li></ol><p>Q-Learning的数学模型公式如下：</p><p>Q(s,a)&#x3D;E[∑t&#x3D;0∞γtRt+1∣s0&#x3D;s,a0&#x3D;a]Q(s, a) &#x3D; E[\sum_{t&#x3D;0}^{\infty} \gamma^t R_{t+1} | s_0 &#x3D; s, a_0 &#x3D; a]Q(s,a)&#x3D;E[t&#x3D;0∑∞γtRt+1∣s0&#x3D;s,a0&#x3D;a]</p><p>其中，Q(s,a)Q(s, a)Q(s,a) 表示状态 sss 下执行动作 aaa 的累积奖励，Rt+1R_{t+1}Rt+1 表示时间 t+1t+1t+1 的奖励，γ\gammaγ 是折扣因子。</p><h1 id="3-2应用到生物信息学和基因编辑领域"><a href="#3-2应用到生物信息学和基因编辑领域" class="headerlink" title="3.2应用到生物信息学和基因编辑领域"></a>3.2应用到生物信息学和基因编辑领域</h1><p>在生物信息学和基因编辑领域，强化学习可以用于优化多种任务，例如：</p><ul><li>优化基因剪接技术，以提高治疗疾病的效果。</li><li>优化基因编辑任务，以提高农业产品的质量。</li><li>优化基因组分析任务，以提高基因组数据的解释率。</li></ul><p>具体的，强化学习可以用于优化以下任务：</p><ul><li>优化基因剪接技术的精确性和特异性。</li><li>优化基因编辑任务的效率和准确性。</li><li>优化基因组分析任务的准确性和速度。</li></ul><h1 id="4-具体代码实例和详细解释说明"><a href="#4-具体代码实例和详细解释说明" class="headerlink" title="4.具体代码实例和详细解释说明"></a>4.具体代码实例和详细解释说明</h1><h1 id="4-1Python实现Q-Learning算法"><a href="#4-1Python实现Q-Learning算法" class="headerlink" title="4.1Python实现Q-Learning算法"></a>4.1Python实现Q-Learning算法</h1><p>以下是一个简单的 Python 代码实例，用于实现 Q-Learning 算法。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">python复制代码<span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">QLearning</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, state_space, action_space, learning_rate, discount_factor</span>):</span><br><span class="line">        self.state_space = state_space</span><br><span class="line">        self.action_space = action_space</span><br><span class="line">        self.learning_rate = learning_rate</span><br><span class="line">        self.discount_factor = discount_factor</span><br><span class="line">        self.q_table = np.zeros((state_space, action_space))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">choose_action</span>(<span class="params">self, state</span>):</span><br><span class="line">        <span class="comment"># 选择一个动作</span></span><br><span class="line">        <span class="keyword">return</span> np.argmax(self.q_table[state])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update_q_value</span>(<span class="params">self, state, action, reward, next_state</span>):</span><br><span class="line">        <span class="comment"># 更新动作值</span></span><br><span class="line">        old_value = self.q_table[state, action]</span><br><span class="line">        new_value = reward + self.discount_factor * np.<span class="built_in">max</span>(self.q_table[next_state])</span><br><span class="line">        self.q_table[state, action] = old_value + self.learning_rate * (new_value - old_value)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">self, state_transition_tuples, rewards, learning_epochs</span>):</span><br><span class="line">        <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(learning_epochs):</span><br><span class="line">            <span class="keyword">for</span> state, action, reward, next_state <span class="keyword">in</span> state_transition_tuples:</span><br><span class="line">                self.update_q_value(state, action, reward, next_state)</span><br></pre></td></tr></table></figure><h1 id="4-2应用到生物信息学和基因编辑领域"><a href="#4-2应用到生物信息学和基因编辑领域" class="headerlink" title="4.2应用到生物信息学和基因编辑领域"></a>4.2应用到生物信息学和基因编辑领域</h1><p>在生物信息学和基因编辑领域，可以使用 Q-Learning 算法来优化多种任务。以下是一个简单的 Python 代码实例，用于实现优化基因剪接技术的精确性和特异性的任务。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">python复制代码<span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GeneEditing</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, state_space, action_space, learning_rate, discount_factor</span>):</span><br><span class="line">        self.state_space = state_space</span><br><span class="line">        self.action_space = action_space</span><br><span class="line">        self.learning_rate = learning_rate</span><br><span class="line">        self.discount_factor = discount_factor</span><br><span class="line">        self.q_table = np.zeros((state_space, action_space))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">choose_action</span>(<span class="params">self, state</span>):</span><br><span class="line">        <span class="comment"># 选择一个动作</span></span><br><span class="line">        <span class="keyword">return</span> np.argmax(self.q_table[state])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update_q_value</span>(<span class="params">self, state, action, reward, next_state</span>):</span><br><span class="line">        <span class="comment"># 更新动作值</span></span><br><span class="line">        old_value = self.q_table[state, action]</span><br><span class="line">        new_value = reward + self.discount_factor * np.<span class="built_in">max</span>(self.q_table[next_state])</span><br><span class="line">        self.q_table[state, action] = old_value + self.learning_rate * (new_value - old_value)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">self, state_transition_tuples, rewards, learning_epochs</span>):</span><br><span class="line">        <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(learning_epochs):</span><br><span class="line">            <span class="keyword">for</span> state, action, reward, next_state <span class="keyword">in</span> state_transition_tuples:</span><br><span class="line">                self.update_q_value(state, action, reward, next_state)</span><br></pre></td></tr></table></figure><h1 id="5-未来发展趋势与挑战"><a href="#5-未来发展趋势与挑战" class="headerlink" title="5.未来发展趋势与挑战"></a>5.未来发展趋势与挑战</h1><h1 id="5-1未来发展趋势"><a href="#5-1未来发展趋势" class="headerlink" title="5.1未来发展趋势"></a>5.1未来发展趋势</h1><p>未来，强化学习在生物信息学和基因编辑领域的应用将面临以下挑战：</p><ul><li>数据收集和处理：生物信息学和基因编辑领域产生的数据量巨大，需要开发高效的数据收集和处理方法。</li><li>算法优化：需要开发更高效、更准确的强化学习算法，以应对生物信息学和基因编辑领域的复杂性。</li><li>多模态学习：需要开发可以处理多种类型数据的强化学习算法，以便在生物信息学和基因编辑领域进行更广泛的应用。</li><li>解释性：需要开发可以解释强化学习模型决策的方法，以便在生物信息学和基因编辑领域进行更有说服力的研究。</li></ul><h1 id="5-2挑战"><a href="#5-2挑战" class="headerlink" title="5.2挑战"></a>5.2挑战</h1><p>在强化学习应用于生物信息学和基因编辑领域面临的挑战包括：</p><ul><li>数据质量和可靠性：生物信息学和基因编辑领域的数据质量和可靠性可能受到实验条件和技术限制的影响。</li><li>算法复杂性：强化学习算法的复杂性可能导致计算成本和时间成本较高。</li><li>解释性和可解释性：强化学习模型的决策过程可能难以解释，导致在生物信息学和基因编辑领域的研究难以验证和传播。</li></ul><h1 id="6-附录常见问题与解答"><a href="#6-附录常见问题与解答" class="headerlink" title="6.附录常见问题与解答"></a>6.附录常见问题与解答</h1><p>Q：强化学习在生物信息学和基因编辑领域的应用有哪些？</p><p>A：强化学习可以用于优化多种任务，例如：</p><ul><li>优化基因剪接技术，以提高治疗疾病的效果。</li><li>优化基因编辑任务，以提高农业产品的质量。</li><li>优化基因组分析任务，以提高基因组数据的解释率。</li></ul><p>Q：强化学习在生物信息学和基因编辑领域的挑战有哪些？</p><p>A：强化学习在生物信息学和基因编辑领域面临的挑战包括：</p><ul><li>数据质量和可靠性：生物信息学和基因编辑领域的数据质量和可靠性可能受到实验条件和技术限制的影响。</li><li>算法复杂性：强化学习算法的复杂性可能导致计算成本和时间成本较高。</li><li>解释性和可解释性：强化学习模型的决策过程可能难以解释，导致在生物信息学和基因编辑领域的研究难以验证和传播。</li></ul><p>来源：<a href="https://juejin.cn/post/7315461377258504242">稀土掘金</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-背景介绍&quot;&gt;&lt;a href=&quot;#1-背景介绍&quot; class=&quot;headerlink&quot; title=&quot;1.背景介绍&quot;&gt;&lt;/a&gt;1.背景介绍&lt;/h1&gt;&lt;p&gt;生物信息学和基因编辑是生物科学和生物技术的重要领域，它们在近年来取得了显著的进展。生物信息学涉及对生物数据的</summary>
      
    
    
    
    
    <category term="BioInfo" scheme="http://nikolahuang.github.io/tags/BioInfo/"/>
    
  </entry>
  
  <entry>
    <title>解决Github不能下载，下载速度慢的小妙招（转载）</title>
    <link href="http://nikolahuang.github.io/2024/03/15/%E8%A7%A3%E5%86%B3Github%E4%B8%8D%E8%83%BD%E4%B8%8B%E8%BD%BD%EF%BC%8C%E4%B8%8B%E8%BD%BD%E9%80%9F%E5%BA%A6%E6%85%A2%E7%9A%84%E5%B0%8F%E5%A6%99%E6%8B%9B/"/>
    <id>http://nikolahuang.github.io/2024/03/15/%E8%A7%A3%E5%86%B3Github%E4%B8%8D%E8%83%BD%E4%B8%8B%E8%BD%BD%EF%BC%8C%E4%B8%8B%E8%BD%BD%E9%80%9F%E5%BA%A6%E6%85%A2%E7%9A%84%E5%B0%8F%E5%A6%99%E6%8B%9B/</id>
    <published>2024-03-15T10:19:17.000Z</published>
    <updated>2024-03-15T11:02:17.991Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://developer.aliyun.com/article/888710">原文出处</a></p><p><img src="https://ucc.alicdn.com/images/user-upload-01/11509f94c74d46b28a70b884265addf5.png" alt="img"></p><h2 id="错误描述"><a href="#错误描述" class="headerlink" title="错误描述"></a>错误描述</h2><p>今天在github上使用 git clone 某个项目代码的时， git clone <a href="https://github.com/XXXX/xxx-blog.git">https://github.com/XXXX/xxx-blog.git</a> 下载速度很慢，然后下载一段时间后，总是提示下面的错误信息：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">remote: Enumerating objects: 33, done.</span><br><span class="line">remote: Counting objects: 100% (33/33), done.</span><br><span class="line">remote: Compressing objects: 100% (8/8), done.</span><br><span class="line">error: RPC failed; curl 56 OpenSSL SSL_read: SSL_ERROR_SYSCALL, errno 10054</span><br><span class="line">fatal: the remote end hung up unexpectedly</span><br><span class="line">fatal: early EOF</span><br><span class="line">fatal: index-pack failed </span><br></pre></td></tr></table></figure><h2 id="错误原因"><a href="#错误原因" class="headerlink" title="错误原因"></a>错误原因</h2><p>由于Http协议错误，当 pull 或者 clone 的时候，或者是 github 某个CDN被屏蔽所致。</p><h2 id="解决办法1"><a href="#解决办法1" class="headerlink" title="解决办法1"></a>解决办法1</h2><p>协议错误</p><p>先执行下列命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.postBuffer 5242880000</span><br></pre></td></tr></table></figure><p>再执行<code>git pull</code>或者 <code>git clone</code> 命令</p><h2 id="解决办法2"><a href="#解决办法2" class="headerlink" title="解决办法2"></a>解决办法2</h2><h3 id="修改域名"><a href="#修改域名" class="headerlink" title="修改域名"></a>修改域名</h3><ul><li>访问 <a href="http://github.global.ssl.fastly.net.ipaddress.com/#ipinfo">http://github.global.ssl.fast…</a>获取cdn域名以及IP地址<br><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/5d9c3b2cb1099f4a27c94a53a9c04b8d.png" alt="img"></li><li>访问 <a href="https://github.com.ipaddress.com/#ipinfo">http://github.com.ipaddress.c…</a> 获取cdn域名以及IP地址<br><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/ab03c6248ee9ba8b0e1ac111bad32294.png" alt="img"></li><li>或者直接访问<a href="https://www.ipaddress.com/%E7%BD%91%E5%9D%80%E6%9F%A5%E8%AF%A2%E4%B8%8B%E9%9D%A2%E6%89%80%E9%9C%80%E7%9A%84%E5%9C%B0%E5%9D%80%E5%AF%B9%E5%BA%94%E7%9A%84IP">https://www.ipaddress.com/网址查询下面所需的地址对应的IP</a></li></ul><h3 id="修改hosts文件"><a href="#修改hosts文件" class="headerlink" title="修改hosts文件"></a>修改hosts文件</h3><p>将上述获取的IP地址添加到hosts文件中</p><p>Mac在<code>/etc/hosts</code>中；</p><p>windows在<code>C:\Windows\System32\drivers\etc\hosts</code>中；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># fix git clone github project failed</span><br><span class="line">140.82.113.3 github.com</span><br><span class="line">199.232.5.194 github.global.ssl.fastly.net</span><br><span class="line">192.30.253.120  codeload.github.com</span><br></pre></td></tr></table></figure><h3 id="刷新DNS缓存"><a href="#刷新DNS缓存" class="headerlink" title="刷新DNS缓存"></a>刷新DNS缓存</h3><p>Mac刷新DNS缓存</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo killall -HUP mDNSResponder</span><br><span class="line">sudo dscacheutil -flushcache</span><br></pre></td></tr></table></figure><p>Windows更新DNS缓存</p><p>cmd命令窗口执行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipconfig /flushdns</span><br></pre></td></tr></table></figure><p>使增加的映射生效。</p><h2 id="解决办法3"><a href="#解决办法3" class="headerlink" title="解决办法3"></a>解决办法3</h2><p>使用chrome浏览器，安装一个插件【Github 加速器】</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/3c717bdc5fe69e4e44f121b7ceb2c36e.png" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/watermark%2Ctype_d3F5LXplbmhlaQ%2Cshadow_50%2Ctext_Q1NETiBA55Cm5b2m%2Csize_20%2Ccolor_FFFFFF%2Ct_70%2Cg_se%2Cx_16.png" alt="img"></p><p>下载地址： <a href="https://chrome.zzzmh.cn/info?token=mfnkflidjnladnkldfonnaicljppahpg">https://chrome.zzzmh.cn/info?token=mfnkflidjnladnkldfonnaicljppahpg</a></p><p>安装后见crx文件拖到谷歌的扩展功能里面，然后安装成功。<strong>打开gihub会看到如下界面，多了几个加速地址</strong>.</p><h2 id="解决办法4"><a href="#解决办法4" class="headerlink" title="解决办法4"></a>解决办法4</h2><p>利用socks5代理，配置好后明显加速。用下面两条命令配置好后，保持代理客户端开启就行了。</p><p>设置代理</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 可以参考以下配置，这里的127.0.0.1代表的就是你本机的IP地址，因为服务就在你本机上运行</span><br><span class="line"># 10809是代理的客户端本地端口,默认是1080</span><br><span class="line">git config --global https.proxy http://127.0.0.1:10800</span><br><span class="line">git config --global https.proxy http://127.0.0.1:10800</span><br><span class="line">git config --global http.proxy &#x27;socks5://127.0.0.1:10800&#x27;</span><br><span class="line">git config --global https.proxy &#x27;socks5://127.0.0.1:10800&#x27;</span><br></pre></td></tr></table></figure><p>上述方法挂了全局代理，但是如果要克隆码云、coding等国内仓库，速度就会很慢。更好的方法是<strong>只对github进行代理</strong>，不会影响国内仓库：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.https://github.com.proxy socks5://127.0.0.1:10800</span><br><span class="line">git config --global https.https://github.com.proxy socks5://127.0.0.1:10800</span><br></pre></td></tr></table></figure><p>代理后git clone速度真的快了很多~我这边能到1MB&#x2F;s以上</p><p>查看代理</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global -l</span><br></pre></td></tr></table></figure><p>取消代理</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global --unset http.proxy</span><br><span class="line">git config --global --unset http.proxy</span><br></pre></td></tr></table></figure><h1 id="其他异常问题"><a href="#其他异常问题" class="headerlink" title="其他异常问题"></a>其他异常问题</h1><h2 id="1-解决-curl-7-Failed-to-connect-to-raw-githubusercontent-com-port-443-Connection-refused"><a href="#1-解决-curl-7-Failed-to-connect-to-raw-githubusercontent-com-port-443-Connection-refused" class="headerlink" title="1. 解决 curl: (7) Failed to connect to raw.githubusercontent.com port 443: Connection refused"></a>1. 解决 curl: (7) Failed to connect to raw.githubusercontent.com port 443: Connection refused</h2><p>将下面的IP地址添加到hosts文件中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">199.232.68.133 raw.githubusercontent.com</span><br><span class="line">199.232.68.133 user-images.githubusercontent.com</span><br><span class="line">199.232.68.133 avatars2.githubusercontent.com</span><br><span class="line">199.232.68.133 avatars1.githubusercontent.com</span><br></pre></td></tr></table></figure><h2 id="2-解决curl-56-OpenSSL-SSL-read-Connection-was-reset-errno-10054"><a href="#2-解决curl-56-OpenSSL-SSL-read-Connection-was-reset-errno-10054" class="headerlink" title="2. 解决curl: (56) OpenSSL SSL_read: Connection was reset, errno 10054"></a>2. 解决curl: (56) OpenSSL SSL_read: Connection was reset, errno 10054</h2><p>一、问题：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error: RPC failed; curl 56 OpenSSL SSL_read: Connection was reset, errno 10054</span><br></pre></td></tr></table></figure><p>如图：</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/d87dea031623518fcfe19791939dd606.png" alt="img"></p><p>原因：远程仓库的文件过大，需要设置本地仓库大小**</p><p><strong>二、解决步骤：</strong></p><p>1、首先输入如下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config http.sslVerify &quot;false&quot;</span><br></pre></td></tr></table></figure><p>若出现下列错误：</p><p><strong><code>git config http.sslVerify &quot;false&quot; fatal: not in a git directory</code></strong></p><p>再继续执行 <strong><code>git config --globle http.sslVerify &quot;false&quot;</code></strong> 问题解决</p><p>2、文件大小的上限设置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.postBuffer 524288000</span><br></pre></td></tr></table></figure><p>fatal: not in a git directory <code>**再继续执行**</code>git config –globle http.sslVerify “false”&#96;** 问题解决</p><p>2、文件大小的上限设置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.postBuffer 524288000</span><br></pre></td></tr></table></figure><p>3、如果还是git代码还是下载失败，则需要继续修改git缓存的大小</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://developer.aliyun.com/article/888710&quot;&gt;原文出处&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://ucc.alicdn.com/images/user-upload-01/11509f94c74d</summary>
      
    
    
    
    
    <category term="计算机随笔" scheme="http://nikolahuang.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>使用Github+picGo搭建图床，保姆级教程</title>
    <link href="http://nikolahuang.github.io/2024/03/15/%E4%BD%BF%E7%94%A8Github-picGo%E6%90%AD%E5%BB%BA%E5%9B%BE%E5%BA%8A%EF%BC%8C%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B/"/>
    <id>http://nikolahuang.github.io/2024/03/15/%E4%BD%BF%E7%94%A8Github-picGo%E6%90%AD%E5%BB%BA%E5%9B%BE%E5%BA%8A%EF%BC%8C%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B/</id>
    <published>2024-03-15T06:08:47.000Z</published>
    <updated>2024-03-15T06:35:28.128Z</updated>
    
    <content type="html"><![CDATA[<h1 id="使用Github-picGo搭建图床，保姆级"><a href="#使用Github-picGo搭建图床，保姆级" class="headerlink" title="使用Github+picGo搭建图床，保姆级"></a>使用Github+picGo搭建图床，保姆级</h1><p>转载自<a href="https://www.zhihu.com/people/xiao-xiao-yu-zi-12-58">小小芋子</a></p><h2 id="1-注册一个Github账号"><a href="#1-注册一个Github账号" class="headerlink" title="1. 注册一个Github账号"></a><strong>1. 注册一个Github账号</strong></h2><p>首先你需要一个github账号，如果没有的话，先注册。</p><p>github官网地址： <a href="https://link.zhihu.com/?target=https://github.com/">https://github.com/</a></p><p>注册过程省略，因为这是保姆都不管的事情。</p><p>友情提示：可能在注册过程中会出现 “Unable to verify your captcha response… …”，一直不能正常注册。</p><p>网上有各种解决方案：换浏览器、换电脑… …</p><h2 id="2-配置Github"><a href="#2-配置Github" class="headerlink" title="2. 配置Github"></a>2. 配置Github</h2><h3 id="2-1-创建一个新仓库，用于存放图片。"><a href="#2-1-创建一个新仓库，用于存放图片。" class="headerlink" title="2.1 创建一个新仓库，用于存放图片。"></a>2.1 创建一个新仓库，用于存放图片。</h3><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-59b7f87b4fbe21a2492e4b9e529fe87c_1440w.webp" alt="img"></p><p>填写仓库名称和描述，且仓库必须是public的，否则存储的图片不能正常访问。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-d3733c14e8c9b53cb5cf9f7607d51c8a_1440w.webp" alt="img"></p><h3 id="2-2-生成一个token，用于picGo访问github"><a href="#2-2-生成一个token，用于picGo访问github" class="headerlink" title="2.2 生成一个token，用于picGo访问github"></a>2.2 生成一个token，用于picGo访问github</h3><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-4d227062bcfa58dba6c0582c982b737b_1440w.webp" alt="img"></p><p>选择左侧菜单的Developer settings</p><p><img src="/%E4%BD%BF%E7%94%A8Github-picGo%E6%90%AD%E5%BB%BA%E5%9B%BE%E5%BA%8A%EF%BC%8C%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B.assets/v2-4d227062bcfa58dba6c0582c982b737b_1440w-17104837862607.webp" alt="img"></p><p>之后选择左侧Personal access tokens，再点击Generate new token</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-2d5bcabac97557591c4203009d306750_1440w.webp" alt="img"></p><p>填写Note，勾选repo.</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-346da4ccf189eb5997abe2fadadca331_1440w.webp" alt="img"></p><p>注意，生成的token只会在这里显示一次，所以记得单独保存下来哦。</p><p><img src="/%E4%BD%BF%E7%94%A8Github-picGo%E6%90%AD%E5%BB%BA%E5%9B%BE%E5%BA%8A%EF%BC%8C%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B.assets/v2-354ea85a4bd9cfc99157b86cae9a2332_1440w.webp" alt="img"></p><p>至此，Github的配置完成。</p><h2 id="3-下载picGo，并进行配置"><a href="#3-下载picGo，并进行配置" class="headerlink" title="3. 下载picGo，并进行配置"></a>3. 下载picGo，并进行配置</h2><h3 id="3-1-下载"><a href="#3-1-下载" class="headerlink" title="3.1 下载"></a>3.1 下载</h3><p>网络不好的情况下，PicGo下载可能会多次失败，所以我把下载好的应用放在百度网盘了。</p><p>大家按需取用。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-279f576c0dc0861fd7edcf1d43e5675f_1440w.webp" alt="img"></p><p>网盘地址：<a href="https://link.zhihu.com/?target=https://pan.baidu.com/s/1LvkzLJyZcjpflK2Evq3X9A">https://pan.baidu.com/s/1LvkzLJyZcjpflK2Evq3X9A</a> 提取码：s6x7</p><p>下载完成，双击启动安装即可。</p><p>如果安装成功，picGo不能正常使用，则可以用兼容模式启动。【此问题因电脑而异，也是我在配置过程中踩过的坑。】</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-3f60ccb549e01c95a1702ceca9bda95d_1440w.webp" alt="img"></p><h3 id="3-2-配置"><a href="#3-2-配置" class="headerlink" title="3.2 配置"></a>3.2 配置</h3><p>仓库名：[github用户名]&#x2F;[第一步新建的仓库名称]</p><p>分支：默认master，从2020.10.01开始，github的默认分支名变更为main</p><p>设定token：第一步创建的token</p><p>指定存储路径：可填可不填，如果填写了，图片就会存储在img文件夹下</p><p>设定自定义域名：<a href="https://cdn.jsdelivr.net/gh/[github%E7%94%A8%E6%88%B7%E5%90%8D]/[%E4%BB%93%E5%BA%93%E5%90%8D]@main%EF%BC%8C%E6%B3%A8%E6%84%8F%EF%BC%8C%E6%AD%A4%E5%A4%84%E7%9A%84%E5%88%86%E6%94%AF%E4%B8%80%E5%AE%9A%E8%A6%81%E5%A1%AB%E5%86%99@main%EF%BC%8C%E5%90%A6%E5%88%99%E9%BB%98%E8%AE%A4%E4%BD%BF%E7%94%A8master%E5%88%86%E6%94%AF%E3%80%82%E8%80%8C%E7%8E%B0%E5%9C%A8github%E5%88%9B%E5%BB%BA%E7%9A%84%E9%BB%98%E8%AE%A4%E5%88%86%E6%94%AF%E5%90%8D%E4%B8%BAmain%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%B8%8D%E6%8C%87%E5%AE%9A%EF%BC%8C%E5%88%99%E4%BC%9A%E5%87%BA%E7%8E%B0%E5%9B%BE%E7%89%87%E4%B8%8D%E8%83%BD%E4%B8%8A%E4%BC%A0%E7%9A%84%E6%83%85%E5%86%B5%E3%80%82%E3%80%90%E8%B8%A9%E5%9D%91%E4%B8%A4%E5%B0%8F%E6%97%B6%E3%80%91">https://cdn.jsdelivr.net/gh/[github用户名]/[仓库名]@main，注意，此处的分支一定要填写@main，否则默认使用master分支。而现在github创建的默认分支名为main，如果不指定，则会出现图片不能上传的情况。【踩坑两小时】</a></p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-62e4faaa7999d1d32fa80aec44b4034e_1440w.webp" alt="img"></p><p>至此，github+picGo的配置完成，可以在上传区进行图片上传了。</p><h3 id="3-3-补充几点"><a href="#3-3-补充几点" class="headerlink" title="3.3 补充几点"></a>3.3 补充几点</h3><p>1.原本github的自定义域名应该是：[<a href="https://raw.githubusercontent.com/[username/]/[%E4%BB%93%E5%BA%93%E5%90%8D]](https://link.zhihu.com/?target=https://raw.githubusercontent.com/%5Busername%5D/%5B%E4%BB%93%E5%BA%93%E5%90%8D%5D)">https://raw.githubusercontent.com/[username\]/[仓库名]](https://link.zhihu.com/?target=https%3A//raw.githubusercontent.com/%5Busername%5D/%5B%E4%BB%93%E5%BA%93%E5%90%8D%5D)</a></p><p>但是使用这种方式访问图片巨慢，所以教程中使用了jsdelivr作为cdn加速。改变域名即可，不需要任何其他配置。</p><p>2.配置完成，可能出现不能上传的情况，请大家耐心检查，也许某一步的配置出现了问题，就像检查bug一样耐心、细心。想象一下图床搭建成功后，写起文章来的丝滑感，是不是又有动力了？</p><h2 id="4-PicGo集成Typora"><a href="#4-PicGo集成Typora" class="headerlink" title="4. PicGo集成Typora"></a>4. PicGo集成Typora</h2><p>使用MarkDown语法写文章，我使用的编辑器是typora，一款超级好用的编辑器。在一个编辑框内，编辑完成后，可以马上显示MarkDown语法效果。</p><p>举个栗子：</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-ce0b207c19d6ca32ac22937f1dc6cfcd_1440w.webp" alt="img"></p><p>并且typora可以和picGo联合在一起使用，当你在编辑器中插入、粘贴图片时，typora+picGo的组合方式，可以自动把图片上传至github保存。</p><h3 id="4-1-下载安装"><a href="#4-1-下载安装" class="headerlink" title="4.1 下载安装"></a>4.1 下载安装</h3><p>Typora新版本是收费的，所以建议大家使用旧版本就可以了，完全能满足写作需求。</p><p>旧版本安装包和picGo放在一起了（下载地址见上文），大家按需取用即可。</p><p>下载完成后正常步骤安装即可。</p><h3 id="4-2-配置"><a href="#4-2-配置" class="headerlink" title="4.2 配置"></a>4.2 配置</h3><p>在typora顶部菜单界面，选择“文件” - &gt; “偏好设置”，设置图片存储方式。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-f595cf5c8a0e3b62944c68deb8fb5878_1440w.webp" alt="img"></p><p>选择图片存储方式：上传图片。</p><p>上传服务：PicGo(app)</p><p>PicGo路径：picGo安装的地址</p><p>设置完成，点击“验证图片上传”，提示上传成功，即代表配置成功。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-e27e9f198aef7bdea365549b2257025d_1440w.webp" alt="img"></p><p>注意一点，typora图片验证中的端口，需要与picGo中的server设置内的端口一致，否则typora中不能正常上传。</p><h3 id="4-3-picGo监听端口设置"><a href="#4-3-picGo监听端口设置" class="headerlink" title="4.3 picGo监听端口设置"></a>4.3 picGo监听端口设置</h3><p>选择“PicGo设置”–&gt;“设置server”</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-8ff622935a6b0597a21e68e7575e16ef_1440w.webp" alt="img"></p><p>【此处有坑】如果监听端口不是36677，则需要修改为36677。否则会出现picGo能正常上传 图片，而typora上传图片失败的情况。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage2@main/img/v2-304589efaed9a1ba3caf5e8827e77582_1440w.webp" alt="img"></p><p>最后，在苹果电脑中可以使用<strong>Typora+Ipic+Github</strong>的方式，有兴趣的话可以自行尝试</p><p><strong>总结：github+picGo+typora他们三个是好基友。</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;使用Github-picGo搭建图床，保姆级&quot;&gt;&lt;a href=&quot;#使用Github-picGo搭建图床，保姆级&quot; class=&quot;headerlink&quot; title=&quot;使用Github+picGo搭建图床，保姆级&quot;&gt;&lt;/a&gt;使用Github+picGo搭建图床，保</summary>
      
    
    
    
    
    <category term="计算机随笔" scheme="http://nikolahuang.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>小鼠体外受精2</title>
    <link href="http://nikolahuang.github.io/2024/03/15/%E5%B0%8F%E9%BC%A0%E4%BD%93%E5%A4%96%E5%8F%97%E7%B2%BE/"/>
    <id>http://nikolahuang.github.io/2024/03/15/%E5%B0%8F%E9%BC%A0%E4%BD%93%E5%A4%96%E5%8F%97%E7%B2%BE/</id>
    <published>2024-03-14T16:08:45.000Z</published>
    <updated>2024-04-05T16:55:50.343Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><p><a href="javascript:;">杨伟伟</a>，<a href="javascript:;">顾美儿</a>，<a href="javascript:;">桂飞</a>，<a href="javascript:;">宋晓明</a>，<a href="javascript:;">孙筱品</a>，<a href="javascript:;">唐蔚</a>，<a href="javascript:;">吴宝金 </a></p><p>来源DOI:  <a href="https://doi.org/10.21769/BioProtoc.1010947">10.21769&#x2F;BioProtoc.1010947</a></p><p>杨伟伟, 顾美儿, 桂飞, 宋晓明, 孙筱品, 唐蔚, 吴宝金. (2022). 小鼠体外受精. &#x2F;&#x2F; 实验动物胚胎操作实验手册. <em>Bio-101</em>: e1010947. DOI: <a href="https://doi.org/10.21769/BioProtoc.1010947">10.21769&#x2F;BioProtoc.1010947</a>.</p><p>第一次发表时间:  2022&#x2F;09&#x2F;20</p><p><strong>摘要:</strong> 小鼠体外受精实验是基因工程小鼠的辅助生殖及遗传工程小鼠精子库的重要支撑技术。在常规In Vitro Fertilization(IVF)操作的基础上，Nakagata改良法在modified human tubal fluid (mHTF)中加入Reduced glutathione(GSH)作为受精液（mHTF-GSH），在modified Krebs-Ringer’s bicarbonate medium中加入Methyl-β-cyclodextrin作为获能液（TYH with MβCD），显著提升了体外受精效率。该法适用于新鲜及冷冻复苏精子的体外受精操作。</p><p>关键词: 小鼠, mHTF-GSH, TYH with MβCD, 体外受精</p><hr><h3 id="材料与试剂"><a href="#材料与试剂" class="headerlink" title="材料与试剂"></a>材料与试剂</h3><h4 id="材料"><a href="#材料" class="headerlink" title="材料"></a><strong>材料</strong></h4><ol><li>培养皿35mm×10mm（Corning，货号：430588）</li><li>胚胎移植口吸管（北京吉田生物科技有限公司，规格：1.0×500mm）</li><li>吸头（Axygen，货号：T-300-R-S、T-1000-B-R-S、T-200-Y-R-S）</li><li>无菌注射器（上海米沙瓦医科工业有限公司，规格：1mL）</li><li>50mL离心管（BD，货号：352070）</li><li>滤纸（宝威德，规格：60 × 60 cm）</li></ol><p><strong>动物：</strong>3-6月龄成年雄鼠，1-2只&#x2F;品系。4-5周龄雌性供体小鼠，4-5只&#x2F;品系（根据雄性小鼠背景品系选用)。本实验室所用动物来自杭州师范大学实验动物中心（生产许可证号：SCXK（浙）2016-0004，使用许可证号：SYXK（浙）2016-0014），饲养在独立换气笼盒系统，动物自由饮水、自由采食经Co60辐射的灭菌饲料。</p><h4 id="试剂"><a href="#试剂" class="headerlink" title="试剂"></a><strong>试剂</strong></h4><ol><li>注射用血促性素（PMSG, Pregnant Mare Serum Gonadotropin）(宁波市三生药业有限公司, 规格:1000IU×10瓶)和注射用绒促性素（hCG, human Chorionic Gonadotropin,）(宁波市三生药业有限公司, 规格:1000IU×10支)</li><li>矿物油（Sigma，货号：M8410）</li><li>mHTF：按表1配制。</li><li>mHTF-GSH：按表2配制。</li><li>TYH with MβCD（TYH with Methyl-β-cyclodextrin）按表3配制。</li></ol><h4 id="仪器设备"><a href="#仪器设备" class="headerlink" title="仪器设备"></a>仪器设备</h4><ol><li>100mL烧杯（蜀牛，货号：GG-17）</li><li>100mL容量瓶（天玻，货号：TB9）</li><li>生物安全柜（Thermo Scientific，型号：1384 ）</li><li>超净工作台（苏净安泰，型号：HS-840-U）</li><li>CO2培养箱（Thermo Scientific，型号：3111 ）</li><li>体视显微镜（Nikon，型号： SMZ745T）</li><li>电子天平（Sartorius，型号：MSA125P-CE）</li><li>电热恒温水浴锅（上海精宏实验设备有限公司，型号：DK-S22型）</li><li>微量移液器 （eppendorf，货号：3120000224、3120000240）</li><li>手术剪（上海金钟，型号：J21010）</li><li>医用镊（上海金钟，型号：J40120）</li><li>维纳斯剪（上海金钟，型号：YC0040）</li><li>显微镊（上海金钟，型号：WA3030）</li><li>眼科直剪（上海金钟，型号：Y00030）</li><li>眼科直镊（上海金钟，型号：JD1050）</li></ol><hr><h3 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h3><h4 id="一、准备工作"><a href="#一、准备工作" class="headerlink" title="一、准备工作"></a>一、准备工作</h4><ol><li><p>超数排卵：供体小鼠腹腔注射PMSG，每只5IU（0.1mL）。46-48h后，腹腔注射hCG，每只5IU（0.1mL）。</p></li><li><p>精子获能滴（TYH with MβCD，如图1-A）：用TYH with MβCD液在培养皿内做一个100µL液滴（冻存精液滴为90µL），加3-4mL矿物油覆盖，在培养箱（37℃、5%CO2）孵育至少30min。</p></li><li><p>受精滴（mHTF-GSH，如图1-B）：用mHTF-GSH液在培养皿内做两个200µL液滴（冻存精液滴为90µL），加3-4mL矿物油覆盖，在培养箱（37℃、5%CO2）孵育至少10min。</p></li><li><p>清洗滴（mHTF，如图1-C）：用mHTF液在培养皿内做3个80µL液滴和1个160µL液滴，加3-4mL矿物油覆盖，在培养箱（37℃、5%CO2）孵育至少30min。</p></li><li><p>水浴准备：恒温水浴锅开启37℃水浴。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage@main/img/20220811202317_0252.jpg" alt="img"><br><strong>图1. 小鼠体外受精实验培养滴</strong> A. 精子获能滴（TYH with MβCD） B. 受精滴（mHTF-GSH） C. 清洗滴（mHTF），胚胎按照图中白色箭头方向清洗转移</p></li></ol><hr><h4 id="二、操作流程"><a href="#二、操作流程" class="headerlink" title="二、操作流程"></a>二、操作流程</h4><ol><li><p>精子的采集及获能</p></li><li><p>卵母细胞采集（如图2-D,E,F）：将注射hCG的供体小鼠（15-17h后）断颈处死，酒精消毒。剪开背部皮肤，快速找到输卵管，在滤纸上吸干，放入受精滴培养皿的矿物油中。在显微镜下找到膨大部，牵引卵丘团流出，并将其拖入mHTF-GSH滴中（取至4-6簇卵丘团）。注意：为保证质量，在处死动物到卵丘团放入液滴的过程中，务必在30sec内完成。</p></li><li><p>体外受精（如图2-G,H）：精液孵育50-60min后，观察精子活力，并沿着TYH with MβCD滴的外围用移液器吸取4-5µL精液（冷冻复苏精液可根据精子活力及浓度增加量至10-20µL），放入含有卵母细胞的mHTF-GSH滴中，并将其放入培养箱（37℃、5%CO2）培养3h。</p></li><li><p>清洗：受精后培养3h，将细胞先转入80µL的mHTF滴中，3次清洗后，转入160µL的mHTF滴培养6h，去除未受精的卵母细胞和含有单原核的孤雌生殖卵母细胞，保留含有第二极体和两个原核的受精卵细胞（如图2-I,J）。</p></li><li><p>受精卵过夜培养：次日挑选发育正常的2-细胞（如图2-K），用胚胎移植口吸管转移至mHTF的第4个滴中，移植或者胚胎冻存备用。同时记录2-细胞、单细胞和异型细胞的数量，计算受精率。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage@main/img/20220811203426_9863.jpg" alt="img"><br><strong>图2. 小鼠体外受精过程.</strong> A. 附睾的解剖位置 A-1. 附睾组织结构图 B. 取出的附睾尾 C. 冷冻精子复苏精液 D. 输卵管解剖位置 E. 输卵管壶腹部 F.卵母细胞-卵丘团 G. 获能完成的精子悬液 H. 受精 I、J. 受精6小时后细胞形态 K. 受精24小时后细胞形态</p></li></ol><p>溶液配方</p><ol><li><p>mHTF配制表</p></li><li><p>mHTF-GSH配制表</p></li><li><p>TYH with MβCD配制表</p><p>表1：mHTF配制表（100mL体积）</p><table><thead><tr><th>名称</th><th>重量（mg）</th><th>品牌</th><th>货号</th></tr></thead><tbody><tr><td>NaCl</td><td>593.8</td><td>Sigma</td><td>S-5886</td></tr><tr><td>KCl</td><td>35.0</td><td>Sigma</td><td>P-5405</td></tr><tr><td>CaCl2</td><td>57.0</td><td>Sigma</td><td>G-5670</td></tr><tr><td>Glucose</td><td>50.0</td><td>Sigma</td><td>G-6152</td></tr><tr><td>MgSO4</td><td>2.4</td><td>Sigma</td><td>M2643</td></tr><tr><td>KH2PO4</td><td>5.4</td><td>Sigma</td><td>P-5655</td></tr><tr><td>Sodium pyruvate</td><td>3.5</td><td>Sigma</td><td>P-4562</td></tr><tr><td>60%sodium lacate</td><td>0.34mL</td><td>Sigma</td><td>L-7900</td></tr><tr><td>NaHCO3</td><td>210.0</td><td>Sigma</td><td>S-5761</td></tr><tr><td>Penicillin G</td><td>7.5</td><td>BD</td><td>C15935000</td></tr><tr><td>Streptomycin</td><td>5.0</td><td>Sigma</td><td>S-1277</td></tr><tr><td>Bovine serum albumin</td><td>400.0</td><td>Sigma</td><td>B2064</td></tr><tr><td>0.5%phenol red</td><td>0.04ml</td><td>Sigma</td><td>P-0290</td></tr></tbody></table><p>配制方法：在100mL的烧杯中，加入80mL的灭菌水(Sigma,W1503)，将上述药品依次加入混匀，容量瓶定容至100mL。0.22µM针式过滤器过滤分装在1.5mL的离心管内。4℃保存可用30天。</p><p>表2：mHTF-GSH配制（1mL体积）</p><table><thead><tr><th>名称</th><th>重量（mg）</th><th>品牌</th><th>货号</th></tr></thead><tbody><tr><td>GSH</td><td>1.5</td><td>Sigma</td><td>G4251</td></tr><tr><td>mHTF</td><td>1（mL）</td><td>-</td><td>无</td></tr></tbody></table><p>注：“-” 为混合试剂，配方参见表1</p><p>配制方法：称取1.5mg(冷冻精液取3.1mg)的GSH，溶解在装有mHTF(1mL)的1.5mL离心管内，再分次将100µL上述溶液转移至装有mHTF（900µL）的1.5mL离心管内，混匀密封，-20℃冷冻保存备用，有效期约30天。</p><p>表3：TYH with MβCD配制（100mL体积）</p><table><thead><tr><th>名称</th><th>重量（mg）</th><th>品牌</th><th>货号</th></tr></thead><tbody><tr><td>NaCl</td><td>697.6</td><td>Sigma</td><td>S-5886</td></tr><tr><td>KCl</td><td>35.6</td><td>Sigma</td><td>P-5405</td></tr><tr><td>CaCl2.2H2O</td><td>25.1</td><td>Sigma</td><td>G-5670</td></tr><tr><td>Glucose</td><td>100.0</td><td>Sigma</td><td>G-6152</td></tr><tr><td>MgSO4</td><td>14.3</td><td>Sigma</td><td>M2643</td></tr><tr><td>KH2PO4</td><td>16.2</td><td>Sigma</td><td>P-5655</td></tr><tr><td>Sodium pyruvate</td><td>5.5</td><td>Sigma</td><td>P-4562</td></tr><tr><td>Polyvinyl alcohol</td><td>100.0</td><td>Sigma</td><td>P-8136</td></tr><tr><td>Penicillin G</td><td>7.5</td><td>BD</td><td>C15935000</td></tr><tr><td>Streptomycin</td><td>5.0</td><td>Sigma</td><td>S-1277</td></tr><tr><td>Methyl-β-cyclodextrin</td><td>98.3</td><td>Sigma</td><td>C-4555</td></tr><tr><td>NaHCO3</td><td>210.6</td><td>Sigma</td><td>S-5761</td></tr></tbody></table><p>配制方法：在100mL烧杯中加入70mL的灭菌水（Sigma,W1503），将上述药品依次加入，混匀；同时，100mg（Polyvinyl alcohol）放入含有10mL灭菌水的离心管中，60℃水浴10min，溶解后加入烧杯中，再依次加入其它试剂溶解，最后定容至100mL。0.22µM针式过滤器过滤分装在1.5mL的离心管内。4℃保存可用30天。</p><p>PMSG配制方法：将1000IU &#x2F;支的PMSG稀释在20mL灭菌水中，制成50IU&#x2F;mL的备用液。-20℃冷冻保存可使用14天。</p><p>hCG配制方法：将1000IU&#x2F;支的hCG稀释在20mL灭菌水中，制成50IU&#x2F;mL的备用液。-20℃冷冻保存可使用14天。</p></li></ol><hr><h3 id="经验体会"><a href="#经验体会" class="headerlink" title="经验体会"></a>经验体会</h3><ol><li>供体小鼠年龄的要求，常用4-5周龄背景品系雌鼠，超排效果较好，获取的卵母细胞数量较多。6-8周龄小鼠的超排效果相对较差。8周龄以上的雌鼠，在超排时，根据体重适当加大超排剂量，超排效果尚可。</li><li>体外受精对雄鼠的要求不高，健康雄鼠精液质量较好，受精率较高一般均能达到90%上。若雄鼠年龄偏大，精液质量欠佳，受精率会相对较低一般在50-80%左右。个别品系及个体差异出现过30%左右的受精率。可根据雄鼠状态相应准备足够数量的供体雌鼠。</li><li>卵母细胞的采集，尽可能在小鼠断颈后30sec内完成，如果无人配合，可单只处死快速采集，可减少异形细胞或孤雌生殖卵母细胞的出现。</li><li>体外受精时精液的用量一般为3-5μL，可根据精液的浓度和精子活力适当调整加液量。冷冻复苏时精液应加倍。</li><li>在受精后6h，可观察到含有第二极体和两个原核的受精卵细胞，同时含有单原核的孤雌生殖卵母细胞，这种细胞需剔除。</li><li>移卵针的挑选。如果是自行制作的，应保证移卵针前端圆润，以免伤到细胞，同时应注意孔径大小，若过大，在吸放卵细胞时不好控制，导致清洗不干净；若过小，有可能会损伤细胞，吸放比较费力。目前有商品化的移卵针，可根据情况自行选用。</li><li>在TYH with MβCD配制过程中，因聚乙烯醇可溶性不好，需要先溶于水，涡旋混匀，在60℃水浴锅内温浴10min，之后再加入总的液体中。</li><li>加入还原性谷胱甘肽的HTF作为受精液，可有效提高受精率，尤其对冷冻复苏精子尤为明显。</li></ol><hr><h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><ol><li>Takeo, T. and Nakagata, N. (2011). <a href="http://www.ncbi.nlm.nih.gov/pubmed/21778138">Reduced glutathione enhances fertility of frozen&#x2F;thawed C57BL&#x2F;6 mouse sperm after exposure to methyl-beta-cyclodextrin.</a> <em>Biol Reprod</em> 85(5): 1066-1072.</li><li>Takeo, T., Sztein, J. and Nakagata, N. (2019). <a href="http://www.ncbi.nlm.nih.gov/pubmed/30353518">The CARD Method for Mouse Sperm Cryopreservation and In Vitro Fertilization Using Frozen-Thawed Sperm.</a> <em>Methods Mol Biol</em> 1874: 243-256.</li><li>Guan, M., Bogani, D., Marschall, S., Raspa, M., Takeo, T., Nakagata, N. and Fray, M. (2014). <a href="http://www.ncbi.nlm.nih.gov/pubmed/25723919">In vitro fertilization in mice using the MBCD-GSH protocol.</a> <em>Curr Protoc Mouse Biol</em> 4(2): 67-83.</li><li>Nakagata, N., Takeo, T., Fukumoto, K., Haruguchi, Y., Kondo, T., Takeshita, Y., Nakamuta, Y., Umeno, T. and Tsuchiyama, S. (2014). <a href="http://www.ncbi.nlm.nih.gov/pubmed/24492659">Rescue in vitro fertilization method for legacy stock of frozen mouse sperm.</a> <em>J Reprod Dev</em> 60(2): 168-171.</li><li>Takeo, T. and Nakagata, N. (2010). <a href="http://www.ncbi.nlm.nih.gov/pubmed/20357317">Combination medium of cryoprotective agents containing L-glutamine and methyl-{beta}-cyclodextrin in a preincubation medium yields a high fertilization rate for cryopreserved C57BL&#x2F;6J mouse sperm.</a> <em>Lab Anim</em> 44(2): 132-137.</li><li>Takeo, T., Hoshii, T., Kondo, Y., Toyodome, H., Arima, H., Yamamura, K., Irie, T. and Nakagata, N. (2008). <a href="http://www.ncbi.nlm.nih.gov/pubmed/18046011">Methyl-beta-cyclodextrin improves fertilizing ability of C57BL&#x2F;6 mouse sperm after freezing and thawing by facilitating cholesterol efflux from the cells.</a> <em>Biol Reprod</em> 78(3): 546-551.</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;javascript:;&quot;&gt;杨伟伟&lt;/a&gt;，&lt;a href=&quot;javascript:;&quot;&gt;顾美儿&lt;/a&gt;，&lt;a href=&quot;javascript:;&quot;&gt;桂飞&lt;/a&gt;，&lt;a href=&quot;javascript:;&quot;&gt;宋晓明&lt;/a&gt;，&lt;</summary>
      
    
    
    
    
    <category term="BioProtocol" scheme="http://nikolahuang.github.io/tags/BioProtocol/"/>
    
  </entry>
  
  <entry>
    <title>小鼠受精卵原核注射及胞浆注射</title>
    <link href="http://nikolahuang.github.io/2024/03/15/%E5%B0%8F%E9%BC%A0%E5%8F%97%E7%B2%BE%E5%8D%B5%E5%8E%9F%E6%A0%B8%E6%B3%A8%E5%B0%84%E5%8F%8A%E8%83%9E%E6%B5%86%E6%B3%A8%E5%B0%84/"/>
    <id>http://nikolahuang.github.io/2024/03/15/%E5%B0%8F%E9%BC%A0%E5%8F%97%E7%B2%BE%E5%8D%B5%E5%8E%9F%E6%A0%B8%E6%B3%A8%E5%B0%84%E5%8F%8A%E8%83%9E%E6%B5%86%E6%B3%A8%E5%B0%84/</id>
    <published>2024-03-14T16:04:32.000Z</published>
    <updated>2024-04-05T16:56:09.274Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><p><a href="javascript:;">唐蔚</a>，<a href="javascript:;">李周结</a>，<a href="javascript:;">俞骞</a>，<a href="javascript:;">陈子尘</a>，<a href="javascript:;">王倩雯</a>，<a href="javascript:;">陈国元</a>，<a href="javascript:;">丁一夫</a>，<a href="javascript:;">吴宝金 </a></p><p>来源DOI:  <a href="https://doi.org/10.21769/BioProtoc.1010948">10.21769&#x2F;BioProtoc.1010948</a></p><p>第一次发表时间:  2022&#x2F;09&#x2F;20</p><p><strong>摘要:</strong> 将外源基因DNA序列直接注射到原核期的受精卵雄性原核中，或将sgRNA及Cas9等基因打靶构建注入受精卵的胞浆内，经过显微注射的受精卵再移植到受体动物的输卵管或子宫内继续发育，进而可得到转基因&#x2F;基因敲除动物。</p><h3 id="材料与试剂"><a href="#材料与试剂" class="headerlink" title="材料与试剂"></a>材料与试剂</h3><h4 id="（一）材料"><a href="#（一）材料" class="headerlink" title="（一）材料"></a>（一）材料</h4><ol><li><h5 id="手术器械"><a href="#手术器械" class="headerlink" title="手术器械"></a>手术器械</h5><p>系线镊（协和, MR-F201A）<br>弯嘴眼科镊（施强, JYN1030）<br>小血管剪（金钟, JA2405）<br>止血夹（灵涛, LW0080）<br>缝合钳（三友, SY11Cr）<br>带线缝合针（双箭, YY0166-2002）</p></li><li><p>注射针（带芯毛细玻璃管，SUTTER INSTRUMENT BF100-78-10）</p></li><li><p>微量注射枪头（Eppendorf Microloader货号：5242956003）</p></li><li><p>固定针（无芯毛细玻璃管，SUTTER INSTRUMENT B100-75-10）</p></li><li><p>吸卵针（国产毛细管，规格0.9-1.1×120 mm）</p></li><li><p>培养皿（FALCON 353001、353002）</p></li></ol><h4 id="（二）试剂"><a href="#（二）试剂" class="headerlink" title="（二）试剂"></a>（二）试剂</h4><ol><li>FHM小鼠胚胎培养液（MILLIPORE公司，产品目录号：MR-025-D）</li><li>KSOM小鼠胚胎培养液（MILLIPORE公司，产品目录号：MR-121-D）</li><li>矿物油（SIGMA M8410）</li><li>透明质酸酶（SIGMA H3506 ）</li><li>孕马血清PMSG（宁波三生）</li><li>人绒毛膜促性腺激素HCG（宁波三生）</li><li>细胞松弛素CB（SIGMA C6762）</li><li>二甲基亚砜细胞冻存液DMSO（SIGMA D2650）</li><li>2,2,2-Tribromoethanol（SIGMA-ALDRICH T48402）</li><li>2-Methyl-2-butanol（SIGMA 240486）</li><li>ULTRA PURE WATER（MILLIPORE TMS-006-A）</li><li>PMSG（见溶液配方）</li><li>HCG（见溶液配方）</li><li>2.5%阿佛丁麻醉剂（见溶液配方）</li><li>CB-HCZB（见溶液配方）</li></ol><h4 id="（三）供受体小鼠"><a href="#（三）供受体小鼠" class="headerlink" title="（三）供受体小鼠"></a>（三）供受体小鼠</h4><ol><li>供体雌鼠（C57BL&#x2F;6J、3-4周）</li><li>供体雄鼠（C57BL&#x2F;6J、大于8周）</li><li>假孕雌鼠（ICR、大于6周）</li><li>结扎雄鼠（ICR、大于6周）</li></ol><h3 id="仪器设备"><a href="#仪器设备" class="headerlink" title="仪器设备"></a>仪器设备</h3><ol><li>拉针仪（SUTTER INSTRUMENT P-97）</li><li>煅针仪（NARISHIGE MF-900）</li><li>实体镜（NIKON SMZ800N）</li><li>倒置显微镜（OLYMPUS IX73）</li><li>显微操作系统（NARISHIGE IM-9C）</li><li>离心机（eppendorf 5430）</li><li>CO2恒温培养箱（Thermo i160）</li><li>超洁净工作台（万里 SW-CJ-2FX）</li><li>热台</li><li>磁力搅拌器（CORNING PC-420D）</li></ol><h3 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h3><h4 id="（一）实验动物的准备"><a href="#（一）实验动物的准备" class="headerlink" title="（一）实验动物的准备"></a>（一）实验动物的准备</h4><ol><li>受精卵供应鼠：选用3到4周龄的C57BL&#x2F;6J雌鼠，或根据研究需要选择特定的品系。</li><li>可育雄鼠：选用8周龄以上的C57BL&#x2F;6J雄鼠，最好有过交配记录，或根据研究需要选择特定的品系。</li><li>结扎雄鼠（需提前一个月准备，见相关章节）。</li><li>假孕雌鼠：由6周龄以上ICR雌鼠与结扎雄鼠交配所成，其性周期与受精卵供应鼠保持一致。</li></ol><h4 id="（二）受精卵的制备"><a href="#（二）受精卵的制备" class="headerlink" title="（二）受精卵的制备"></a>（二）受精卵的制备</h4><p>若选用C57BL&#x2F;6J背景鼠作为实验小鼠，选取10只3-4周龄的雌性小鼠，于下午19:00-20:00按5IU&#x2F;只腹腔注射孕马血清(PMSG)，46-48小时之后注射按5IU&#x2F;只腹腔注射人绒毛膜促性腺激素(HCG)，然后与可育雄鼠合笼交配，次日上午选出有阴道栓的雌鼠取受精卵。查栓当天10:00-12:00将有阴道栓的小鼠脱颈椎处死，打开腹腔后将完整的输卵管带一小段子宫剪下，置于FHM操作液中，在解剖镜下找到输卵管的膨大部，用1 ml注射器针头撕开，带有卵丘细胞的卵团自行流出。随后将卵团移入含有lmg&#x2F; ml透明质酸酶(Hyaluronidase)的FHM操作液内1 min，溶去卵丘细胞，立即用预先拉制的吸管将卵子吸至新鲜的FHM操作液中洗涤2-3次，然后再将受精卵吸至另外新鲜FHM操作液中，如此进行4-5次，直至清洗干净。最后将受精卵吸至含多个KSOM培养液滴的35 mm培养皿中，此KSOM培养皿需提前放入二氧化碳恒温培养箱内平衡超过10 min，并用矿物油覆盖。待卵原核发育清晰饱满后即可做显微注射。</p><h4 id="（三）假孕雌鼠的制备（见相关章节）"><a href="#（三）假孕雌鼠的制备（见相关章节）" class="headerlink" title="（三）假孕雌鼠的制备（见相关章节）"></a>（三）假孕雌鼠的制备（见相关章节）</h4><p>在供卵鼠与可育雄鼠合笼当天，挑选处于发情期的ICR雌鼠与结扎雄鼠合笼，第二天早上检查交配情况，选择有阴栓的假孕雌鼠作为受体使用。</p><h4 id="（四）显微注射系统的建立"><a href="#（四）显微注射系统的建立" class="headerlink" title="（四）显微注射系统的建立"></a>（四）显微注射系统的建立</h4><ol><li><p>注射针的拉制<br>选用外径为1 mm，内径0.75 mm-0.8 mm带芯毛细玻璃管，装在水平拉针仪上，拧紧左右两侧的夹子，做好固定，并使其中间部位对准加热丝。设定好电流、拉力和时间。然后按开始键，等待毛细管被拉成两个所需的微注射针头。</p></li><li><p>持卵针（Holder）的拉制<br>选用外径为1 mm，内径0.75 mm无芯毛细玻璃管作为制作持卵针的材料，装在拉针仪上，拧紧左右两侧的夹子，做好固定，并使其中间部位对准加热丝。设定好电流、拉力和时间。按键拉出针坯，用细砂轮在直径为80-100 μm处将玻璃针切断，尽量使断面平齐，然后在煅针仪上处理断面，将断面烧圆。最后用煅针仪铂金丝在距针尖2-3 mm处，将针坯弯成20-30°。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage@main/img/20221017015809_4598.jpg" alt="img"><br>注射针安装<br>左图：注射针角度过大；右图：注射针角度合适</p></li></ol><h4 id="（五）原核注射操作过程"><a href="#（五）原核注射操作过程" class="headerlink" title="（五）原核注射操作过程"></a>（五）原核注射操作过程</h4><ol><li>注射针头装液<br>将制备好的DNA溶液（浓度通常为20-40ng&#x2F;ul）12,000 rpm离心5 min，使用无菌的微量加样器从注射针头的后部加入0.5～1 μl的注射样品。</li><li>将注射针和持卵针安装在显微操作臂上。</li><li>原核注射的操作：<ol><li>在100 mm的培养皿中央制作两排20 μl的CB-HCZB操作液，加入5ml矿物油覆盖。并将培养皿液滴调整到显微镜视野中央，然后吸取10-20枚细胞核清晰的受精卵吹到液滴中央，在吹卵过程中尽量不要吹出气泡以免影响视野。</li><li>用低倍物镜对准受精卵调焦，轻轻的落下针尖，并将注射针尖推入视野中心，通过微操作系统的微调调整注射针位置，直到清晰见到针尖为止。用同样的方法调整持卵针的位置，使持卵针开口端正对注射针尖。</li><li>使用持卵针吸取边缘清晰、形状饱满且细胞核明显的受精卵，调整受精卵的位置，使受精卵体积较大的雄性原核正对注射针尖且两者之间的距离最小。将放大倍数调至工作倍数（目镜20×—40×），进一步调整显微镜焦距和注射针及持卵针的位置，使细胞核和注射针尖均达到最佳清晰程度。推动操纵杆，小心进针，使注射针针尖进入细胞核。</li><li>加大注射压，直到细胞核明显胀大为止。</li><li>轻而迅速往外拔针头，直到离开细胞。</li><li>移动显微镜载物台，找到下一颗受精卵，重复以上步骤。注射完毕，将受精卵放回KSOM培养液中，在恒温培养箱中继续培养，吸取下一批受精卵继续进行，直到注完为止。将注射过受精卵培养过夜。</li><li>经一夜培养，选择发育良好的二细胞期的胚胎用于移植。</li></ol></li></ol><h4 id="（六）胞浆注射"><a href="#（六）胞浆注射" class="headerlink" title="（六）胞浆注射"></a>（六）胞浆注射</h4><ol><li>将离心完的核酸或其他溶液上清通过配套的微量注射枪头经底部加入胞浆注射针（微量注射时，2 μl溶液就足以完成数小时的注射），将针头向下静置数分钟（也可以用胶带纸粘在实验台上），可以明显观察到针尖端的空气慢慢被液体替换，同时可能观察到微小气泡上浮。基因敲除时注射物的浓度一般是：sgRNA 12.5ng&#x2F;μl, Cas9 mRNA 25 ng&#x2F;μl；条件性基因敲除注射物的浓度通常是：sgRNA 5ng&#x2F;μl, Cas9 mRNA 10ng&#x2F;μl, Donor质粒10ng&#x2F;μl 。</li><li>将持卵针与充分静置后的注射针安装上显微操作仪，注射针的角度应尽可能的平（因为胞浆注射针无法像其他显微操作的注射针一样弯折角度，为了确保注射后受精卵的存活率，应尽可能降低注射针与载物台的夹角，详情见图1）。</li><li>在10厘米细胞培养皿盖或其他专用的注射皿上制作数个CB-HCZB液滴，其上覆盖以矿物油，用手持式移卵管转移适量的受精卵至CB-HCZB液滴中。一般情况下，可以明显的分辨出受精卵的两个原核，而未受精的卵母细胞只能观察到1个或无法观察到原核。</li><li>持卵针和注射针调整到视野中心，将微量注射仪程序调至FUNC 4，即持续注射模式，初始压力值可以设置高一些，约在600左右，轻轻地将注射针的针头“撞”在持卵针上或在持卵针上拨动，将针头部封闭处开放。判断是否撞开的标准是，如果将针头靠近受精卵能观察到受精卵开始旋转，则证明针头已经开放。此时第一次调整注射压力，最适值是针头靠近受精卵，受精卵能缓缓的开始旋转，但不会发生剧烈的前后位移。</li><li>在20倍镜下，先用一些状态差的受精卵测试压力，将注射针轻轻扎入卵胞质内，此时可根据情况第二次调整压力，合适的注射压力是根据针头的粗细与是否堵针决定的，理想的注射压力是受精卵被注射的局部区域出现明显膨胀，但受精卵本身又不能产生明显的膨胀。注射压力在10到1000之间都属正常，但针头越细越容易扎入卵胞质，但同时也越容易堵针，如果发现注射时受精卵膨胀的程度显著性降低或者完全没有膨胀，可以使用机器自带的Clean程序将注射针头以较高压力吹洗，如果多次冲洗仍然堵针，可重复4中撞针的步骤，将针头撞的更粗一些，如果针头粗到难以扎破受精卵，则需要重新装液换针。</li><li>测试调整完压力后，就可以开始注射，为了最大化存活率，应尽可能的减少针停留在受精卵内部的时间，以避免受精卵无法封口导致死亡。重复操作直至所有受精卵注射完毕。</li><li>将注射后的受精卵移回KSOM培养液中继续培养，刚注射完的受精卵会残留CB-HCZB，因此在过夜培养前需要反复洗涤几次。</li></ol><h4 id="（七）胚胎的移植"><a href="#（七）胚胎的移植" class="headerlink" title="（七）胚胎的移植"></a>（七）胚胎的移植</h4><p>将经过显微注射，发育到二细胞期的胚胎移植入0.5天的假孕雌鼠体内（具体操作见相关章节）。</p><p>溶液配方</p><ol><li>PMSG配置<br>将PMSG 冻干粉溶于0.9%NaCl 无菌生理盐水,浓度50IU&#x2F;ml，根据实验需要的量分装到1.5 ml EP 管中。-20 °C至少可保存一个月。</li><li>HCG配置<br>将冻干粉溶于0.9%NaCl 无菌生理盐水,浓度50IU&#x2F; ml，根据实验需要的量分装到1.5 ml EP 管中。-20 °C至少可保存一个月</li><li>2.5%阿佛丁麻醉剂配制<br>称取10g 2,2,2-Tribromoethanol后加入10 ml 2-Methyl-2-butanol，240转&#x2F;25℃避光振荡至沉淀完全消失，配制成浓储液。使用时按照2.5%浓度将浓缩液加入相应的ULTRA PURE WATER（2.5 ml浓缩液：97.5 ml超纯水），280转&#x2F;25℃避光振荡至沉淀完全消失，0.25nm过滤器过滤后即为工作液。</li><li>CB-HCZB 配制方法<br>CB先用2.5 ml DMSO充分溶解，配制成浓储液（每管100 μl分装）。使用时每管浓储加400 μl DMSO配成2mg&#x2F; ml的次级浓储液，再每管2.5 μl分装到Ep管中，使用时每管加入1 ml FHM即为工作液。</li></ol><h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><ol><li>1.Andras, N., Marina, G., Kristina, V. and Richard, B.(2003). Manipulating the Mouse Embryo. Cold Spring Harbor Laboratory Press. Cold Spring Harbor, New York.</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;javascript:;&quot;&gt;唐蔚&lt;/a&gt;，&lt;a href=&quot;javascript:;&quot;&gt;李周结&lt;/a&gt;，&lt;a href=&quot;javascript:;&quot;&gt;俞骞&lt;/a&gt;，&lt;a href=&quot;javascript:;&quot;&gt;陈子尘&lt;/a&gt;，&lt;a</summary>
      
    
    
    
    
    <category term="BioProtocol" scheme="http://nikolahuang.github.io/tags/BioProtocol/"/>
    
  </entry>
  
  <entry>
    <title>原核显微注射技术实验1</title>
    <link href="http://nikolahuang.github.io/2024/03/14/%E5%8E%9F%E6%A0%B8%E6%98%BE%E5%BE%AE%E6%B3%A8%E5%B0%84%E6%8A%80%E6%9C%AF%E5%AE%9E%E9%AA%8C/"/>
    <id>http://nikolahuang.github.io/2024/03/14/%E5%8E%9F%E6%A0%B8%E6%98%BE%E5%BE%AE%E6%B3%A8%E5%B0%84%E6%8A%80%E6%9C%AF%E5%AE%9E%E9%AA%8C/</id>
    <published>2024-03-14T15:52:48.000Z</published>
    <updated>2024-04-05T16:56:24.707Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="显微注射室和显微工具的准备"><a href="#显微注射室和显微工具的准备" class="headerlink" title="显微注射室和显微工具的准备"></a>显微注射室和显微工具的准备</h2><h3 id="材料"><a href="#材料" class="headerlink" title="材料"></a>材料</h3><h4 id="试剂"><a href="#试剂" class="headerlink" title="试剂"></a>试剂</h4><ol><li>无 水 乙 醇（9 5 % 和 70%)</li><li>盐 酸（1%)</li><li>SafetyCoat Nontoxic Coating (JTBaker 4017-01) 或 Sigmacote (SigmaAldrich)</li></ol><h4 id="仪器"><a href="#仪器" class="headerlink" title="仪器"></a>仪器</h4><ol><li>4in 的 钝 的 不 锈 钢 针（Custom order: Hamilton Co.， Reno， Nevada) 或者纯的18 G 皮肤穿刺针，连着一段内径为 1&#x2F;32 (0.8in) 软 管（Saint-Gobain PerformancePlastics AJC40001)，软管后面安装固定针。</li><li>钻石或金刚石笔</li><li>符合 DIC 的光学载玻片（2 5 mmX 75 mm, 预先清洁）</li><li>真空砂油（ Dow Corning 1597418)</li><li>微型本生灯</li><li>用 钝 的 18 G 针来替换燃烧器，调节本生灯使其发出非常小的火焰。</li><li>微型毛细管（100ul )</li><li>用钻石或金刚石笔，把 毛 细 管 切 成 2 2mm长（每一个显微注射室准备两段)。</li><li>微 锻 仪（DeFonbrune^type or Narishige-type) 配有双目的复合显微镜； 10 X 光学目镜，其中一个装有十字千分尺；物 镜 4X 、 IOX 和 20X (长工作距离）</li><li>装有箱式的钻丝（2.5 mmX2.5 mm或 3 mmX3 mm) 的 P-87&#x2F;P-97Flaming-Brown</li><li>微电极水平拉针仪（Sutter Instruments, Novato California)</li><li>塑料球形移液管（可任意使用）</li><li>载玻片盒用作无尘储存器</li><li>硅 胶（ GE Silicone II), 真空矽油，或者蜡，把毛细管粘到载玻片</li><li>用于固定针的厚壁毛细管（I .Omm OD X 0. 58 mm ID) (World Precision Instruments, Sutter Instruments)</li><li>用于毛细针的薄壁单管有丝毛细管（I.Omm OD X 0 •75 mm ID) (World PrecisionInstruments, Sarasota, Florida； Sutter Instruments)</li><li>注射器用在硅化时对针产生正压（optional, 见步骤 13)</li><li>连 有 6〜8 cm 长 的 软 管 钝 的 18 G 皮 肤 穿 刺 针（1&#x2F;32[1 〇 ])&lt;3&#x2F;32[OD]\1&#x2F;32[wall])(Saint-GobainPerformance Plastics AJC40001)，软 管 连 接 到 20cc 可任意处置的有卡式胶筒盖注射器。</li></ol><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><h5 id="准备显微注射室"><a href="#准备显微注射室" class="headerlink" title="准备显微注射室"></a>准备显微注射室</h5><p>1•用少量硅胶（GESiliconeII) 将一段 22m m 长 IOOul 的毛细管粘到 25m m X 75m m 预先准备好的载玻片上，毛细管与载玻片长边平行，距离边缘 2 m m 。</p><p>2 •在载玻片的另一边相同位置沿着边再粘一根 22m m 长的毛细管，在运行的组织培养箱内过夜干燥胶水。</p><p>3•用 1 % 盐酸彻底洗净载玻片，用蒸馈水洗几遍，最后用乙醇清洗。</p><p>4•用可随意使用的塑料球形移液管在载玻片间隔加硅胶溶液，然后用强流蒸馏水冲洗几次。</p><p>SafetyCoat Nontoxic Coating 是最好的，但是 S gmacote 也可使用。</p><p>5•把显微注射载玻片在组织培养箱中干燥，为防尘放置于塑料载玻片盒中。<br>显微工具制作：拉取胚胎固定针</p><p>6•在距厚壁毛细管（I. 〇 m m O D X O .58m m I D ) —端 2 &#x2F;3 处 加 热 5mm长 一 截 ，拉长到30m m , 使管径在 1 〇〇〜150um 。</p><p>7.在距离固定针较长一端变细点 10〜15m m 处用金刚笔切割拉长的细管，把长的部分与短的部分间折断。</p><p>8.在微锻仪上检查固定针，确保针头是对称的，没有尖或裂缝，确保在显微注射时做好的固定针能把胚胎固定在正确的位置。如果有必要，在微锻仪上用粗丝切断吸管去形成一个对称的面。</p><p>9.用微锻仪的粗丝磨平吸管，并把吸管的开口弄细到 15〜20um ，如果有必要，在吸管的凸出部做一个 5°的弯曲以使得固定针能平行于注射室的面进入显微注射滴。</p><p>10.用微型本生灯的火焰烤平固定针粗的一端，但注意不能使开口封闭</p><hr><h5 id="显微工具制作：-拉显微注射针"><a href="#显微工具制作：-拉显微注射针" class="headerlink" title="显微工具制作： 拉显微注射针"></a>显微工具制作： 拉显微注射针</h5><p>11 . 用 Sutter Instruments P - 9 7 微电极水平拉针仪制作显微注射针，使用系统默认的参数 ： Heat &#x3D; Rampvalue ; Pu ll &#x3D; 50; Delay &#x3D; 80; Pressure &#x3D; 200。调节参数制作一 个全长 7〜9m m 逐渐变细的针， 使针管从大约 2( V m 迅速地变到最后的 0. 5mm 。</p><p>12•在微锻仪的玻璃珠上轻轻地削尖针尖，使得吸管尖在 0.2〜0.5um (Mann and McMahon 1993) 。</p><p>13.可选择的步骤：在削尖吸管尖之前硅化处理显微注射针，以助于减少细胞物质对针尖的黏附性，增加用单针头注射的卵子的数量。操作如下：</p><p>a•把针安装到 20 cc 的注射器上，注射器连有 10 cm 长的 ID 为 1&#x2F;3 2 的软管。</p><p>b•应用注射器的正压，把针尖浸人用 9 5 % 乙醇稀释的 SafetyCoat Nontoxic 无毒涂料中，浸入两次，每 次 5s。</p><p>c. 立即用 9 5 % 乙醇冲洗针尖，接着用 7 0 % 乙醇，然后浸人 0. 2 2 um无菌过滤的蒸馏水中。</p><p>d. 干燥针尖，然后按步骤 12 描述在微锻仪上削尖。</p><p>对固定针和显微注射针的角度调节</p><p>14.在使用 Leica-型显微操纵仪时不要求在拉完显微注射针和固定针后进一步调节角度。在使用 Rail-Mounted Narishige-型显微操作仪时，有必要把显微操作针和固定针的针头做成 30°〜35°的弯曲，以使得针尖能平行于显微注射室进入显微注射 滴 。</p><h2 id="准备显微注射的-DNA"><a href="#准备显微注射的-DNA" class="headerlink" title="准备显微注射的 DNA"></a>准备显微注射的 DNA</h2><h3 id="材料-1"><a href="#材料-1" class="headerlink" title="材料"></a>材料</h3><h4 id="试-剂"><a href="#试-剂" class="headerlink" title="试 剂"></a>试 剂</h4><ol><li>琼脂糖凝胶</li><li>乙 酸 铵（5m ol&#x2F;L )</li><li>DNA 显 微 注 射 缓 冲 液（10 m mol&#x2F;L Tris-HCl pH 7. 5 、 0.1 mmol&#x2F;L EDTA 、注 射 用 水 满 足 所 有 USP Monograph 要 求 [W F I; Invitrogen ])</li><li>使 用 0• 22um 的 SFCA 无 菌 滤 器 过 滤（Millipore)。</li><li>乙 醇（1 0 0 % 和 9 5 % )</li><li>酚 ：氯仿</li><li>质粒</li><li>用于消化质粒的限制性内切核酸酶</li><li>蔗糖溶液1 0 % (m&#x2F;V ) 和 4 0 % (to&#x2F;V ) 溶 于 lm ol&#x2F;L 的 NaCl 中、 10 mmol&#x2F;L Tris-HCl pH 8. 0、lm m ol&#x2F;L EDTA 用 W F I 水准备。使 用 〇.22fzm 的 SFCA 无 菌 滤 器 过 滤（Millipore)。</li></ol><p>T E 缓 冲 液（10m m o l&#x2F;L T ris-Cl p H 8. 0 ， lm m o l&#x2F;L E D T A )</p><h4 id="仪器-1"><a href="#仪器-1" class="headerlink" title="仪器"></a>仪器</h4><p>Centricon-IO O 微 型 浓 缩 机（A m e rsh a m )</p><p>梯 度 形 成 仪（如 S G 30 g ra d ie n t fo rm e r; A m e rsh a m )</p><p>低 流 动 性 蠕 动 泵（〇 •0 3 〜 8. 2m l&#x2F;m in ) (Y W R S cien tific)</p><p>微 型 离 心 管（I .7m l，无 菌）</p><p>若必要，用 〇.22um的无菌过滤器滤去内毒素的蒸馏水除去尘埃粒子。</p><p>针（25 G )</p><p>橡皮塞</p><p>橡 皮 塞 要 有 18 G 的皮肤穿刺针从塞子的中心由上到下穿过，并且要很适合超速离心机的上部。</p><p>超 速 离 心 管（B eckm an U ltra -C le a r 344060)</p><p>超 速 离 心 机 和 翻 斗 式 超 速 离 心 机 转 子（如 S W 40 T i ; B eckm an-C o u lte r)</p><h4 id="方法-1"><a href="#方法-1" class="headerlink" title="方法"></a>方法</h4><p>1•用限制性内切核酸酶切割 50ug 质粒，从质粒上释放转基因插人片段。黏 粒 DNA 在纯化前用限制性内切核酸酶线性化。</p><p>2•用酚：氯仿抽提，然后用 1 倍体积 5m o l &#x2F; L 乙酸胺、 2. 5 倍体积的 1 0 0 % 的乙醇沉淀，13 O O O g 离 心 30m i n 以上，然后用 50 ug T E 缓冲液悬浮。</p><p>3•按照密度梯度形成仪的说明在超速离心管中倒入两份线性的 1 0 % 〜4 0 % 的蔗糖密度梯度，总体积大约 14 ml。</p><p>4•在一支密度梯度离心管中加入切割的 DNA，使用另一支密度梯度管分离其他片段或者作为平衡。</p><p>5.用显微注射缓冲液精确地平衡蔗糖密度梯度管，质粒切割片段在 4°C , 35 OOOr&#x2F;min离心 4 h; 黏 粒 35 000r&#x2F;min 离 心 24 h。</p><p>6 . 当超速离心机离心速度开始下降时在架子上放置 8 0 个灭菌的无菌的 I.7m l 的微型离心管，在超速离心管的上部插人橡皮塞&#x2F;针，从鹿糖密度梯度上部移走大约 2m l 包含DNA 的液体。</p><p>7•把手指放到塞子上开放的位置，然后把 25 G 的针推进超速离心管的底部， 25 G 的针头进人密度梯度液要小于 5 mm。用塞子上的针控制流速，在每个收集管内收集大约0.2m l 的小片段。</p><p>8.每 4 个收集管用琼脂糖凝胶取一个 5ul等份，确认第一个收集管和最后一个收集管仅包含转基因插人片段。对所有的收集管重复凝胶分析，在凝胶的两边点样孔中分别加人载体+ 插人片段及插入片段。</p><p>9•合并所有的仅包含转基因插入片段的收集管，使 用 Centricon-IOO 微型浓缩机用显微注射缓冲液进行 5〜7 次连续的缓冲液的改变。对于质粒，收率是开始时 DNA 总量2 5 % 〜5 0 % ，对于黏粒是 1 0 % 〜2 5 % 。</p><p>1 0 . 用分光光度剂精确地测量 D N A 的浓度，在琼脂糖凝胶上分析小样本，同相似大小的标准比较。</p><p>11.4°C 存储浓缩的 D N A , 用显微注射缓冲液将 D N A 稀 释 至 2 〜 3ug&#x2F;ml。 在灭菌的、无尘的微量离心管中准备几个 1 〇〇 4 等份的 D N A 为显微注射用。 4°C 至多储存一周。备用 D N A 能在一 20°C 下冷冻，但在显微注射稀释时要小心地完全悬浮 DNA。</p><h2 id="超数排卵和胚胎采集"><a href="#超数排卵和胚胎采集" class="headerlink" title="超数排卵和胚胎采集"></a>超数排卵和胚胎采集</h2><h3 id="材料-2"><a href="#材料-2" class="headerlink" title="材料"></a>材料</h3><p>试剂</p><p>IV -S 型 牛 睾 丸 透 明 质 酸 酶（l 〇 m g &#x2F;m l; S igm a-A ld ric h ) 在 M 2 中（储存液 4 0 X )</p><p>在- 20°C 储存等份。使 用 前 用 M2 稀 释 至 250ug&#x2F;ml。</p><p>CO2 用于胚胎供体小鼠安乐死（备选，见步骤 4b)</p><p>胚胎供体小鼠</p><p>人绒毛促性腺激素（H G G ) (Sigma-Aldrich)</p><p>用灭 菌 的 0.9 % 生理盐水稀释至 500IU&#x2F;m l，-80°C 储 存 0 • I m l 的等份最多 6 个月。</p><p>轻 矿 物 质 油（Sigma-Aldrich，用于毒性或胚胎试验的配对检验)。<br>在松的带盖瓶中在游箱中保存 30〜40 ml 矿物质油，使用这种「平衡，，矿物质油去覆盖 CZB</p><h4 id="一-培养液。"><a href="#一-培养液。" class="headerlink" title="(一) 培养液。"></a>(一) 培养液。</h4><p>培养基</p><p>C Z B 培养基：无葡萄糖的碳酸氢钠缓冲液胚胎培养培养基，用做所有的单细胞胚胎培养，不 分 品 系（ChatotetaL 1989)。用 盐 和 灭 菌 的 无 内 毒 素 的 H 2O 准 备 储 存 溶 液（Nagyetal.2003)。</p><p>M 2 培养基： H E P E S ■缓冲液胚胎悬浮培养基（Quin n etal. 1982 ) 。 用灭菌的除内毒素的蒸溜 水 准 备（N a g y et al. 2 〇 03)或 者 购 买（Sigma-Aldrich of Specialty M e d ia&#x2F;Chemicon ， Temecula ， California) 。 其 他 的 小 鼠 胚 胎 培 养 基（K S O M - A A , M 1 6 ) 能 购 买（ Specialty<br>Media&#x2F;Chemicon) „</p><p>孕马血清促性腺激素(PMSG) (如 Sigma-Aldrich 或 the National HormonePeptide Program [Dr.A.F.Parlow, Harbor UCLA Medical Center, Los Angeles, California]) „</p><p>用 0. 9 % 的灭菌生理盐水，准 备 500IU&#x2F;m l 的储存溶液，一 80°C 储存灭菌的 0. ImI 等份最多6 个月。</p><p>生 理 盐 水（0 . 9 % ，灭菌）作为注射前稀释激素的储存液</p><p>仪器</p><p>浮箱，事先调到 37°C (humidified， 5 % CO2)</p><p>嘴吸管用做胚胎固定</p><p>16〜18in 的 橡 胶 管（1&#x2F;8X3&#x2F;16X 1&#x2F;32) —端连接 10(^1 的毛细管，将附隔离塞吸管尖头尖嘴 切 去 2 —— 3mm ，将其插到橡胶管的另一端，用作胚胎固定针的巴斯德吸管大的末端安到大的附隔离塞吸管尖，另一端为嘴吸管（HPIHospital Products, Apopka, Florida)。<br>皮氏培养皿（3 cm)</p><p>在不同的培养液间移动胚胎时均可照明的立体变焦显微解剖镜（如 Leica MZ7. 5)</p><p>钟表钳子（Cumont no.5 ) (两副），细 解 剖 剪（一副）（ World Precision Instruments; Roboz Surgical Instrument Co.， Inc.， Gaithersburg， Maryland)</p><hr><h4 id="方法-2"><a href="#方法-2" class="headerlink" title="方法"></a>方法</h4><p>胚胎供体小鼠的超数排卵</p><p>1.一般用在<a href="https://pro.biomart.cn/lab-web/que/316nrk8go403k/32r92mggo46fo.html">原核</a>显微注射实验中来源于小鼠系的雌鼠在开始源发性的发情周期 3〜5 周龄前超数排卵，一些品系的小鼠在开始源发性的发情周期后对激素的反应更有效。</p><p>2.PMSG 的标准剂量是 5I U &#x2F;小鼠，在光循环开始后 6〜IO h 后由腹腔注射给药（如下午 12点至下午 4 点并在下午 6 点开灯)。对于有些品系的小鼠增加或减少 2.5IU&#x2F;小鼠，会工作的更好。</p><p>3•在 PMSG 注射 46〜48 h 后通过腹腔以 5IU&#x2F;小鼠的剂量注射 HGG 刺激排卵。 HGG的剂量一般要与早期注射的 PMSG 的量相匹配。在注射了 HCG 后胚胎供体雌性小鼠与能繁殖的雄性小鼠立即配对。来源于自交系的雌性小鼠（如 C57BL&#x2F;6J) 正常受精卵的产量可以提高，当其在注射 HCG 4〜6 h 后不与雄性配对。检测超数排卵的雌鼠阴道内交配栓是交配发生过最强的证据。</p><p>4.受精的单细胞胚胎的恢复与维持按如下描述进行</p><p>a.准备 4 个 3 cm 的皮氏培养皿，每个包含 5 排 5 个 10ul的 CZB 胚胎培养液滴，标上（「Washl」、 「pre」、 「Wash2」 和 「Injected」），用矿物油覆盖，置 于 咖CCV95% 空气的细胞培养箱平衡。在接种胚胎前让平皿在组织培养箱内平衡大于 3Omin</p><p>b. 经过中间暗周期 10〜12 h 后 ，用吸人CO2 的方法安乐处死胚胎供体小鼠，或者通过颈椎脱位法。</p><p>c•解剖每只小鼠的输卵管，小心不要撕开被堆积物质包围的包含单细胞卵的子宫胫。</p><p>d. 在 H E P E S ■缓冲的胚胎悬浮培养基 M2 中冲洗每只小鼠的输卵管壁。</p><p>e. 准备 0 ■ 5m l 包含大约 250 ug&#x2F;m l 的 IV-S 型牛睾丸透明质酸酶的胚胎处理培养基。</p><p>f. 从每只小鼠的输卵取堆积物，放人包含透明质酸酶的 M2 培养基滴中，用钟表镊子过撕开子宫胫。</p><p>g. 在含有透明质酸酶的液滴中搅动堆积物，直到堆积细胞消失。收集卵细胞，立即用不含有透明质酸酶的 M2 培养基冲洗。动作要快。</p><p>h.在 「Washl」培养皿中通过 6 滴冲洗 40〜6 0 组胚胎，然后放一滴在「Pre，，培养皿中，转移胚胎到 CO2 孵箱中。原核在经过中间的暗周期 10〜14h 将变得清晰可见，显微注射应在检测到原核后尽可能快地进行。</p><h2 id="显微注射"><a href="#显微注射" class="headerlink" title="显微注射"></a>显微注射</h2><h3 id="材料-3"><a href="#材料-3" class="headerlink" title="材料"></a>材料</h3><p>试剂</p><p>用于显微注射的 D N A 溶 液（准备见方案 2)</p><p>用做显微注射的受精卵（准备见方案 3)</p><p>氣（Sigma-A ldrich )</p><p>氟用来加胚胎固定针当用油加显微注射器。</p><p>真 空 砂 油（D o w C o m i n g 1597418)</p><p>M 2 培 养 基</p><p>包 含 C Z B 培养基滴的皮氏培养皿（方 案 3 的步骤 4a 中 准 备 的 「 W ash 2 」 和 「 Injected 」 培养皿）</p><p>仪器</p><p>吸水纸</p><p>盖 玻 片（22 mmX22 mmXlmm)</p><p>胚胎固定针（准备见方案 I)</p><p>倒 置显微镜（高质量）有 4 X 明视场， IOX 明视场， 3O〜40X D IC 或 者 HoffmanModulation contrast optics 用作显微注射（如 LeicaMicrosystems, Wexlar, Delaware； NiKon USA, Melville, New York； Olympus America Inc., Melville,New Yord； Carl Zeiss Imaging Inc., Thornwood, New York)</p><p>2 6 mmX 7 6 mm X 1. 5m m 的槽加工为显微镜座插人物的中心，以精确的线性固定着显微注射室 。 6 0mm或 IOOmm 的皮氏培养皿的盖子能与霍夫曼调制相差光学镜一起使用。</p><p>手动显微注射器控制胚胎固定针的吸入（如 Eppendorf， Narishige)</p><p>显微注射室（准备见方案 1)</p><p>显微注射针（准备见方案 1)</p><p>一对显微操纵器（左和右）</p><p>机 械 的 显 微 操 纵 仪（Leitz) 要求一个带有轨道的底座平面，液 压 的 显 微 操 纵 仪（NarishigeInternational, New York) 要求有轨道，上面配有显微镜。</p><p>巴斯德移吸液管（灭菌的）</p><p>吸管架&#x2F;工具袖</p><p>充气防震管（Kinetic Systems Inc. ， Boston, Massachusetts)</p><p>充气显微注射器 械（如 Femtojit Eppendorf AG， Hamburg)</p><p>用来从显微注射针移走泡注射器</p><p>连着 6〜8 cm 长 的 软 管（1&#x2F;32IDX 3&#x2F;32 O D X 1&#x2F;32 wall ) (Saint-Gobain Performance PlasticsAJC4 0 001) 的、钝 的 18 G 腹腔注射针，软 管 连 接 到 20cc 有卡式胶筒盖可随意使用的注射器上。</p><p>U V 分光光度计</p><p>方法</p><p>构建显微注射滴</p><p>1.若在方案 2 准备的 2ug&#x2F;ml DNA 溶液被预先冻好，彻底地混合它以保证 DNA 被完全地溶解。用紫外分光光度计检查溶液的浓度（A260)。</p><p>2 . 4℃， 14 000 g•离心 DNA 溶液 30 min，置于冰上。</p><p>3.用真矽油填充显微注射室（准备见方案 1 ) 上部毛细管的两个空间，吸取 300〜400ul的 M 2 培养基滴到间隔间，形成椭圆滴。在上面放一个盖玻片，轻轻地推使密封。在液滴周围填充轻质矿物质油（图 1 ) 。</p><p>4 . 用氟填充胚胎固定针，插针进人工具袖，其与微注射器相连。把工具袖放入显微操作仪。</p><p>5 . 调节固定针的角度，以便使针尖与显微注射室的表面平行。</p><p>6.用一张吸水纸盖住显微镜台座空白地方，防止液体从固定针流出，滴进显微镜目标。</p><p>7•拉一个灭菌的巴斯德吸液管到 10〜12c m 长，直径大约 0 •15m m ，从上层吸取 D N A溶液，避开颗粒物质。把加样针插入显微注射针的凸部，吸 取 2〜5ul D N A 溶液。</p><p>8.DNA 溶液不会从注射针内流出，直到所有的气泡被移走。这个过程能通过使用下面方法显著的加快。</p><p>a•安装 20cc 注射器，注射器连有橡胶管，橡胶管上有塞子，将针粗末端插入塞子。</p><p>b. 弯曲橡胶管，以使针尖向下，运用轻轻拍打针尖时产生的正压驱除所有气泡。</p><p>9.把显微注射针插入工具袖，把工具袖放人显微操作仪。工具袖应该与显微操作仪的固定夹成一排，以便显微工具被作为中心，恰好与显微注射室的长轴平行。调节工具袖的倾斜度，以便显微注射针几乎与显微注射室的表面平行。</p><p>10•调节充气的显微注射针的注射压（Pi) 到 70〜 IOOhPa, 固 定 压（Ph) 到大约5 0 % Pi。</p><p>11.提升在显微操作室的工具袖直到针尖距离显微注射室的边缘大约 2 mm，然后拧紧固定夹。</p><p>12.用几滴轻矿物质油下的 M2 培养基冲洗保存在 37°C ， CO2 孵箱中 CZB 微滴中卵子。</p><p>1 3 . 从显微镜底座移走显微注射室，在 M 2 滴中心的垂线上沉淀卵子，从液滴的中点开始 ，延伸到顶部。</p><p>1 4 . 在低放大率下，向前推进固定针和显微注射针，直到它们与胚胎一样在一个小的视角内可见。保持固定针与注射针分离，以免损坏针尖。</p><p>1 5 . 旋转到 IOX 物镜，调节固定针和显微注射针的高度，直到它们与胚胎在同一个焦平面，重复调节直到最大的放大率。</p><p>1 6 . 固定针尖应几乎触及注射室的表面，应与胚胎在同一个焦平面。调节固定针的角度与 f 面斜度，以使固定针移动没有明显的震动。</p><p>原核显微注射</p><p>1 7 . 用固定针吸起一个卵子，在高放大率下检查。在一个受精卵中应该仅有两个原核是可见的，在原核内有一个或多个核仁。单个原核暗示着卵子没有受精，卵子内有大于 2 个原核则其不能正常发育。</p><p>1 8 . 焦点对准显微注射针，当充气注射器的注射功能激活时，在针尖找一个非常小的旋涡液滴。若没有见到，或许有必要轻轻地把它推进人固定针轻打开针尖。若启动注射功能时在针尖产生一个大的旋流，注射针会引起过量的卵子溶解。如 果 DNA 溶液缺乏或过量在进行前换针。</p><p>1 9 . 调节卵子的位置，以使较大的原核和固定针的针尖都在准聚焦。<br>靶原核应该位于卵子的中心附近，卵子的质膜会很难穿透。理想的，原核将被定位，以使显微注射针在刺穿质膜时不会碰到任何的核仁。</p><p>20.确保胚胎被固定针牢牢地固定，然后放置注射针直到针尖直接在靶原核的下面(6 o’ clock) , 调节针的高度（2 轴）直到显微注射针和原核膜恰在同一焦平面。原核膜看起来像一条好的环线，核仁通常也在准焦平面内。显微注射针尖可能很难清晰地看见，因此调节针的高度，直到上下边缘锋利可见，然后在针尖处合并为一（图 2 , 见彩版)。<br><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage@main/img/A1470797127351992mpraganpng_small.jpg" alt="img"></p><p>21.把针尖放在原核相反的方向，瞄准没有核仁的区域，推进透明带和质膜，以一个单一平稳运动进入原核。一旦当穿刺针穿透透明带与质膜时，卵子的表面会收缩，然</p><p>22.如果针不能刺穿卵子质膜或者原核膜，小 的 「气泡」会出现在针尖。如果这种现象发生，从卵子抽出针尖，把原核膜和针尖放到焦平面，重复显微注射过程。</p><p>2 3 . 进行显微注射，用 5〜6 滴 CO2 平衡了的 C Z B 培 养 基（「 Wash2」 培养皿）冲洗注射的卵子，培 养 60 min ( 「Injected」 培养皿）去评估生存率（这些培养皿是在方案3 的步骤 4a 中准备的）。</p><p>显微注射后卵子的成活，依赖于个人的技巧及所用的小鼠的品系。典型的，大 于 9 0 % 的卵子在显微注射过程中成活。</p><h2 id="胚胎移植"><a href="#胚胎移植" class="headerlink" title="胚胎移植"></a>胚胎移植</h2><h3 id="材料-4"><a href="#材料-4" class="headerlink" title="材料"></a>材料</h3><p>试剂</p><p>麻醉剂</p><p>已经显微注射的卵子&#x2F;胚 胎（如方案 4 中）</p><p>理想地，经过一个简短的接种显微注射过程存活的卵子移植到〇.5dpc (days postcoitus) 假孕受体雌性小鼠体内。如果得不到雌性受体小鼠，体 外 在 CZB 培养基中培养卵子到多细胞胚胎阶段。</p><p>受体雌性小鼠</p><p>使 用 6〜9 周 龄 的 杂 交 （如 F1 或 F2 C57BL&#x2F;6XCBACa&#x2F;J) 或者远交品系。</p><p>输卵管结扎雄性小鼠</p><p>仪器</p><p>玻璃移液吸管 （120〜150u m )</p><p>揭开假孕受孕小鼠生殖管的工具</p><p>立体变焦解剖显微镜光纤照明用做外科胚胎转移 （如 Leica M Z 7 .5)<br>手 术 针 （9m m )</p><p>方法</p><p>假孕受孕雌性小鼠的准备</p><p>1.在胚胎移植手术进行的前一晚上，雌性受体与结扎输精管的雄性小鼠配对。</p><p>2 . 在第二天中午 12 点前，检查雌性小鼠阴道是否存在交配栓。<br>发现有交配栓的雌鼠终止 0 • 5dpc, 因为交配在暗周期中发生了。<br>把胚胎移植到假孕受孕受体小鼠</p><p>3 . 麻醉一个 0.5d p c 的假孕受孕雌性小鼠，准备无菌外科手术，通过腹部中央切割手术取出一边的生殖管道。</p><p>4 . 把卵子&#x2F;胚胎加人一个 120〜150um 的玻璃移液管中，打孔或小心地撕开卵巢囊，出血最少，把卵子&#x2F;胚胎移植到子宫囊口。</p><p>5.若有必要，剪开另一侧的腹腔及生殖道，重复上述操作。</p><p>6•用 9 mm 的手术针把切口缝起。</p><p>根据经验，显微注射胚胎的 20%〜40% 产生活胎，因此，移 植 大 约 30 个胚胎到雌性受体,会产生合适的数量。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h2 id=&quot;显微注射室和显微工具的准备&quot;&gt;&lt;a href=&quot;#显微注射室和显微工具的准备&quot; class=&quot;headerlink&quot; title=&quot;显微注射室和显微工具的准备&quot;&gt;&lt;/a&gt;显微注射室和显微工具的准备&lt;/h2&gt;&lt;h3 id=&quot;材料&quot;&gt;&lt;a h</summary>
      
    
    
    
    
    <category term="BioProtocol" scheme="http://nikolahuang.github.io/tags/BioProtocol/"/>
    
  </entry>
  
  <entry>
    <title>气道上皮细胞及其干细胞和祖细胞</title>
    <link href="http://nikolahuang.github.io/2024/03/14/%E6%B0%94%E9%81%93%E4%B8%8A%E7%9A%AE%E7%BB%86%E8%83%9E%E5%8F%8A%E5%85%B6%E5%B9%B2%E7%BB%86%E8%83%9E%E5%92%8C%E7%A5%96%E7%BB%86%E8%83%9E/"/>
    <id>http://nikolahuang.github.io/2024/03/14/%E6%B0%94%E9%81%93%E4%B8%8A%E7%9A%AE%E7%BB%86%E8%83%9E%E5%8F%8A%E5%85%B6%E5%B9%B2%E7%BB%86%E8%83%9E%E5%92%8C%E7%A5%96%E7%BB%86%E8%83%9E/</id>
    <published>2024-03-14T14:57:05.000Z</published>
    <updated>2024-04-05T16:55:35.648Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage@main/img/image-20240314225928932.png" alt="image-20240314225928932"></p><p>来源：<a href="http://www.nwbiotec.com/index.php?g=&m=article&a=new_nav_list&newid=303">诺为生物</a></p><h2 id="人体呼吸道上皮细胞"><a href="#人体呼吸道上皮细胞" class="headerlink" title="人体呼吸道上皮细胞"></a>人体呼吸道上皮细胞</h2><p>人类在呼吸过程中，吸入外界空气，空气中的氧气通过呼吸进入循环系统，同时体内细胞产生的二氧化碳通过肺泡和毛细血管的气体交换排到 外界空气中。呼吸道具有加温、湿润、过滤等保护功能。在换气前，呼吸道会将吸入的空气变暖，变湿，然后温暖湿润的空气将会直达肺部的最远端，同时可以保护肺部免受病原体及大气污染物的侵袭。人体呼吸道可分为传导区和呼吸区。</p><p>传导区包括鼻腔通道、气管、主支气管、肺内支气管 和细支气管，不参与换气流程。从气管到未端细支气管，随着呼吸道的不断分支，各级分支的直径和长度逐步缩小缩短。呼吸区包括呼吸性细支气管、肺泡管和肺泡囊。呼吸区是指肺腔内吸入的空气与肺毛细血管中的 血液进行换气(经肺通气进入人肺泡的新鲜空气与血液进行气体交换，氧气从肺泡顺着分压差扩散到静脉血，而静脉血中的二氧化碳，则向肺泡扩散的场所。[1,2]</p><p>从鼻腔通道到肺泡囊的整个人体呯吸道覆盖着一层连续的上皮细胞，但是传导区和呯吸区的上皮细胞在形态和细胞成分上却各有不同。在包括鼻腔通道、气管和支气管在内的传导区的最近端部位，呼吸道上皮细胞的形态为<strong>假复层纤毛柱状上皮细胞</strong>。距离传导区越远(分支增多，呼吸道内径缩小)，此上皮细胞的厚度越薄，且在小呼吸道(细支气管)形成类似立方上皮细胞。大呼吸道上皮细胞主要由三种细胞类型构成:可分泌粘液的 杯状细胞、可通过与顶部纤毛进行协同摆动而促进粘液运动的纤毛细胞，以及在基底膜上排列目不与上皮细胞顶面接触的基底细胞。细支气管内 的立方上皮细胞由两种细胞类型构成:分泌细胞和纤毛细胞，但是其含有 的纤毛细胞数量要比近端大呯吸道所含数量要少。肺泡上皮细胞分为!型 肺泡上皮细胞和川型肺泡上皮细胞(AEC)。肺泡细胞通过毛细血管的内 皮细胞基膜，与内皮细胞融合，形成换气屏障。整个呼吸道内的细胞均为 各种低活跃度的细胞，包括大呼吸道内的神经内分泌细胞、分布在肺间质 内的肺泡巨噬细胞(吞噬细胞)(其主要作用是清除气腔内存在的和吸入 的空气中的尘粒、细菌等异物)。[13]</p><hr><h3 id="上皮细胞屏障和防御功能"><a href="#上皮细胞屏障和防御功能" class="headerlink" title="上皮细胞屏障和防御功能"></a>上皮细胞屏障和防御功能</h3><p>呼吸道上皮细胞在协调空气进出肺泡的过程中，发挥着重要作用。呼吸道 上皮细胞可以阻挡和清除随空气进入呼吸道的颗粒、异物，使进入肺泡 的气体几乎清洁无菌，这一防御作用至关重要。其主要的防御手段是综合 利用分泌细胞和纤毛细胞的功能，因为分泌细胞会分泌出粘液，覆盖在纤 毛细胞的纤毛上，纤毛协调摆动，将粘液层与附着在粘液层上的随空气吸 入呼吸道的异物向咽喉方向移动，直至到达咽部，被吞咽或咳出。4,5其他,各种宿主防御机制也保证了呼吸道上皮细胞可以正常有效的发挥保护作 用。重要的是，上皮细胞层并非是独立发挥防御作用，而是与其他上皮细 胞、间充质细胞、内皮细胞和细胞外基质一起，作为共生的功能单元，协调 发挥作用。6.7.8<br>另外上皮细胞可以通过细胞间连接形成另一层防御屏障，有效的阻止病原 体或有毒物质进入体内。通过细胞间紧密连接，控制阻渗层，限制顶层腔 室和基底外侧腔室间分子的被动流动。细胞间紧密连接也是维持离子和 溶质体内平衡的重要因素，从而实现对呼吸道表面液体厚度和离子组成 控制，这是保护肺部的必要手段。。<br>尽管人上呼吸道存在这些有效的防御系统，但是呼吸道上皮细胞长期接 触外部空气，必然导致经常受损。呼吸道上皮细胞受损后，导致基底膜部 分或全部外露，仅有基底细胞群与基底膜相连。这些结构与功能的典型变,异是由肺部每天饱受各种自然颗粒物、人为颗粒物、纤维物质和化学品 等各种随空气吸入的物质的伤害而形成，由此导致患上慢性支气管炎、哮喘、慢性阳塞性肺病(COPD)或囊胞性纤维症(CF)等各种呼吸疾病。一旦受损，呼吸道上皮细胞会自动进行修复，以期恢复细胞屏障的完整性 和正常的上皮细胞功能，但是这些修复机制尚未完全为人所知。[1,5,10,11]</p><hr><h3 id="呼吸道特定区域的干细胞与祖细胞"><a href="#呼吸道特定区域的干细胞与祖细胞" class="headerlink" title="呼吸道特定区域的干细胞与祖细胞"></a>呼吸道特定区域的干细胞与祖细胞</h3><p>呼吸道上皮细胞一直进行着缓慢而持续的动态代谢平衡。当发生中轻度 损伤，呼吸道上皮细胞会及时做出反应，重建上皮细胞层，恢复其正常的 结构和功能。这个上皮细胞修复的过程主要由呼吸道干细胞和祖细胞来 完成。11-18<br>上皮祖细胞生物学领域内，描述不同祖细胞的术语有些复杂而没有统一 标准化。在本篇综述中，我们用”祖细胞”一词来概括地定义相对而言未分 化的，具有增殖和分化潜能的细胞，而干细胞属于祖细胞里的一种罕有细 胞，具有持续增殖、自我更新和多向分化潜能。相比之下，很多成年祖细胞,是短暂扩充细胞，可以广泛增殖成为终未分化细胞，但是与干细胞相比，其寿命周期有限。12,13,19<br>有证据表明:不同种类的上皮于细胞和祖细胞分布在肺部的,位置不同:基 底细胞分布在气管和大支气管，2细支气管肺泡于细胞(BASC)分布在细 支气管肺泡管连接处(BADJ)，21型肺泡上皮细胞则分布在肺泡区。22</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage@main/img/image-20240314230826194.png" alt="image-20240314230826194"></p><hr><h3 id="基底细胞"><a href="#基底细胞" class="headerlink" title="基底细胞"></a>基底细胞</h3><p>越来越多的证据表明:基底细胞为分布在气管支气管部位的多能祖细胞，在出生后不同发育阶段和稳态周期内，既可讲行自我更新，又可形成纤毛 细胞谱系和分泌细胞谱系，并且可以在上皮细胞受损后，进行修复。以上认知是从体内遗传谱系示踪研究和体外培养(气波界面(ALI)培养和三 维球状形态(克隆形态)培养中总结出来20,23,24 这些方法均需用标志物对基底 细胞进行精准标示，但是这些标志物对基底细胞祖细胞的功能的。在运用此类培养技术，可以 发挥单细胞自我更新和分化的潜能。上的重要 性尚不明确，应用最广泛的基底细胞标志物有P63、IGTA6、NGFR、KRT5 和KRT14。19,20.23:27所有这些标志物中，最为常用的是KRT5和KRT14。KRT5 可以在所有的基底细胞中进行标记，而只有当上皮细胞的代谢速率较低 时，通常采用 KRT14来标记出稳态子代基底细胞。2 这就说明:不同基底 细胞间存在功能异质性，只有少数基底细胞能够形成多个成熟细胞谱系。根据KRT14-CreER追踪，对小鼠气管和支气管上皮细胞进行的谱系示踪 研究的结果表明:在呼吸道受损的情况下，基底细胞子代可转化为多能或 单能细胞。<br>在对因强酸、洗涤剂或系统性萘摄入等各种介质摄入而使腔细胞受损，进 而进行修复的过程中，用KRT5和KRT14进行标记的双阳性基底细胞，无论,是单独存在或是以小集群形式存在的，均呈现出暂时性的数量增加。这一 结果表明:当基底细胞被激活“进行增殖时，KRT14标志物的表达水平上 调，23.28 但是，还有研究结果认为所有的基底细胞均能进行多向分化，而且 基底细胞祖细胞的分化命运是受到局部环境和损伤机制的影响。20<br>与人体肺部的再生疗法实际相关的一个问题是:基底细胞是否是唯一能 有效修复假复层上皮细胞的细胞，或分化的细胞是否能在特定条件下返 回祖细胞&#x2F;或转分化成其它分化细胞，在Raia00pa实验室近期发表的一 篇主要论文中，采用了一种方法专门杀死小鼠体内气管中的KRT5+标志物 和基底细胞，29 在这种情况下，研究人员发现分化的 SCGB1A1+分泌细胞 可返回到祖细胞状态，转而成为P63和 KRT5标记的双阳性基底细胞。这 些基底细胞能够长期积蓄，与正常的KRT5+标记的祖细胞功能相似。通过 体外培养，论文作者进一步证明:基底细胞之间的细胞间连接可以阻止表 层分化细胞的去分化，但是还需对去分化的重新驱动程序的精准机制以 及随后产生的干细胞功能进行进一步研究。[29]</p><hr><h3 id="分泌细胞-Club-cell"><a href="#分泌细胞-Club-cell" class="headerlink" title="分泌细胞(Club cell)"></a>分泌细胞(Club cell)</h3><p>与人体肺部的再生疗法实际相关的一个问题是:基底细胞是否是唯一能有效修复假复层上皮细胞的细胞，或分化的细胞是否能在特定条件下去分化或转分化。在Rajagopal实验室近期发表的篇主要论文中，采用了一种方法专门杀死小鼠体内气管中的KRT5<em>标志物和基底细胞，在这种情况下，研究人员发现分化的 SCGB1A1+分泌细胞可返回到祖细胞状态，转而成为P63和 KRT5标记的双阳性基底细胞。这些基底细胞能够长期积蓄，与正常的KRT5</em>标记的祖细胞功能相似，通过体外培养，论文作者进一步证明:基底细胞之间的细胞间连接可以阻止表层分化细胞的去分化。但是还需对去分化的重新驱动程序的精准机制以及随后产生的干细胞功能进行进一步研究。</p><hr><h3 id="细支气管肺泡干细胞-BASC"><a href="#细支气管肺泡干细胞-BASC" class="headerlink" title="细支气管肺泡干细胞(BASC)"></a>细支气管肺泡干细胞(BASC)</h3><p>最细小的未端细支气管与肺泡之间的过渡区被称之为细支气管肺泡管连 接处。小鼠体内的此部位包含纤毛细胞和分泌细胞，但是人体内的此部位 所分布的细胞，尚不明确。将小鼠体内细支气管肺泡管连接处的少量细 胞(每个气管有1-2个胞)共同标记为Scob1a1(分泌细胞)和肺泡表面活 性蛋白C(Shpc)，肺泡表面活性蛋白C是I型肺泡上皮细胞特有的一种蛋 白。其结论为:此类双阳性细胞为细支气管肺泡千细胞。之所以被称之为 细支气管肺泡干细胞，是因为当被荧光活化细胞分选方法所分离时，此类细胞会在培养皿中生成细支气管细胞和肺泡细胞。[30]Kim及其同事 进一步通过采用精致的3D克隆共同培养方法，证明了肺内皮细胞中的 BMP4-NFATC1-TSP轴可以诱导细支气管肺泡干细胞分化成肺泡谱系。[21]</p><hr><h3 id="II型肺泡上皮细胞-AEC2"><a href="#II型肺泡上皮细胞-AEC2" class="headerlink" title="II型肺泡上皮细胞(AEC2)"></a>II型肺泡上皮细胞(AEC2)</h3><p>气体交换部位的主要上皮细胞类型包括:立方II型肺泡上皮细胞(主要生 产和分泌表面活性蛋白)和扁平的!型肺泡上皮细胞(主要进行换气)。成 年小鼠的肺泡部位的细胞新陈代谢一般比较慢，因此很难追踪到稳态的 谱系关系。但是，在对肺泡细胞进行实验性损伤，或让其接受氧化应激作 用的情况下，存活的细胞将快速增殖，并激活细胞修复机制。</p><p>过去40年一直采用H3胸昔标记法进行的研究结果表明，当因组织内氧气,过多或一氧化碳过多导致上皮细胞受损后，成年猴和小鼠的”型肺泡上皮 细胞会进行增殖，并形成型肺泡上皮细胞。近期，针对体内遗传谱系示踪 的研究肯定了成熟的川型肺泡,上皮细胞有这种自我更新和分化能力。上述 体内遗传谱系示踪研究采用与终未分化细胞(包括肺泡表面活性蛋白C和Lyz2)相关的基因驱动的Cre重组酶，在稳态的新陈代谢情况下，单个!型 肺泡,上皮细胞很少发生克峰性增殖，亦很少分化为(型肺泡上皮细胞。当博菜霉素和氧气过多对肺泡部位造成损伤之后，标记为”型肺泡上皮细胞,的谱系分化为|型肺泡上皮细胞的比例明显增高。[22,31-34]</p><p>近年来，干细胞和祖细胞谱系的识别以及这些细胞在成人体内的活动的,相关研究发展很快。相对而言，分子水平的信号通道对细胞行为的调控方 面的研究发展缓慢普遍认为，个体发育过程中使用的主要分子信号通 路在肺部细胞修复过程中被激活而发挥着重要作用，但是这些观点需要 进一步在生理或临床相关实验模型上测试证明。探索肺形成的机制，尤 其是肺泡形成领域的研究，方兴未艾。支气管上皮的气液界面培养系统， 和近几年流行起来的体外类器官培养(支气管类器官和肺泡类器官)系统 为解决这些呼吸领域的问题提供了最佳的技术支撑和研究平台。</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage@main/img/image-20240314231028998.png" alt="image-20240314231028998"></p><hr><p>Reference</p><p>1.Berube K, et al. Altern Lab Anim 37:89-141.2009<br>2.Crystal RG, et al Proc Am Thorac Soc 5:772-777,200<br>3.Kaisani A,et al. Differentiation 87:119-126.2014<br>4.Randell SH.Proc Am Thorac Soc 3: 718-725.2006<br>5.LivraghiA and Randell SH. Toxicol Pathol 35:116-129.2007<br>6.Rock JR.et al Proc Natl Acad SciU SA 108: E1475-1483.2011<br>7Weaver M,et al. Dev Biol 258:169-184.2003<br>8.Knight DA, et al. Expert Rev Respir Med. 4(6):747-58.2010<br>9.Matsui H,et al J Clin Invest 102:1125-1131.1998<br>10.Rawlins EL, et al. Proc Natl Acad Sci U SA 104: 410-417.2007<br>11.BorokZ,et al.Proc Am Thorac Soc 8:215-222.2011<br>12.Hogan BL,et al. Cell Stem Cell 15:123-138.2014<br>13.Kotton DN and Morrisey EE.Nat Med 20:822-832.2014<br>14.Rock JR and Hogan BL. Annu Rev Cel Dev Biol 27: 493-512.2011<br>15.Rock JR,et al. Dis Model Mech 3:545-556.2010<br>16.Stripp BR and Reynolds SD. Proc Am Thorac Soc 5: 328-333, 2008<br>17.Wansleeben C,et al. Dev Biol 2:131-148.2013<br>18.HackettTL,et al.Stem Cells 26(10)2576-85.2008<br>19.Reynolds SD, et al. Proc Am Thorac Soc 9: 27-37.2012<br>20.Rock JR, et al Proc Natl Acad SciU S A 106: 12771-12775.2009<br>21.Lee JH, et al. Cell 156:440-455.2014<br>22 Barkauskas CE et al J Clin Invest 123:3025-3036.2013<br>23.Cole BB,et al. Am J Pathol 177:362-376.2010<br>24.Ghosh M, et al Am J Respir Cell Mol Biol 45:459-469.2011<br>25 .Ghosh M,et al Stem Cells 31:2767-2778,2013<br>26.Ahmad S, et al. Am J Respir Cell Mol Biol 48:94-104,2013<br>27.Ghosh M,et al Am J Respir Cell Mol Biol 45:403-410,2011<br>28.Ghosh M, et al Am J Respir Cell Mol Biol 49:1127-1134.2013<br>29 Tata PR et al Nature 503:218-223.2013<br>30.Giangreco A,et al.AmJPathol 161:173-182.2002<br>31.Desai TJ,et al. Nature 507:190-194.2014<br>32 Evans MJ,et al Exp Mol Mathol 22 142-150.1975<br>33.Evans MJ,et al Am J Pathol 70:175-198.1973<br>34.Kaplan HP et al.Lab Invest 20:94-100.1969</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/nikolahuang/blogimage@main/img/image-20240314225928932.png&quot; alt=&quot;image-202403142259289</summary>
      
    
    
    
    
    <category term="BioLearning" scheme="http://nikolahuang.github.io/tags/BioLearning/"/>
    
  </entry>
  
  <entry>
    <title>卵母细胞常规操作</title>
    <link href="http://nikolahuang.github.io/2024/03/14/%E5%8D%B5%E6%AF%8D%E7%BB%86%E8%83%9E%E5%B8%B8%E8%A7%84%E6%93%8D%E4%BD%9C/"/>
    <id>http://nikolahuang.github.io/2024/03/14/%E5%8D%B5%E6%AF%8D%E7%BB%86%E8%83%9E%E5%B8%B8%E8%A7%84%E6%93%8D%E4%BD%9C/</id>
    <published>2024-03-14T14:17:56.000Z</published>
    <updated>2024-04-11T07:14:04.836Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h2 id="卵母细胞-siRNA-显微注射"><a href="#卵母细胞-siRNA-显微注射" class="headerlink" title="卵母细胞 siRNA 显微注射"></a>卵母细胞 siRNA 显微注射</h2><ol><li><p>由吉玛公司设计三组 siRNA，见下表:<br><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage@main/img/image-20240314221959543.png" alt="image-20240314221959543"></p></li><li><p>将3对ECATI siRNA 分别用 DEPC水溶解，之后将3对ECAT1 SiRNA 混合一起待用;</p></li><li><p>显微操作液滴制作:   在60cm培养皿盖的中央，用<strong>缓冲液G-MOPS PLUS</strong>做成长条形液滴，吸取2ul左右的ECAT1 SiRNA混合液或者NC SiRNA在<strong>G-MOPS PLUS</strong> 液滴一侧做成小滴, 之后盖上石蜡油,放置在热台上预热到 37℃;  (G-MOPS PLUS from Vitro Life）</p></li><li><p>显微操作仪准备:  打开显微操作系统(包括显微镜,操作手柄,热台和电脑)，安装预先准备好的持卵针和注射针，并进行调试; </p></li><li><p>在体式显微镜下，用口吸管将卵母细胞移到第3步的<strong>G-MOPSPLUS</strong>液滴中，将培养皿盖放置在显微操作台上;</p></li><li><p>将持卵针和闭合的注射针的针尖均调节到G-MOPSPLUS 液滴中，并保证在同一高度上，用注射针尖撞击持卵针，将注射针针尖撞断，使其开口;</p></li><li><p>开口的注射针不断吸吐 G-MOPSPUUS用来清洗，清洗几次后将注射针移到ECAT1 SiRNA 混合液或者NCSRNA液滴中，同样清洗数次；</p></li><li><p>注射针吸取适量的 ECATISiRNA 混合液或者 NCSiRNA 液体，之后将其移到 G-MOPSPLUS 液滴中，持卵针固定卵母细胞，注射针扎进卵母细胞，将适量 SiRNA 混合液或者NC SiRNA 液体注射进去。之后将卵母细胞放置在培养箱进行培养。</p></li></ol><hr><h3 id="卵母细胞体外成熟"><a href="#卵母细胞体外成熟" class="headerlink" title="卵母细胞体外成熟"></a>卵母细胞体外成熟</h3><ol><li>人 <strong>IVM 培养液</strong>在 35cm 培养皿中做成数个小液滴，覆盖石蜡油，做好标记;</li><li>将上步中培养皿放置在培养箱中预平衡;</li><li>用口吸管将卵母细胞转移到预平衡的IVM 培养液中，放置在培养箱进行培养。</li></ol><hr><h3 id="卵母细胞斑点印记分析"><a href="#卵母细胞斑点印记分析" class="headerlink" title="卵母细胞斑点印记分析"></a>卵母细胞斑点印记分析</h3><ol><li>将卵母细胞放在 RIPA 裂解液(添加蛋白酶抑制剂)中，冰上裂解20min，之后用移液枪吹打；</li><li>简短离心收集裂解液，放置在100℃热台上变性蛋白;</li><li>待冷却后，简短离心;</li><li>用移液枪吸取2ul蛋白裂解液点在PVDF膜上，使之成斑点状；</li><li>自然干燥后，用5%牛奶(TBST配制)封闭1h;</li><li>稀释一抗到合适浓度，滴加在膜上，4℃过夜孵育;</li><li>TBST洗3次，每次10min;</li><li>HRP标记的二抗室温孵育1.5h;</li><li>TBST洗3次，每次10min;</li><li>显影液避光孵育5min，进行显影拍照。</li></ol><hr><h3 id="猴卵胞浆内单精子注射"><a href="#猴卵胞浆内单精子注射" class="headerlink" title="猴卵胞浆内单精子注射"></a><strong>猴卵胞浆内单精子注射</strong></h3><p>from：<a href="https://bio-protocol.org/exchange/protocoldetail?id=1010985&type=1">https://bio-protocol.org/exchange/protocoldetail?id=1010985&amp;type=1</a></p><p>胞浆内单精子注射（Intracytoplasmic Sperm Injection，ICSI），是指通过显微操作技术将单个精子注入卵母细胞胞浆内，从而使卵母细胞受精的一种辅助生殖技术。与传统的体外受精相比，ICSI对精子活力、数量及受精能力的要求较低，在临床上是第 2 代“试管婴儿”的关键技术。在科研领域，ICSI 可结合其他生物工程技术，制备基因编辑动物模型。此外 ICSI 也是精子冷冻复苏构建受精胚胎的重要辅助手段。本文详细描述了猴胞浆内单精子注射的操作方法及流程。</p><hr><h4 id="材料与试剂"><a href="#材料与试剂" class="headerlink" title="材料与试剂"></a>材料与试剂</h4><ol><li>3.5 cm 培养皿（CORNING，catalog number: 430165）</li><li>3.5 cm 操作皿（FALCON，catalog number: 353001）</li><li>Borosilicate Glass（B100-75-10）</li><li>矿物油（Sigma，catalog number：M8410）</li><li>口吸管（北京正天，catalog number：BJ-40）</li><li>移液枪 （Eppendorf）</li><li>15 ml 离心管（Corning，catalog number：430791）</li><li>一次性使用无菌注射器带针（KDL 1ml）</li><li>PVP（Sigma，catalog number：PVP360）</li><li>水银</li><li>TH3液（见溶液配方）</li><li>T3液（见溶液配方）</li><li>HECM9aa培养液（见溶液配方）</li><li>NaCl（Sigma-Aldrich，catalog number：S7653）</li><li>KCl（Sigma-Aldrich，catalog number：P5405）</li><li>CaCl2·2H2O（Sigma-Aldrich，catalog number：C7902）</li><li>MgCl2·6H2O（Sigma-Aldrich，catalog number：M2670）</li><li>NaH2PO4（Sigma-Aldrich，catalog number：S8282）</li><li>NaHCO3（Sigma-Aldrich，catalog number：S5761）</li><li>HEPES（Sigma-Aldrich，catalog number：H3375）</li><li>D-Glucose（Sigma-Aldrich，catalog number：G7528）</li><li>Sodium Pyruvate（Sigma-Aldrich，catalog number：P5280）</li><li>Sodium lactate (60% syrup)（Sigma-Aldrich，catalog number：L4263）</li><li>BSA（absin，catalog number：abs9156）</li><li>penicillin-streptomycin (100X)（gibco，catalog number：15070-063）</li><li>PVA（Sigma-Aldrich，catalog number：P8136）</li><li>HCl（沪试，catalog number：7647-01-0）</li><li>Taurine（Sigma-Aldrich，catalog number：T8691）</li><li>Asparagine（Sigma-Aldrich，catalog number：A4159）</li><li>Cysteine（Sigma-Aldrich，catalog number：C7352）</li><li>Histidine（Sigma-Aldrich，catalog number：H6034）</li><li>Lysine（Sigma-Aldrich，catalog number：L5501）</li><li>Proline（Sigma-Aldrich，catalog number：L5607）</li><li>Serine（Sigma-Aldrich，catalog number：S4311）</li><li>Aspartic acid（Sigma-Aldrich，catalog number：A8949）</li><li>Glycine（Sigma-Aldrich，catalog number：G8790）</li><li>Glutamic acid（Sigma-Aldrich，catalog number：G8415）</li><li>Glutamine（Sigma-Aldrich，catalog number：G8540）</li><li>Pantothenate（Sigma-Aldrich，catalog number：P5155）</li><li>Phenol Red（Sigma-Aldrich，catalog number：P0290）</li></ol><h4 id="仪器设备"><a href="#仪器设备" class="headerlink" title="仪器设备"></a>仪器设备</h4><ol><li>培养箱（Thermo Scientific，model：Forma 3111、Forma 371）</li><li>拉针仪（Sutter Instrument，model：P97）</li><li>断针仪（Narishige，model：MF-900）</li><li>倒置显微镜（Olympus，model：IX-73）</li><li>体视显微镜（Olympus，model：SZX7）</li><li>一对显微操作臂（Narishige）</li><li>微量注射器（Narishige IM-9B）</li><li>离心机（Eppendorf centrifuge，model：5702）</li><li>压电冲击驱动系统（Prime Tech）</li></ol><h4 id="实验步骤和实验流程"><a href="#实验步骤和实验流程" class="headerlink" title="实验步骤和实验流程"></a><strong>实验步骤和实验流程</strong></h4><ol><li>超排母猴及获取卵母细胞；</li><li>猴子精子的采集与获能处理；</li><li>完成注射，将卵子移入培养碟中放置培养箱培养；</li><li>做好详细记录。</li></ol><hr><h4 id="单精注射步骤"><a href="#单精注射步骤" class="headerlink" title="单精注射步骤"></a><strong>单精注射步骤</strong></h4><p><strong>一、精子获能处理</strong></p><ol><li><p>将采集的精子液化15-20 min，取液化好的精子上清加入到15 ml离心管内；</p></li><li><p>在精子离心管内加入4 ml的TH3，轻轻吹打，1,800 rpm，离心5分钟；</p></li><li><p>离心完后去上清，再加入4 ml的TH3，轻轻吹打，1,800 rpm，离心5分钟；</p></li><li><p>离心完后去上清，再加入4 ml的T3，轻轻吹打，1,800 rpm，离心5分钟；</p></li><li><p>离心完后去上清，再加入2 ml的T3，轻轻吹打，1,800 rpm，离心5分钟；</p></li><li><p>离心完后等待精子上游，上游3分钟；</p></li><li><p>上游后取中层的精子，在培养皿内制备精子滴，盖上矿物油，放入培养箱待用。</p></li></ol><p><strong>二、单精子显微注射</strong></p><ol><li><p>将TH3显微注射操作皿做好预热：取200 μl TH3液，在显微操作碟内制备4-5滴TH3液滴和一个柱状TH3液滴，再做一个10% PVP的液滴，每滴体积15-20 μl，并覆盖矿物油；</p></li><li><p>将HECM9aa培养皿做好预热：取200 μl HECM9aa培养液，在培养皿内制备10-13个液滴，每滴体积约15-20 μl，并覆盖矿物油。</p></li><li><p>用拉针仪将1 mm外径的薄壁硼硅酸毛细玻璃管（B100-75-10）拉制成需要的内外径后，在断针仪上断成外径为100-110 μm和内径为15-20 μm，打弯成20-30度的持卵针；</p></li><li><p>用拉针仪将1 mm外径的薄壁硼硅酸毛细玻璃管（B100-75-10）拉制成需要的内外径后，在断针仪上断成外径为7-8 μm和内径为5-6 μm，打弯成20-30度的精子注射针；</p></li><li><p>用1 ml注射器从注射针的末端装入1-2 mm水银待用；</p></li><li><p>将制备的显微注射皿放置于载物台上，从低倍视野开始观察整个显微操作滴；</p></li><li><p>将持卵针安装于操作仪左侧的IM9B，缓慢深入注射滴中，并调整与操作皿底部水平；</p></li><li><p>将注射针安装于操作仪右侧的piezo压电冲击驱动系统的微注射器上，缓慢深入注射滴中，并调整与操作皿底部水平，保持与持卵针在同一水平线；</p></li><li><p>用胚胎转移管将一组MII期卵母细胞转移到操作皿TH3液滴中，同时将处理的3-5 μl获能精子加到另一个TH3液滴内；</p></li><li><p>镜下在10% PVP内清洗注射针并调整注射针到精子滴中，用注射针尖轻击精子尾部来制动精子后，将精子尾先头后吸入注射针内，移动注射针到放置卵母细胞的注射滴中（当注射针内的精子用完后，重复此步骤）；</p></li><li><p>用持卵针抓取并固定MII期卵母细胞，并调整第一极体在六点或十二点的方向，注射针利用脉冲震荡刺穿破透明带，将精子推到注射针口后通过脉冲震荡辅助注射入卵母细胞内，以尽量少的液体吐出精子；（见图1、图2）</p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage@main/img/20230428011726_1523-17104282767004.jpg" alt="img"><br><strong>图1. 极体在约 6 点方向，脉冲震荡刺穿破透明带</strong></p><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage@main/img/20230428011734_8135.jpg" alt="img"><br><strong>图2. 精子推到注射针口，准备进行注射</strong></p></li><li><p>完成注射后，持卵针放开卵母细胞；</p></li><li><p>重复上述操作直至完成所有的MII期卵母细胞的精子注射，将胚胎转移到HECM9aa培养液中在 37 °C，5% CO2培养箱中培养；</p></li><li><p>培养箱中培养六个小时以上，在显微镜下检查原核形成情况，出现两个原核的胚胎视为正常受精。（见图3）</p></li></ol><p><img src="https://cdn.jsdelivr.net/gh/nikolahuang/blogimage@main/img/20230428011746_6699.jpg" alt="img"><br><strong>图3. 受精卵，箭头所指处为两原核位置</strong></p><p>注：本文以7只供体数，共获取103枚卵母细胞进行ICSI，其中有91枚正常受精，受精率达88%。（见表1）</p><p><strong>表1. ICSI数据统计</strong></p><table><thead><tr><th><strong>供体鼠</strong></th><th><strong>注射卵母细胞数</strong></th><th><strong>受精数</strong></th><th><strong>受精率</strong></th></tr></thead><tbody><tr><td>1#</td><td>6</td><td>5</td><td></td></tr><tr><td>2#</td><td>20</td><td>14</td><td></td></tr><tr><td>3#</td><td>2</td><td>2</td><td></td></tr><tr><td>4#</td><td>20</td><td>19</td><td></td></tr><tr><td>5#</td><td>5</td><td>5</td><td></td></tr><tr><td>6#</td><td>27</td><td>25</td><td></td></tr><tr><td>7#</td><td>23</td><td>21</td><td></td></tr><tr><td><strong>总计</strong></td><td>103</td><td>91</td><td>88%</td></tr></tbody></table><hr><h4 id="溶液配方"><a href="#溶液配方" class="headerlink" title="溶液配方"></a>溶液配方</h4><ol><li><p><strong>Tyrode’s Albumin Lactate Pyruvate medium with HEPES (TH3)（表2）</strong></p><p>表2. Tyrode’s Albumin Lactate Pyruvate medium with HEPES (TH3) 配制表</p><table><thead><tr><th>成分</th><th>&#x2F;100ml</th><th>&#x2F;50ml</th><th>备注</th></tr></thead><tbody><tr><td>NaCl</td><td>3.329 ml</td><td>1.665 ml</td><td>200 mg&#x2F;ml stock</td></tr><tr><td>KCl</td><td>239 μl</td><td>119.5 μl</td><td>100 mg&#x2F;ml stock</td></tr><tr><td>CaCl2·2H2O</td><td>294 μl</td><td>147 μl</td><td>100 mg&#x2F;ml stock</td></tr><tr><td>MgCl2·6H2O</td><td>102 μl</td><td>51 μl</td><td>100 mg&#x2F;ml stock</td></tr><tr><td>NaH2PO4</td><td>48 μl</td><td>24 μl</td><td>100 mg&#x2F;ml stock</td></tr><tr><td>NaHCO3</td><td>210.6 mg</td><td>105.3 mg</td><td></td></tr><tr><td>HEPES</td><td>240 mg</td><td>120 mg</td><td></td></tr><tr><td>D-Glucose</td><td>90 mg</td><td>45 mg</td><td></td></tr><tr><td>Sodium Pyruvate</td><td>12 mg</td><td>6 mg</td><td></td></tr><tr><td>Sodium lactate (60% syrup)</td><td>0.17 ml</td><td>85 μl</td><td></td></tr><tr><td>BSA</td><td>300 mg</td><td>150 mg</td><td></td></tr><tr><td>penicillin-streptomycin (100X)</td><td>1 ml</td><td>500 μl</td><td></td></tr><tr><td>Phenol Red (0.01%)</td><td>10 μl</td><td>5 μl</td><td></td></tr><tr><td>pH</td><td>7.4</td><td></td><td></td></tr></tbody></table></li><li><p><strong>Tyrode’s Albumin Lactate Pyruvate medium without HEPES (T3)（表3）</strong></p><p>表3. Tyrode’s Albumin Lactate Pyruvate medium without HEPES (T3) 配制表</p><table><thead><tr><th>成分</th><th>&#x2F;100ml</th><th>&#x2F;10ml</th><th>备注</th></tr></thead><tbody><tr><td>NaCl</td><td>3.329 ml</td><td>333 μl</td><td>200 mg&#x2F;ml stock</td></tr><tr><td>KCl</td><td>239 μl</td><td>23.9 μl</td><td>100 mg&#x2F;ml stock</td></tr><tr><td>CaCl2·2H2O</td><td>294 μl</td><td>29.4 μl</td><td>100 mg&#x2F;ml stock</td></tr><tr><td>MgCl2·6H2O</td><td>102 μl</td><td>10.2 μl</td><td>100 mg&#x2F;ml stock</td></tr><tr><td>NaH2PO4</td><td>48 μl</td><td>4.8 μl</td><td>100 mg&#x2F;ml stock</td></tr><tr><td>NaHCO3</td><td>210.6 mg</td><td>21.06 mg</td><td></td></tr><tr><td>Glcose</td><td>90 mg</td><td>9 mg</td><td></td></tr><tr><td>Sodium Pyruvate</td><td>12 mg</td><td>1.2 mg</td><td></td></tr><tr><td>Sodium lactate (60% syrup)</td><td>0.17 ml</td><td>17 μl</td><td></td></tr><tr><td>BSA</td><td>300 mg</td><td>30 mg</td><td></td></tr><tr><td>penicillin-streptomycin (100X)</td><td>1 ml</td><td>100 μl</td><td></td></tr><tr><td>Phenol Red (0.01%)</td><td>10 μl</td><td>1 μl</td><td></td></tr><tr><td>pH</td><td>7.4</td><td></td><td></td></tr></tbody></table></li><li><p><strong>HECM-9（表4）</strong></p></li></ol><p>   表4. HECM-9 配制表</p><table><thead><tr><th>成分</th><th>&#x2F;100ml</th><th>终浓度</th><th></th></tr></thead><tbody><tr><td>NaCl</td><td>0.6639 g</td><td>113.6 mmol&#x2F;L</td><td></td></tr><tr><td>KCl</td><td>0.0224 g</td><td>3 mmol&#x2F;L</td><td></td></tr><tr><td>CaCl2·2H2O</td><td>0.0279 g</td><td>1.9 mmol&#x2F;L</td><td></td></tr><tr><td>MgCl2·6H2O</td><td>0.0102 g</td><td>0.5 mmol&#x2F;L</td><td></td></tr><tr><td>NaHCO3</td><td>0.2100 g</td><td>25 mmol&#x2F;L</td><td></td></tr><tr><td>Sodium lactate (60% syrup)</td><td>0.0504 g</td><td>4.5 mmol&#x2F;L</td><td></td></tr><tr><td>PVA</td><td>0.01 g</td><td>0.1 mg&#x2F;ml</td><td></td></tr><tr><td>1 mol&#x2F;L HCl</td><td>0.14 ml</td><td>1.4 mmol&#x2F;ml</td><td></td></tr><tr><td>11 AA with Pantothenate</td><td>1 ml</td><td></td><td></td></tr><tr><td><strong>100X AA stock</strong></td><td></td><td></td><td></td></tr><tr><td>成分</td><td>MW</td><td>100X 母液浓度</td><td>终浓度</td></tr><tr><td>Taurine</td><td>125</td><td>50 mmol&#x2F;L</td><td>0.5 mmol&#x2F;L</td></tr><tr><td>Asparagine</td><td>132</td><td>1 mmol&#x2F;L</td><td>0.01 mmol&#x2F;L</td></tr><tr><td>Cysteine</td><td>121</td><td>1 mmol&#x2F;L</td><td>0.01 mmol&#x2F;L</td></tr><tr><td>Histidine</td><td>155</td><td>1 mmol&#x2F;L</td><td>0.01 mmol&#x2F;L</td></tr><tr><td>Lysine</td><td>146</td><td>1 mmol&#x2F;L</td><td>0.01 mmol&#x2F;L</td></tr><tr><td>Proline</td><td>115</td><td>1 mmol&#x2F;L</td><td>0.01 mmol&#x2F;L</td></tr><tr><td>Serine</td><td>105</td><td>1 mmol&#x2F;L</td><td>0.01 mmol&#x2F;L</td></tr><tr><td>Aspartic acid</td><td>133</td><td>1 mmol&#x2F;L</td><td>0.01 mmol&#x2F;L</td></tr><tr><td>Glycine</td><td>75</td><td>1 mmol&#x2F;L</td><td>0.01 mmol&#x2F;L</td></tr><tr><td>Glutamic acid</td><td>147</td><td>1 mmol&#x2F;L</td><td>0.01 mmol&#x2F;L</td></tr><tr><td>Glutamine</td><td>146</td><td>20 mmol&#x2F;L</td><td>0.2 mmol&#x2F;L</td></tr><tr><td>Pantothenate</td><td>238</td><td>0.3 mmol&#x2F;L</td><td>3 μmol&#x2F;L</td></tr></tbody></table><hr>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h2 id=&quot;卵母细胞-siRNA-显微注射&quot;&gt;&lt;a href=&quot;#卵母细胞-siRNA-显微注射&quot; class=&quot;headerlink&quot; title=&quot;卵母细胞 siRNA 显微注射&quot;&gt;&lt;/a&gt;卵母细胞 siRNA 显微注射&lt;/h2&gt;&lt;ol&gt;
&lt;li</summary>
      
    
    
    
    
    <category term="BioProtocol" scheme="http://nikolahuang.github.io/tags/BioProtocol/"/>
    
  </entry>
  
</feed>
